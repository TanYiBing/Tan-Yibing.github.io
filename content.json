[{"title":"Angularä¸­æ‹¦æˆªå™¨çš„çœŸç›¸å’ŒHttpClientå†…éƒ¨æœºåˆ¶","date":"2018-12-22T12:02:26.000Z","path":"2018/12/22/Angularä¸­æ‹¦æˆªå™¨çš„çœŸç›¸å’ŒHttpClientå†…éƒ¨æœºåˆ¶/","text":"Angular ä¸­æ‹¦æˆªå™¨çš„çœŸç›¸å’Œ HttpClient å†…éƒ¨æœºåˆ¶ åŸæ–‡ï¼šInsiderâ€™s guide into interceptors and HttpClient mechanics in Angularä½œè€…ï¼šMax KoretskyiåŸæŠ€æœ¯åšæ–‡ç”± Max Koretskyi æ’°å†™å‘å¸ƒï¼Œä»–ç›®å‰äº ag-Grid æ‹…ä»»å¼€å‘å¤§ä½¿(Developer Advocate)è¯‘è€…æŒ‰ï¼šå¼€å‘å¤§ä½¿è´Ÿè´£ç¡®ä¿å…¶æ‰€åœ¨çš„å…¬å¸è®¤çœŸå¬å–ç¤¾åŒºçš„å£°éŸ³å¹¶å‘ç¤¾åŒºä¼ è¾¾ä»–ä»¬çš„è¡ŒåŠ¨åŠç›®æ ‡ï¼Œå…¶ä½œä¸ºç¤¾åŒºå’Œå…¬å¸ä¹‹é—´çš„çº½å¸¦å­˜åœ¨ã€‚è¯‘è€…ï¼šIce Panpanï¼›æ ¡å¯¹è€…ï¼šdreamdevil00 async or ngdocheck æ‚¨å¯èƒ½çŸ¥é“ Angular åœ¨4.3ç‰ˆæœ¬ä¸­æ–°å¼•å…¥äº†å¼ºå¤§çš„ HttpClientã€‚å®ƒçš„ä¸€ä¸ªä¸»è¦åŠŸèƒ½æ˜¯è¯·æ±‚æ‹¦æˆªï¼ˆrequest interceptionï¼‰â€”â€” å£°æ˜ä½äºåº”ç”¨ç¨‹åºå’Œåç«¯ä¹‹é—´çš„æ‹¦æˆªå™¨çš„èƒ½åŠ›ã€‚æ‹¦æˆªå™¨çš„æ–‡æ¡£å†™çš„å¾ˆå¥½ï¼Œå±•ç¤ºäº†å¦‚ä½•ç¼–å†™å¹¶æ³¨å†Œä¸€ä¸ªæ‹¦æˆªå™¨ã€‚åœ¨è¿™ç¯‡æ–‡ç« ä¸­ï¼Œæˆ‘å°†æ·±å…¥ç ”ç©¶ HttpClient æœåŠ¡çš„å†…éƒ¨æœºåˆ¶,ç‰¹åˆ«æ˜¯æ‹¦æˆªå™¨ã€‚æˆ‘ç›¸ä¿¡è¿™äº›çŸ¥è¯†å¯¹äºæ·±å…¥ä½¿ç”¨è¯¥åŠŸèƒ½æ˜¯å¿…è¦çš„ã€‚é˜…è¯»å®Œæœ¬æ–‡åï¼Œæ‚¨å°†èƒ½å¤Ÿè½»æ¾äº†è§£åƒç¼“å­˜ä¹‹ç±»å·¥å…·çš„å·¥ä½œæµç¨‹ï¼Œå¹¶èƒ½å¤Ÿè½»æ¾è‡ªå¦‚åœ°å®ç°å¤æ‚çš„è¯·æ±‚/å“åº”æ“ä½œæ–¹æ¡ˆã€‚ é¦–å…ˆï¼Œæˆ‘ä»¬å°†ä½¿ç”¨æ–‡æ¡£ä¸­æè¿°çš„æ–¹æ³•æ¥æ³¨å†Œä¸¤ä¸ªæ‹¦æˆªå™¨ï¼Œä»¥ä¾¿ä¸ºè¯·æ±‚æ·»åŠ è‡ªå®šä¹‰çš„è¯·æ±‚å¤´ã€‚ç„¶åæˆ‘ä»¬å°†å®ç°è‡ªå®šä¹‰çš„ä¸­é—´ä»¶é“¾ï¼Œè€Œä¸æ˜¯ä½¿ç”¨ Angular å®šä¹‰çš„æœºåˆ¶ã€‚æœ€åï¼Œæˆ‘ä»¬å°†äº†è§£ HttpClient çš„è¯·æ±‚æ–¹æ³•å¦‚ä½•æ„å»º HttpEvents ç±»å‹çš„ observable æµå¹¶æ»¡è¶³ä¸å¯å˜ï¼ˆimmutabilityï¼‰æ€§çš„éœ€æ±‚ã€‚ ä¸æˆ‘çš„å¤§éƒ¨åˆ†æ–‡ç« ä¸€æ ·ï¼Œæˆ‘ä»¬å°†é€šè¿‡æ“ä½œå®ä¾‹æ¥å­¦ä¹ æ›´å¤šå†…å®¹ã€‚ åº”ç”¨ç¤ºä¾‹é¦–å…ˆï¼Œè®©æˆ‘ä»¬å®ç°ä¸¤ä¸ªç®€å•çš„æ‹¦æˆªå™¨ï¼Œæ¯ä¸ªæ‹¦æˆªå™¨ä½¿ç”¨æ–‡æ¡£ä¸­æè¿°çš„æ–¹æ³•å‘ä¼ å‡ºçš„è¯·æ±‚æ·»åŠ è¯·æ±‚å¤´ã€‚å¯¹äºæ¯ä¸ªæ‹¦æˆªå™¨ï¼Œæˆ‘ä»¬å£°æ˜ä¸€ä¸ªå®ç°äº† intercept æ–¹æ³•çš„ç±»ã€‚åœ¨æ­¤æ–¹æ³•ä¸­ï¼Œæˆ‘ä»¬é€šè¿‡æ·»åŠ  Custom-Header-1 å’Œ Custom-Header-2 çš„è¯·æ±‚å¤´ä¿¡æ¯æ¥ä¿®æ”¹è¯·æ±‚ï¼š 123456789101112131415@Injectable()export class I1 implements HttpInterceptor &#123; intercept(req: HttpRequest&lt;any&gt;, next: HttpHandler): Observable&lt;HttpEvent&lt;any&gt;&gt; &#123; const modified = req.clone(&#123;setHeaders: &#123;'Custom-Header-1': '1'&#125;&#125;); return next.handle(modified); &#125;&#125;@Injectable()export class I2 implements HttpInterceptor &#123; intercept(req: HttpRequest&lt;any&gt;, next: HttpHandler): Observable&lt;HttpEvent&lt;any&gt;&gt; &#123; const modified = req.clone(&#123;setHeaders: &#123;'Custom-Header-2': '2'&#125;&#125;); return next.handle(modified); &#125;&#125; æ­£å¦‚æ‚¨æ‰€çœ‹åˆ°çš„ï¼Œæ¯ä¸ªæ‹¦æˆªå™¨éƒ½å°†ä¸‹ä¸€ä¸ªå¤„ç†ç¨‹åºä½œä¸ºç¬¬äºŒä¸ªå‚æ•°ã€‚æˆ‘ä»¬éœ€è¦é€šè¿‡è°ƒç”¨è¯¥å‡½æ•°æ¥å°†æ§åˆ¶æƒä¼ é€’ç»™ä¸­é—´ä»¶é“¾ä¸­çš„ä¸‹ä¸€ä¸ªæ‹¦æˆªå™¨ã€‚æˆ‘ä»¬ä¼šå¾ˆå¿«å‘ç°è°ƒç”¨ next.handle æ—¶å‘ç”Ÿäº†ä»€ä¹ˆä»¥åŠä¸ºä»€ä¹ˆæœ‰çš„æ—¶å€™ä½ ä¸éœ€è¦è°ƒç”¨è¯¥å‡½æ•°ã€‚æ­¤å¤–ï¼Œå¦‚æœä½ ä¸€ç›´æƒ³çŸ¥é“ä¸ºä»€ä¹ˆéœ€è¦å¯¹è¯·æ±‚è°ƒç”¨ clone() æ–¹æ³•ï¼Œä½ å¾ˆå¿«å°±ä¼šå¾—åˆ°ç­”æ¡ˆã€‚ æ‹¦æˆªå™¨å®ç°ä¹‹åï¼Œæˆ‘ä»¬éœ€è¦ä½¿ç”¨ HTTP_INTERCEPTORS ä»¤ç‰Œæ³¨å†Œå®ƒä»¬ï¼š 123456789101112131415161718@NgModule(&#123; imports: [BrowserModule, HttpClientModule], declarations: [AppComponent], providers: [ &#123; provide: HTTP_INTERCEPTORS, useClass: I1, multi: true &#125;, &#123; provide: HTTP_INTERCEPTORS, useClass: I2, multi: true &#125; ], bootstrap: [AppComponent]&#125;)export class AppModule &#123;&#125; ç´§æ¥ç€æ‰§è¡Œä¸€ä¸ªç®€å•çš„è¯·æ±‚æ¥æ£€æŸ¥æˆ‘ä»¬è‡ªå®šä¹‰çš„è¯·æ±‚å¤´æ˜¯å¦æ·»åŠ æˆåŠŸï¼š 12345678910111213141516@Component(&#123; selector: 'my-app', template: ` &lt;div&gt;&lt;h3&gt;Response&lt;/h3&gt;&#123;&#123;response|async|json&#125;&#125;&lt;/div&gt; &lt;button (click)=\"request()\"&gt;Make request&lt;/button&gt;` ,&#125;)export class AppComponent &#123; response: Observable&lt;any&gt;; constructor(private http: HttpClient) &#123;&#125; request() &#123; const url = 'https://jsonplaceholder.typicode.com/posts/1'; this.response = this.http.get(url, &#123;observe: 'response'&#125;); &#125;&#125; å¦‚æœæˆ‘ä»¬å·²ç»æ­£ç¡®å®Œæˆäº†æ‰€æœ‰æ“ä½œï¼Œå½“æˆ‘ä»¬æ£€æŸ¥ Network é€‰é¡¹å¡æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°æˆ‘ä»¬è‡ªå®šä¹‰çš„è¯·æ±‚å¤´å‘é€åˆ°æœåŠ¡å™¨ï¼š console_1 è¿™å¾ˆå®¹æ˜“å§ã€‚ä½ å¯ä»¥åœ¨ stackblitz ä¸Šæ‰¾åˆ°è¿™ä¸ªåŸºç¡€ç¤ºä¾‹ã€‚ç°åœ¨æ˜¯æ—¶å€™ç ”ç©¶æ›´æœ‰è¶£çš„ä¸œè¥¿äº†ã€‚ å®ç°è‡ªå®šä¹‰çš„ä¸­é—´ä»¶é“¾æˆ‘ä»¬çš„ä»»åŠ¡æ˜¯åœ¨ä¸ä½¿ç”¨ HttpClient æä¾›çš„æ–¹æ³•çš„æƒ…å†µä¸‹æ‰‹åŠ¨å°†æ‹¦æˆªå™¨é›†æˆåˆ°å¤„ç†è¯·æ±‚çš„é€»è¾‘ä¸­ã€‚åŒæ—¶ï¼Œæˆ‘ä»¬å°†æ„å»ºä¸€ä¸ªå¤„ç†ç¨‹åºé“¾ï¼Œå°±åƒ Angular å†…éƒ¨å®Œæˆçš„ä¸€æ ·ã€‚ å¤„ç†è¯·æ±‚åœ¨ç°ä»£æµè§ˆå™¨ä¸­ï¼ŒAJAX åŠŸèƒ½æ˜¯ä½¿ç”¨ XmlHttpRequest æˆ– Fetch API å®ç°çš„ã€‚æ­¤å¤–ï¼Œè¿˜æœ‰ç»å¸¸ä½¿ç”¨çš„ä¼šå¯¼è‡´ä¸å˜æ›´æ£€æµ‹ç›¸å…³çš„æ„å¤–ç»“æœçš„ JSONP æŠ€æœ¯ã€‚Angular éœ€è¦ä¸€ä¸ªä½¿ç”¨ä¸Šè¿°æ–¹æ³•ä¹‹ä¸€çš„æœåŠ¡æ¥å‘æœåŠ¡å™¨å‘å‡ºè¯·æ±‚ã€‚è¿™ç§æœåŠ¡åœ¨ HttpClient æ–‡æ¡£ä¸Šè¢«ç§°ä¸º åç«¯ï¼ˆbackendï¼‰ï¼Œä¾‹å¦‚ï¼š In an interceptor, next always represents the next interceptor in the chain, if any, or the final backend if there are no more interceptors åœ¨æ‹¦æˆªå™¨ä¸­ï¼Œnext å§‹ç»ˆè¡¨ç¤ºé“¾ä¸­çš„ä¸‹ä¸€ä¸ªæ‹¦æˆªå™¨ï¼ˆå¦‚æœæœ‰çš„è¯ï¼‰ï¼Œå¦‚æœæ²¡æœ‰æ›´å¤šæ‹¦æˆªå™¨çš„è¯åˆ™è¡¨ç¤ºæœ€ç»ˆåç«¯ åœ¨ Angular æä¾›çš„ HttpClient æ¨¡å—ä¸­ï¼Œè¿™ç§æœåŠ¡æœ‰ä¸¤ç§å®ç°æ–¹æ³•â€”â€”ä½¿ç”¨ XmlHttpRequest API å®ç°çš„HttpXhrBackend å’Œä½¿ç”¨ JSONP æŠ€æœ¯å®ç°çš„ JsonpClientBackendã€‚HttpClient ä¸­é»˜è®¤ä½¿ç”¨ HttpXhrBackendã€‚ Angular å®šä¹‰äº†ä¸€ä¸ªåä¸º HTTPï¼ˆrequestï¼‰handler çš„æŠ½è±¡æ¦‚å¿µï¼Œè´Ÿè´£å¤„ç†è¯·æ±‚ã€‚å¤„ç†è¯·æ±‚çš„ä¸­é—´ä»¶é“¾ç”± HTTP handlers ç»„æˆï¼Œè¿™äº›å¤„ç†ç¨‹åºå°†è¯·æ±‚ä¼ é€’ç»™é“¾ä¸­çš„ä¸‹ä¸€ä¸ªå¤„ç†ç¨‹åºï¼Œç›´åˆ°å…¶ä¸­ä¸€ä¸ªå¤„ç†ç¨‹åºè¿”å›ä¸€ä¸ª observable æµã€‚å¤„ç†ç¨‹åºçš„æ¥å£ç”±æŠ½è±¡ç±» HttpHandler å®šä¹‰ï¼š 123export abstract class HttpHandler &#123; abstract handle(req: HttpRequest&lt;any&gt;): Observable&lt;HttpEvent&lt;any&gt;&gt;;&#125; ç”±äº backend æœåŠ¡ï¼ˆå¦‚ HttpXhrBackend ï¼‰å¯ä»¥é€šè¿‡ å‘å‡ºç½‘ç»œè¯·æ±‚æ¥å¤„ç†è¯·æ±‚ï¼Œæ‰€ä»¥å®ƒæ˜¯ HTTP handler çš„ä¸€ä¸ªä¾‹å­ã€‚é€šè¿‡å’Œ backend æœåŠ¡é€šä¿¡æ¥å¤„ç†è¯·æ±‚æ˜¯æœ€å¸¸è§çš„å¤„ç†å½¢å¼ï¼Œä½†å´ä¸æ˜¯å”¯ä¸€çš„å¤„ç†æ–¹å¼ã€‚å¦ä¸€ç§å¸¸è§çš„è¯·æ±‚å¤„ç†ç¤ºä¾‹æ˜¯ä»æœ¬åœ°ç¼“å­˜ä¸­ä¸ºè¯·æ±‚æä¾›æœåŠ¡ï¼Œè€Œä¸æ˜¯å‘é€è¯·æ±‚ç»™æœåŠ¡å™¨ã€‚å› æ­¤ï¼Œä»»ä½•å¯ä»¥å¤„ç†è¯·æ±‚çš„æœåŠ¡éƒ½åº”è¯¥å®ç° handle æ–¹æ³•ï¼Œè¯¥æ–¹æ³•æ ¹æ®å‡½æ•°ç­¾åè¿”å›ä¸€ä¸ª HTTP events ç±»å‹çš„ observableï¼Œå¦‚ HttpProgressEventï¼ŒHttpHeaderResponse æˆ–HttpResponseã€‚å› æ­¤ï¼Œå¦‚æœæˆ‘ä»¬æƒ³æä¾›ä¸€äº›è‡ªå®šä¹‰è¯·æ±‚å¤„ç†é€»è¾‘ï¼Œæˆ‘ä»¬éœ€è¦åˆ›å»ºä¸€ä¸ªå®ç°äº† HttpHandler æ¥å£çš„æœåŠ¡ã€‚ ä½¿ç”¨ backend ä½œä¸º HTTP handlerHttpClient æœåŠ¡åœ¨ DI å®¹å™¨ä¸­çš„ HttpHandler ä»¤ç‰Œä¸‹æ³¨å…¥äº†ä¸€ä¸ªå…¨å±€çš„ HTTP handler ã€‚ç„¶åé€šè¿‡è°ƒç”¨å®ƒçš„ handle æ–¹æ³•æ¥å‘å‡ºè¯·æ±‚ï¼š 12345678910export class HttpClient &#123; constructor(private handler: HttpHandler) &#123;&#125; request(...): Observable&lt;any&gt; &#123; ... const events$: Observable&lt;HttpEvent&lt;any&gt;&gt; = of(req).pipe(concatMap((req: HttpRequest&lt;any&gt;) =&gt; this.handler.handle(req))); ... &#125;&#125; é»˜è®¤æƒ…å†µä¸‹ï¼Œå…¨å±€ HTTP handler æ˜¯ HttpXhrBackend backendã€‚å®ƒè¢«æ³¨å†Œåœ¨æ³¨å…¥å™¨ä¸­çš„ HttpBackend ä»¤ç‰Œä¸‹ã€‚ 1234567@NgModule(&#123; providers: [ HttpXhrBackend, &#123; provide: HttpBackend, useExisting: HttpXhrBackend &#125; ]&#125;)export class HttpClientModule &#123;&#125; æ­£å¦‚ä½ å¯èƒ½çŒœåˆ°çš„é‚£æ · HttpXhrBackend å®ç°äº† HttpHandler æ¥å£ï¼š 1234567891011export abstract class HttpHandler &#123; abstract handle(req: HttpRequest&lt;any&gt;): Observable&lt;HttpEvent&lt;any&gt;&gt;;&#125;export abstract class HttpBackend implements HttpHandler &#123; abstract handle(req: HttpRequest&lt;any&gt;): Observable&lt;HttpEvent&lt;any&gt;&gt;;&#125;export class HttpXhrBackend implements HttpBackend &#123; handle(req: HttpRequest&lt;any&gt;): Observable&lt;HttpEvent&lt;any&gt;&gt; &#123;&#125;&#125; ç”±äºé»˜è®¤çš„ XHR backend æ˜¯åœ¨ HttpBackend ä»¤ç‰Œä¸‹æ³¨å†Œçš„ï¼Œæˆ‘ä»¬å¯ä»¥è‡ªå·±æ³¨å…¥å¹¶æ›¿æ¢ HttpClient ç”¨äºå‘å‡ºè¯·æ±‚çš„ç”¨æ³•ã€‚æˆ‘ä»¬æ›¿æ¢æ‰ä¸‹é¢è¿™ä¸ªä½¿ç”¨ HttpClient çš„ç‰ˆæœ¬ï¼š 123456789export class AppComponent &#123; response: Observable&lt;any&gt;; constructor(private http: HttpClient) &#123;&#125; request() &#123; const url = 'https://jsonplaceholder.typicode.com/posts/1'; this.response = this.http.get(url, &#123;observe: 'body'&#125;); &#125;&#125; è®©æˆ‘ä»¬ç›´æ¥ä½¿ç”¨é»˜è®¤çš„ XHR backendï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š 123456789export class AppComponent &#123; response: Observable&lt;any&gt;; constructor(private backend: HttpXhrBackend) &#123;&#125; request() &#123; const req = new HttpRequest('GET', 'https://jsonplaceholder.typicode.com/posts/1'); this.response = this.backend.handle(req); &#125;&#125; è¿™æ˜¯ç¤ºä¾‹ã€‚åœ¨ç¤ºä¾‹ä¸­éœ€è¦æ³¨æ„ä¸€äº›äº‹é¡¹ã€‚é¦–å…ˆï¼Œæˆ‘ä»¬éœ€è¦æ‰‹åŠ¨æ„å»º HttpRequestã€‚å…¶æ¬¡ï¼Œç”±äº backend å¤„ç†ç¨‹åºè¿”å› HTTP events æµï¼Œä½ å°†åœ¨å±å¹•ä¸Šçœ‹åˆ°ä¸åŒçš„å¯¹è±¡ä¸€é—ªè€Œè¿‡ï¼Œæœ€ç»ˆå°†å‘ˆç°æ•´ä¸ª http å“åº”å¯¹è±¡ã€‚ æ·»åŠ æ‹¦æˆªå™¨æˆ‘ä»¬å·²ç»è®¾æ³•ç›´æ¥ä½¿ç”¨ backendï¼Œä½†ç”±äºæˆ‘ä»¬æ²¡æœ‰è¿è¡Œæ‹¦æˆªå™¨ï¼Œæ‰€ä»¥è¯·æ±‚å¤´å°šæœªæ·»åŠ åˆ°è¯·æ±‚ä¸­ã€‚ä¸€ä¸ªæ‹¦æˆªå™¨åŒ…å«å¤„ç†è¯·æ±‚çš„é€»è¾‘ï¼Œä½†å®ƒè¦ä¸ HttpClient ä¸€èµ·ä½¿ç”¨ï¼Œéœ€è¦å°†å…¶å°è£…åˆ°å®ç°äº† HttpHandler æ¥å£çš„æœåŠ¡ä¸­ã€‚æˆ‘ä»¬å¯ä»¥é€šè¿‡æ‰§è¡Œä¸€ä¸ªæ‹¦æˆªå™¨å¹¶å°†é“¾ä¸­çš„ä¸‹ä¸€ä¸ªå¤„ç†ç¨‹åºçš„å¼•ç”¨ä¼ é€’ç»™æ­¤æ‹¦æˆªå™¨çš„æ–¹å¼æ¥å®ç°æ­¤æœåŠ¡ã€‚è¿™æ ·æ‹¦æˆªå™¨å°±å¯ä»¥è§¦å‘ä¸‹ä¸€ä¸ªå¤„ç†ç¨‹åºï¼Œåè€…é€šå¸¸æ˜¯ backendã€‚ä¸ºæ­¤ï¼Œæ¯ä¸ªè‡ªå®šä¹‰çš„å¤„ç†ç¨‹åºå°†ä¿å­˜é“¾ä¸­ä¸‹ä¸€ä¸ªå¤„ç†ç¨‹åºçš„å¼•ç”¨ï¼Œå¹¶å°†å…¶ä¸è¯·æ±‚ä¸€èµ·ä¼ é€’ç»™ä¸‹ä¸€ä¸ªæ‹¦æˆªå™¨ã€‚ä¸‹é¢å°±æ˜¯æˆ‘ä»¬æƒ³è¦çš„ä¸œè¥¿ï¼š console_2 åœ¨ Angular ä¸­å·²ç»å­˜åœ¨è¿™ç§å°è£…å¤„ç†ç¨‹åºçš„æ–¹æ³•äº†å¹¶è¢«ç§°ä¸º HttpInterceptorHandlerã€‚è®©æˆ‘ä»¬ç”¨å®ƒæ¥å°è£…æˆ‘ä»¬çš„ä¸€ä¸ªæ‹¦æˆªå™¨å§ã€‚ä½†æ˜¯ä¸å¹¸çš„æ˜¯ï¼ŒAngular æ²¡æœ‰å°†å…¶å¯¼å‡ºä¸ºå…¬å…± APIï¼Œå› æ­¤æˆ‘ä»¬åªèƒ½ä»æºä»£ç ä¸­å¤åˆ¶åŸºæœ¬å®ç°ï¼š 12345678export class HttpInterceptorHandler implements HttpHandler &#123; constructor(private next: HttpHandler, private interceptor: HttpInterceptor) &#123;&#125; handle(req: HttpRequest&lt;any&gt;): Observable&lt;HttpEvent&lt;any&gt;&gt; &#123; // execute an interceptor and pass the reference to the next handler return this.interceptor.intercept(req, this.next); &#125;&#125; å¹¶åƒè¿™æ ·ä½¿ç”¨å®ƒæ¥å°è£…æˆ‘ä»¬çš„ç¬¬ä¸€ä¸ªæ‹¦æˆªå™¨ï¼š 12345678910export class AppComponent &#123; response: Observable&lt;any&gt;; constructor(private backend: HttpXhrBackend) &#123;&#125; request() &#123; const req = new HttpRequest('GET', 'https://jsonplaceholder.typicode.com/posts/1'); const handler = new HttpInterceptorHandler(this.backend, new I1()); this.response = handler.handle(req); &#125;&#125; ç°åœ¨ï¼Œä¸€æ—¦æˆ‘ä»¬å‘å‡ºè¯·æ±‚ï¼Œæˆ‘ä»¬å°±å¯ä»¥çœ‹åˆ° Custom-Header-1 å·²æ·»åŠ åˆ°è¯·æ±‚ä¸­ã€‚è¿™æ˜¯ç¤ºä¾‹ã€‚é€šè¿‡ä¸Šé¢çš„å®ç°ï¼Œæˆ‘ä»¬å°†ä¸€ä¸ªæ‹¦æˆªå™¨å’Œå¼•ç”¨äº†ä¸‹ä¸€ä¸ªå¤„ç†ç¨‹åºçš„ XHR backend å°è£…è¿›äº† HttpInterceptorHandlerã€‚ç°åœ¨ï¼Œè¿™å°±æ˜¯è¿™æ˜¯ä¸€æ¡å¤„ç†ç¨‹åºé“¾ã€‚ è®©æˆ‘ä»¬é€šè¿‡å°è£…ç¬¬äºŒä¸ªæ‹¦æˆªå™¨æ¥å°†å¦ä¸€ä¸ªå¤„ç†ç¨‹åºæ·»åŠ åˆ°é“¾ä¸­ï¼š 1234567891011export class AppComponent &#123; response: Observable&lt;any&gt;; constructor(private backend: HttpXhrBackend) &#123;&#125; request() &#123; const req = new HttpRequest('GET', 'https://jsonplaceholder.typicode.com/posts/1'); const i1Handler = new HttpInterceptorHandler(this.backend, new I1()); const i2Handler = new HttpInterceptorHandler(i1Handler, new I2()); this.response = i2Handler.handle(req); &#125;&#125; åœ¨è¿™å¯ä»¥çœ‹åˆ°æ¼”ç¤ºï¼Œç°åœ¨ä¸€åˆ‡æ­£å¸¸ï¼Œå°±åƒæˆ‘ä»¬åœ¨æœ€å¼€å§‹çš„ç¤ºä¾‹ä¸­ä½¿ç”¨ HttpClient çš„é‚£æ ·ã€‚æˆ‘ä»¬åˆšåˆšæ‰€åšçš„å°±æ˜¯æ„å»ºäº†å¤„ç†ç¨‹åºçš„ä¸­é—´ä»¶é“¾ï¼Œå…¶ä¸­æ¯ä¸ªå¤„ç†ç¨‹åºæ‰§è¡Œä¸€ä¸ªæ‹¦æˆªå™¨å¹¶å°†ä¸‹ä¸€ä¸ªå¤„ç†ç¨‹åºçš„å¼•ç”¨ä¼ é€’ç»™å®ƒã€‚è¿™æ˜¯é“¾çš„å›¾è¡¨ï¼š console_3 å½“æˆ‘ä»¬åœ¨æ‹¦æˆªå™¨ä¸­æ‰§è¡Œ next.handle(modified) è¯­å¥æ—¶ï¼Œæˆ‘ä»¬å°†æ§åˆ¶æƒä¼ é€’ç»™é“¾ä¸­çš„ä¸‹ä¸€ä¸ªå¤„ç†ç¨‹åºï¼š 1234567export class I1 implements HttpInterceptor &#123; intercept(req: HttpRequest&lt;any&gt;, next: HttpHandler): Observable&lt;HttpEvent&lt;any&gt;&gt; &#123; const modified = req.clone(&#123;setHeaders: &#123;'Custom-Header-1': '1'&#125;&#125;); // passing control to the handler in the chain return next.handle(modified); &#125;&#125; æœ€ç»ˆï¼Œæ§åˆ¶æƒå°†è¢«ä¼ é€’åˆ°æœ€åä¸€ä¸ª backend å¤„ç†ç¨‹åºï¼Œè¯¥å¤„ç†ç¨‹åºå°†å¯¹æœåŠ¡å™¨æ‰§è¡Œè¯·æ±‚ã€‚ è‡ªåŠ¨å°è£…æ‹¦æˆªå™¨æˆ‘ä»¬å¯ä»¥é€šè¿‡ä½¿ç”¨ HTTP_INTERCEPTORS ä»¤ç‰Œæ³¨å…¥æ‰€æœ‰çš„æ‹¦æˆªå™¨ï¼Œç„¶åä½¿ç”¨ reduceRight å°†å®ƒä»¬é“¾æ¥èµ·æ¥çš„æ–¹å¼è‡ªåŠ¨æ„å»ºæ‹¦æˆªå™¨é“¾ï¼Œè€Œä¸æ˜¯é€ä¸ªåœ°æ‰‹åŠ¨å°†æ‹¦æˆªå™¨é“¾æ¥èµ·æ¥æ„æˆæ‹¦æˆªå™¨é“¾ã€‚æˆ‘ä»¬è¿™æ ·åšï¼š 12345678910111213export class AppComponent &#123; response: Observable&lt;any&gt;; constructor( private backend: HttpBackend, @Inject(HTTP_INTERCEPTORS) private interceptors: HttpInterceptor[]) &#123;&#125; request() &#123; const req = new HttpRequest('GET', 'https://jsonplaceholder.typicode.com/posts/1'); const i2Handler = this.interceptors.reduceRight( (next, interceptor) =&gt; new HttpInterceptorHandler(next, interceptor), this.backend); this.response = i2Handler.handle(req); &#125;&#125; æˆ‘ä»¬éœ€è¦åœ¨è¿™é‡Œä½¿ç”¨ reduceRight æ¥ä»æœ€åæ³¨å†Œçš„æ‹¦æˆªå™¨å¼€å§‹æ„å»ºä¸€ä¸ªé“¾ã€‚ä½¿ç”¨ä¸Šé¢çš„ä»£ç ï¼Œæˆ‘ä»¬ä¼šè·å¾—ä¸æ‰‹åŠ¨æ„å»ºçš„å¤„ç†ç¨‹åºé“¾ç›¸åŒçš„é“¾ã€‚é€šè¿‡ reduceRight è¿”å›çš„å€¼æ˜¯å¯¹é“¾ä¸­ç¬¬ä¸€ä¸ªå¤„ç†ç¨‹åºçš„å¼•ç”¨ã€‚ å®é™…ä¸Šï¼Œä¸Šè¿°æˆ‘å†™çš„ä»£ç åœ¨ Angular ä¸­æ˜¯ä½¿ç”¨ interceptingHandler å‡½æ•°æ¥å®ç°çš„ã€‚åŸè¯æ˜¯è¿™ä¹ˆè¯´çš„ï¼š Constructs an HttpHandler that applies a bunch of HttpInterceptors to a request before passing it to the given HttpBackend.Meant to be used as a factory function within HttpClientModule. æ„é€ ä¸€ä¸ª HttpHandlerï¼Œåœ¨å°†è¯·æ±‚ä¼ é€’ç»™ç»™å®šçš„ HttpBackend ä¹‹å‰ï¼Œå°†ä¸€ç³»åˆ— HttpInterceptor åº”ç”¨äºè¯·æ±‚ã€‚å¯ä»¥åœ¨ HttpClientModule ä¸­ç”¨ä½œå·¥å‚å‡½æ•°ã€‚ ï¼ˆä¸‹é¢é¡ºä¾¿è´´ä¸€ä¸‹æºç :ï¼‰ 12345678export function interceptingHandler( backend: HttpBackend, interceptors: HttpInterceptor[] | null = []): HttpHandler &#123; if (!interceptors) &#123; return backend; &#125; return interceptors.reduceRight( (next, interceptor) =&gt; new HttpInterceptorHandler(next, interceptor), backend);&#125; ç°åœ¨æˆ‘ä»¬çŸ¥é“æ˜¯å¦‚ä½•æ„é€ ä¸€æ¡å¤„ç†å‡½æ•°é“¾çš„äº†ã€‚åœ¨ HTTP handler ä¸­éœ€è¦æ³¨æ„çš„æœ€åä¸€ç‚¹æ˜¯ï¼Œ interceptingHandler é»˜è®¤ä¸º HttpHandlerï¼š 12345678910@NgModule(&#123; providers: [ &#123; provide: HttpHandler, useFactory: interceptingHandler, deps: [HttpBackend, [@Optional(), @Inject(HTTP_INTERCEPTORS)]], &#125; ]&#125;)export class HttpClientModule &#123;&#125; å› æ­¤ï¼Œæ‰§è¡Œæ­¤å‡½æ•°çš„ç»“æœæ˜¯é“¾ä¸­ç¬¬ä¸€ä¸ªå¤„ç†ç¨‹åºçš„å¼•ç”¨è¢«æ³¨å…¥ HttpClient æœåŠ¡å¹¶è¢«ä½¿ç”¨ã€‚ æ„å»ºå¤„ç†é“¾çš„ observable æµå¥½çš„ï¼Œç°åœ¨æˆ‘ä»¬çŸ¥é“æˆ‘ä»¬æœ‰ä¸€å †å¤„ç†ç¨‹åºï¼Œæ¯ä¸ªå¤„ç†ç¨‹åºæ‰§è¡Œä¸€ä¸ªå…³è”çš„æ‹¦æˆªå™¨å¹¶è°ƒç”¨é“¾ä¸­çš„ä¸‹ä¸€ä¸ªå¤„ç†ç¨‹åºã€‚è°ƒç”¨æ­¤é“¾è¿”å›çš„å€¼æ˜¯ä¸€ä¸ª HttpEvents ç±»å‹çš„ observable æµã€‚è¿™ä¸ªæµé€šå¸¸ï¼ˆä½†ä¸æ€»æ˜¯ï¼‰ç”±æœ€åä¸€ä¸ªå¤„ç†ç¨‹åºç”Ÿæˆï¼Œè¿™è·Ÿ backend çš„å…·ä½“å®ç°æœ‰å…³ã€‚å…¶ä»–çš„å¤„ç†ç¨‹åºé€šå¸¸åªè¿”å›è¯¥æµã€‚ä¸‹é¢æ˜¯å¤§å¤šæ•°æ‹¦æˆªå™¨æœ€åçš„è¯­å¥ï¼š 1234intercept(req: HttpRequest&lt;any&gt;, next: HttpHandler): Observable&lt;HttpEvent&lt;any&gt;&gt; &#123; ... return next.handle(authReq);&#125; æ‰€ä»¥æˆ‘ä»¬å¯ä»¥è¿™æ ·æ¥å±•ç¤ºé€»è¾‘ï¼š console_4 ä½†æ˜¯å› ä¸ºä»»ä½•æ‹¦æˆªå™¨éƒ½å¯ä»¥è¿”å›ä¸€ä¸ª HttpEvents ç±»å‹çš„ observable æµï¼Œæ‰€ä»¥ä½ æœ‰å¾ˆå¤šå®šåˆ¶æœºä¼šã€‚ä¾‹å¦‚ï¼Œä½ å¯ä»¥å®ç°è‡ªå·±çš„ backend å¹¶å°†å…¶æ³¨å†Œä¸ºæ‹¦æˆªå™¨ã€‚æˆ–è€…å®ç°ä¸€ä¸ªç¼“å­˜æœºåˆ¶ï¼Œå¦‚æœæ‰¾åˆ°äº†ç¼“å­˜å°±ç«‹å³è¿”å›ï¼Œ è€Œä¸ç”¨äº¤ç»™ä¸‹ä¸ªå¤„ç†ç¨‹åºå¤„ç†ï¼š console_5 æ­¤å¤–ï¼Œç”±äºæ¯ä¸ªæ‹¦æˆªå™¨éƒ½å¯ä»¥è®¿é—®ä¸‹ä¸€ä¸ªæ‹¦æˆªå™¨ï¼ˆé€šè¿‡è°ƒç”¨ next.handler()ï¼‰è¿”å›çš„ observable æµï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥é€šè¿‡ RxJs æ“ä½œç¬¦æ·»åŠ è‡ªå®šä¹‰çš„é€»è¾‘æ¥ä¿®æ”¹è¿”å›çš„æµã€‚ æ„å»º HttpClient çš„ observable æµå¦‚æœæ‚¨ä»”ç»†é˜…è¯»äº†å‰é¢çš„éƒ¨åˆ†ï¼Œé‚£ä¹ˆæ‚¨ç°åœ¨å¯èƒ½æƒ³çŸ¥é“å¤„ç†é“¾åˆ›å»ºçš„ HTTP events æµæ˜¯å¦ä¸è°ƒç”¨ HttpClient æ–¹æ³•ï¼Œå¦‚ get æˆ–è€… post æ‰€è¿”å›çš„æµå®Œå…¨ç›¸åŒã€‚å’¦â€¦ä¸æ˜¯ï¼å®ç°çš„è¿‡ç¨‹æ›´æœ‰æ„æ€ã€‚ HttpClient é€šè¿‡ä½¿ç”¨ RxJS çš„åˆ›å»ºæ“ä½œç¬¦ of æ¥å°†è¯·æ±‚å¯¹è±¡å˜ä¸º observable æµï¼Œå¹¶åœ¨è°ƒç”¨ HttpClient çš„ HTTP request æ–¹æ³•æ—¶è¿”å›å®ƒã€‚å¤„ç†ç¨‹åºé“¾ä½œä¸ºæ­¤æµçš„ä¸€éƒ¨åˆ†è¢«åŒæ­¥å¤„ç†ï¼Œå¹¶ä¸”ä½¿ç”¨ concatMap æ“ä½œç¬¦å‹å¹³é“¾è¿”å›çš„ observableã€‚å®ç°çš„å…³é”®ç‚¹å°±åœ¨ request æ–¹æ³•ï¼Œå› ä¸ºæ‰€æœ‰çš„ API æ–¹æ³•åƒ getï¼Œpost æˆ– deleteåªæ˜¯åŒ…è£…äº† request æ–¹æ³•ï¼š 123const events$: Observable&lt;HttpEvent&lt;any&gt;&gt; = of(req).pipe( concatMap((req: HttpRequest&lt;any&gt;) =&gt; this.handler.handle(req))); åœ¨ä¸Šé¢çš„ä»£ç ç‰‡æ®µä¸­ï¼Œæˆ‘ç”¨ pipe æ›¿æ¢äº†æ—§æŠ€æœ¯ callã€‚å¦‚æœæ‚¨ä»ç„¶å¯¹ concatMap å¦‚ä½•å·¥ä½œæ„Ÿåˆ°å›°æƒ‘ï¼Œä½ å¯ä»¥é˜…è¯»å­¦ä¹ å°† RxJs åºåˆ—ä¸è¶…çº§ç›´è§‚çš„äº¤äº’å¼å›¾è¡¨ç›¸ç»“åˆã€‚æœ‰è¶£çš„æ˜¯ï¼Œå¤„ç†ç¨‹åºé“¾åœ¨ä»¥ of å¼€å¤´çš„ observable æµä¸­æ‰§è¡Œæ˜¯æœ‰åŸå› çš„ï¼Œè¿™é‡Œæœ‰ä¸€ä¸ªè§£é‡Šï¼š Start with an Observable.of() the initial request, and run the handler (which includes all interceptors) inside a concatMap(). This way, the handler runs inside an Observable chain, which causes interceptors to be re-run on every subscription (this also makes retries re-run the handler, including interceptors). é€šè¿‡ Observable.of() åˆå§‹è¯·æ±‚ï¼Œå¹¶åœ¨ concatMap() ä¸­è¿è¡Œå¤„ç†ç¨‹åºï¼ˆåŒ…æ‹¬æ‰€æœ‰æ‹¦æˆªå™¨ï¼‰ã€‚è¿™æ ·ï¼Œå¤„ç†ç¨‹åºå°±åœ¨ä¸€ä¸ª Observable é“¾ä¸­è¿è¡Œï¼Œè¿™ä¼šä½¿å¾—æ‹¦æˆªå™¨ä¼šåœ¨æ¯ä¸ªè®¢é˜…ä¸Šé‡æ–°è¿è¡Œï¼ˆè¿™æ ·é‡è¯•çš„æ—¶å€™ä¹Ÿä¼šé‡æ–°è¿è¡Œå¤„ç†ç¨‹åºï¼ŒåŒ…æ‹¬æ‹¦æˆªå™¨ï¼‰ã€‚ å¤„ç† â€˜observeâ€™ è¯·æ±‚é€‰é¡¹é€šè¿‡ HttpClient åˆ›å»ºçš„åˆå§‹ observable æµ,å‘å‡ºäº†æ‰€æœ‰çš„ HTTP eventsï¼Œå¦‚ HttpProgressEventï¼ŒHttpHeaderResponse æˆ– HttpResponseã€‚ä½†æ˜¯ä»æ–‡æ¡£ä¸­æˆ‘ä»¬çŸ¥é“æˆ‘ä»¬å¯ä»¥é€šè¿‡è®¾ç½® observe é€‰é¡¹æ¥æŒ‡å®šæˆ‘ä»¬æ„Ÿå…´è¶£çš„äº‹ä»¶ï¼š 1234request() &#123; const url = 'https://jsonplaceholder.typicode.com/posts/1'; this.response = this.http.get(url, &#123;observe: 'body'&#125;);&#125; ä½¿ç”¨ {observe: &#39;body&#39;} åï¼Œä» get æ–¹æ³•è¿”å›çš„ observable æµåªä¼šå‘å‡ºå“åº”ä¸­ body éƒ¨åˆ†çš„å†…å®¹ã€‚ observe çš„å…¶ä»–é€‰é¡¹è¿˜æœ‰ events å’Œ response å¹¶ä¸” response æ˜¯é»˜è®¤é€‰é¡¹ã€‚åœ¨æ¢ç´¢å¤„ç†ç¨‹åºé“¾çš„å®ç°çš„ä¸€å¼€å§‹ï¼Œæˆ‘å°±æŒ‡å‡ºè¿‡è°ƒç”¨å¤„ç†ç¨‹åºé“¾è¿”å›çš„æµä¼šå‘å‡ºæ‰€æœ‰ HTTP eventsã€‚æ ¹æ® observe çš„å‚æ•°è¿‡æ»¤è¿™äº› events æ˜¯ HttpClient çš„è´£ä»»ã€‚ è¿™æ„å‘³ç€æˆ‘åœ¨ä¸Šä¸€èŠ‚ä¸­æ¼”ç¤º HttpClient è¿”å›æµçš„å®ç°éœ€è¦ç¨å¾®è°ƒæ•´ä¸€ä¸‹ã€‚æˆ‘ä»¬éœ€è¦åšçš„æ˜¯è¿‡æ»¤è¿™äº› events å¹¶æ ¹æ® observe å‚æ•°å€¼å°†å®ƒä»¬æ˜ å°„åˆ°ä¸åŒçš„å€¼ã€‚æ¥ä¸‹æ¥ç®€å•å®ç°ä¸‹ï¼š 1234567891011121314151617const events$: Observable&lt;HttpEvent&lt;any&gt;&gt; = of(req).pipe(...)if (options.observe === 'events') &#123; return events$;&#125;const res$: Observable&lt;HttpResponse&lt;any&gt;&gt; = events$.pipe(filter((event: HttpEvent&lt;any&gt;) =&gt; event instanceof HttpResponse));if (options.observe === 'response') &#123; return res$;&#125;if (options.observe === 'body') &#123; return res$.pipe(map((res: HttpResponse&lt;any&gt;) =&gt; res.body));&#125; åœ¨è¿™é‡Œï¼Œæ‚¨å¯ä»¥æ‰¾åˆ°æºç ã€‚ ä¸å¯å˜æ€§çš„éœ€è¦æ–‡æ¡£ä¸Šå…³äºä¸å˜æ€§çš„ä¸€ä¸ªæœ‰è¶£çš„æ®µè½æ˜¯è¿™æ ·çš„ï¼š Interceptors exist to examine and mutate outgoing requests and incoming responses. However, it may be surprising to learn that the HttpRequest and HttpResponse classes are largely immutable. This is for a reason: because the app may retry requests, the interceptor chain may process an individual request multiple times. If requests were mutable, a retried request would be different than the original request. Immutability ensures the interceptors see the same request for each try. è™½ç„¶æ‹¦æˆªå™¨æœ‰èƒ½åŠ›æ”¹å˜è¯·æ±‚å’Œå“åº”ï¼Œä½† HttpRequest å’Œ HttpResponse å®ä¾‹çš„å±æ€§å´æ˜¯åªè¯»ï¼ˆreadonlyï¼‰çš„ï¼Œå› æ­¤ï¼Œå®ƒä»¬åœ¨å¾ˆå¤§æ„ä¹‰ä¸Šè¯´æ˜¯ä¸å¯å˜å¯¹è±¡ã€‚æœ‰å……è¶³çš„ç†ç”±æŠŠå®ƒä»¬åšæˆä¸å¯å˜å¯¹è±¡ï¼šåº”ç”¨å¯èƒ½ä¼šé‡è¯•å‘é€å¾ˆå¤šæ¬¡è¯·æ±‚ä¹‹åæ‰èƒ½æˆåŠŸï¼Œè¿™å°±æ„å‘³ç€è¿™ä¸ªæ‹¦æˆªå™¨é“¾è¡¨å¯èƒ½ä¼šå¤šæ¬¡é‡å¤å¤„ç†åŒä¸€ä¸ªè¯·æ±‚ã€‚ å¦‚æœæ‹¦æˆªå™¨å¯ä»¥ä¿®æ”¹åŸå§‹çš„è¯·æ±‚å¯¹è±¡ï¼Œé‚£ä¹ˆé‡è¯•é˜¶æ®µçš„æ“ä½œå°±ä¼šä»ä¿®æ”¹è¿‡çš„è¯·æ±‚å¼€å§‹ï¼Œè€Œä¸æ˜¯åŸå§‹è¯·æ±‚ã€‚ è€Œè¿™ç§ä¸å¯å˜æ€§ï¼Œå¯ä»¥ç¡®ä¿è¿™äº›æ‹¦æˆªå™¨åœ¨æ¯æ¬¡é‡è¯•æ—¶çœ‹åˆ°çš„éƒ½æ˜¯åŒæ ·çš„åŸå§‹è¯·æ±‚ã€‚ è®©æˆ‘è¯¦ç»†è¯´æ˜ä¸€ä¸‹ã€‚å½“æ‚¨è°ƒç”¨ HttpClient çš„ä»»ä½• HTTP è¯·æ±‚æ–¹æ³•æ—¶ï¼Œå°±ä¼šåˆ›å»ºè¯·æ±‚å¯¹è±¡ã€‚æ­£å¦‚æˆ‘åœ¨å‰é¢éƒ¨åˆ†ä¸­è§£é‡Šçš„é‚£æ ·ï¼Œæ­¤è¯·æ±‚ç”¨äºç”Ÿæˆä¸€ä¸ª events$ çš„ observable åºåˆ—ï¼Œå¹¶ä¸”åœ¨è®¢é˜…æ—¶ï¼Œå®ƒä¼šåœ¨å¤„ç†ç¨‹åºé“¾ä¸­è¢«ä¼ é€’ã€‚ä½†æ˜¯ events$ æµå¯èƒ½ä¼šè¢«é‡è¯•ï¼Œè¿™æ„å‘³ç€åœ¨åºåˆ—ä¹‹å¤–åˆ›å»ºçš„åŸå§‹è¯·æ±‚å¯¹è±¡å¯èƒ½å†æ¬¡è§¦å‘åºåˆ—å¤šæ¬¡ã€‚ä½†æ‹¦æˆªå™¨åº”å§‹ç»ˆä»¥åŸå§‹è¯·æ±‚å¼€å§‹ã€‚å¦‚æœè¯·æ±‚æ˜¯å¯å˜çš„ï¼Œå¹¶ä¸”å¯ä»¥åœ¨æ‹¦æˆªå™¨è¿è¡ŒæœŸé—´è¿›è¡Œä¿®æ”¹ï¼Œåˆ™æ­¤æ¡ä»¶ä¸é€‚ç”¨äºä¸‹ä¸€æ¬¡æ‹¦æˆªå™¨è¿è¡Œã€‚ç”±äºåŒä¸€è¯·æ±‚å¯¹è±¡çš„å¼•ç”¨å°†å¤šæ¬¡ç”¨äºå¼€å§‹ observable åºåˆ—ï¼Œè¯·æ±‚åŠå…¶æ‰€æœ‰ç»„æˆéƒ¨åˆ†ï¼Œå¦‚ HttpHeaders å’Œ HttpParams åº”è¯¥æ˜¯ä¸å¯å˜çš„ã€‚","tags":[{"name":"Angular","slug":"Angular","permalink":"http://tanyibing.com/tags/Angular/"},{"name":"Typescript","slug":"Typescript","permalink":"http://tanyibing.com/tags/Typescript/"}]},{"title":"[ç¿»è¯‘]OnPushç»„ä»¶ä¸­NgDoCheckå’ŒAsyncPipeçš„åŒºåˆ«","date":"2018-12-14T13:59:55.000Z","path":"2018/12/14/ç¿»è¯‘-OnPushç»„ä»¶ä¸­NgDoCheckå’ŒAsyncPipeçš„åŒºåˆ«/","text":"[ç¿»è¯‘] OnPush ç»„ä»¶ä¸­ NgDoCheck å’Œ AsyncPipe çš„åŒºåˆ« åŸæ–‡ï¼šThe difference between NgDoCheck and AsyncPipe in OnPush componentsä½œè€…ï¼šMax KoretskyiåŸæŠ€æœ¯åšæ–‡ç”± Max Koretskyi æ’°å†™å‘å¸ƒï¼Œä»–ç›®å‰äº ag-Grid æ‹…ä»»å¼€å‘è€…èŒä½ è¯‘è€…ï¼šIce Panpan async or ngdocheck è¿™ç¯‡æ–‡ç« æ˜¯å¯¹Shaiè¿™æ¡æ¨ç‰¹çš„å›åº”ã€‚ä»–è¯¢é—®ä½¿ç”¨ NgDoCheck ç”Ÿå‘½å‘¨æœŸé’©å­æ¥æ‰‹åŠ¨æ¯”è¾ƒå€¼è€Œä¸æ˜¯ä½¿ç”¨ asyncPipe æ˜¯å¦æœ‰æ„ä¹‰ã€‚è¿™æ˜¯ä¸€ä¸ªéå¸¸å¥½çš„é—®é¢˜ï¼Œéœ€è¦å¯¹å¼•æ“çš„å·¥ä½œåŸç†æœ‰å¾ˆå¤šäº†è§£ï¼šå˜åŒ–æ£€æµ‹(change detection)ï¼Œç®¡é“(pipe)å’Œç”Ÿå‘½å‘¨æœŸé’©å­(lifecycle hooks)ã€‚é‚£å°±æ˜¯æˆ‘æ¢ç´¢çš„å…¥å£ğŸ˜ã€‚ åœ¨æœ¬æ–‡ä¸­ï¼Œæˆ‘å°†å‘æ‚¨å±•ç¤ºå¦‚ä½•æ‰‹åŠ¨å¤„ç†å˜æ›´æ£€æµ‹ã€‚è¿™äº›æŠ€æœ¯ä½¿æ‚¨å¯ä»¥æ›´å¥½åœ°æŒæ§ Angular çš„è¾“å…¥ç»‘å®š(input bindings)çš„è‡ªåŠ¨æ‰§è¡Œå’Œå¼‚æ­¥å€¼æ£€æŸ¥(async values checks)ã€‚æŒæ¡äº†è¿™äº›çŸ¥è¯†ä¹‹åï¼Œæˆ‘è¿˜å°†ä¸æ‚¨åˆ†äº«æˆ‘å¯¹è¿™äº›è§£å†³æ–¹æ¡ˆçš„æ€§èƒ½å½±å“çš„çœ‹æ³•ã€‚è®©æˆ‘ä»¬å¼€å§‹å§ï¼ OnPush ç»„ä»¶åœ¨ Angular ä¸­ï¼Œæˆ‘ä»¬æœ‰ä¸€ç§éå¸¸å¸¸è§çš„ä¼˜åŒ–æŠ€æœ¯ï¼Œéœ€è¦å°† ChangeDetectionStrategy.OnPush æ·»åŠ åˆ°ç»„ä»¶ä¸­ã€‚å‡è®¾æˆ‘ä»¬æœ‰å¦‚ä¸‹ä¸¤ä¸ªç®€å•çš„ç»„ä»¶ï¼š 1234567891011121314@Component(&#123; selector: 'a-comp', template: ` &lt;span&gt;I am A component&lt;/span&gt; &lt;b-comp&gt;&lt;/b-comp&gt; `&#125;)export class AComponent &#123;&#125;@Component(&#123; selector: 'b-comp', template: `&lt;span&gt;I am B component&lt;/span&gt;`&#125;)export class BComponent &#123;&#125; è¿™æ ·è®¾ç½®ä¹‹åï¼Œ Angular æ¯æ¬¡éƒ½ä¼šå¯¹ A å’Œ B ä¸¤ä¸ªç»„ä»¶è¿è¡Œå˜æ›´æ£€æµ‹ã€‚å¦‚æœæˆ‘ä»¬ç°åœ¨ä¸º B ç»„ä»¶æ·»åŠ ä¸Š OnPush ç­–ç•¥ï¼š 123456@Component(&#123; selector: 'b-comp', template: `&lt;span&gt;I am B component&lt;/span&gt;`, changeDetection: ChangeDetectionStrategy.OnPush&#125;)export class BComponent &#123;&#125; åªæœ‰åœ¨è¾“å…¥ç»‘å®šçš„å€¼å‘ç”Ÿå˜åŒ–æ—¶ Angular æ‰ä¼šå¯¹ B è¿è¡Œå˜æ›´æ£€æµ‹ã€‚ç”±äºå®ƒç°åœ¨æ²¡æœ‰ä»»ä½•ç»‘å®šï¼Œå› æ­¤è¯¥ç»„ä»¶åªä¼šåœ¨åˆå§‹åŒ–çš„æ—¶å€™æ£€æŸ¥ä¸€æ¬¡ã€‚ æ‰‹åŠ¨è§¦å‘å˜æ›´æ£€æµ‹æœ‰æ²¡æœ‰åŠæ³•å¼ºåˆ¶å¯¹ B ç»„ä»¶è¿›è¡Œå˜æ›´æ£€æµ‹ï¼Ÿæ˜¯çš„ï¼Œæˆ‘ä»¬å¯ä»¥æ³¨å…¥ changeDetectorRef å¹¶ä½¿ç”¨å®ƒçš„æ–¹æ³• markForCheck æ¥æŒ‡ç¤º Angular éœ€è¦æ£€æŸ¥è¯¥ç»„ä»¶ã€‚å¹¶ä¸”ç”±äº NgDoCheck é’©å­ä»ç„¶ä¼šè¢« B ç»„ä»¶è§¦å‘ï¼Œæ‰€ä»¥æˆ‘ä»¬åº”è¯¥åœ¨ NgDoCheck ä¸­è°ƒç”¨ markForCheckï¼š 123456789101112@Component(&#123; selector: 'b-comp', template: `&lt;span&gt;I am B component&lt;/span&gt;`, changeDetection: ChangeDetectionStrategy.OnPush&#125;)export class BComponent &#123; constructor(private cd: ChangeDetectorRef) &#123;&#125; ngDoCheck() &#123; this.cd.markForCheck(); &#125;&#125; ç°åœ¨ï¼Œå½“ Angular æ£€æŸ¥çˆ¶ç»„ä»¶ A æ—¶ï¼Œå°†å§‹ç»ˆæ£€æŸ¥ B ç»„ä»¶ã€‚ç°åœ¨è®©æˆ‘ä»¬çœ‹çœ‹æˆ‘ä»¬å¯ä»¥åœ¨å“ªé‡Œä½¿ç”¨å®ƒã€‚ è¾“å…¥ç»‘å®šæˆ‘ä¹‹å‰è¯´è¿‡ï¼ŒAngular åªåœ¨ OnPush ç»„ä»¶çš„ç»‘å®šå‘ç”Ÿå˜åŒ–æ—¶è¿è¡Œçš„å˜åŒ–æ£€æµ‹ã€‚æ‰€ä»¥è®©æˆ‘ä»¬çœ‹ä¸€ä¸‹è¾“å…¥ç»‘å®šçš„ä¾‹å­ã€‚å‡è®¾æˆ‘ä»¬æœ‰ä¸€ä¸ªé€šè¿‡è¾“å…¥ç»‘å®šä»çˆ¶ç»„ä»¶ä¼ é€’ä¸‹æ¥çš„å¯¹è±¡ï¼š 1234567891011@Component(&#123; selector: 'b-comp', template: ` &lt;span&gt;I am B component&lt;/span&gt; &lt;span&gt;User name: &#123;&#123;user.name&#125;&#125;&lt;/span&gt; `, changeDetection: ChangeDetectionStrategy.OnPush&#125;)export class BComponent &#123; @Input() user;&#125; åœ¨çˆ¶ç»„ä»¶ A ä¸­ï¼Œæˆ‘ä»¬å®šä¹‰äº†ä¸€ä¸ªå¯¹è±¡ï¼Œå¹¶å®ç°äº†åœ¨å•å‡»æŒ‰é’®æ—¶æ¥æ›´æ–°å¯¹è±¡åç§°çš„ changeName æ–¹æ³•ï¼š 123456789101112131415@Component(&#123; selector: 'a-comp', template: ` &lt;span&gt;I am A component&lt;/span&gt; &lt;button (click)=\"changeName()\"&gt;Trigger change detection&lt;/button&gt; &lt;b-comp [user]=\"user\"&gt;&lt;/b-comp&gt; `&#125;)export class AComponent &#123; user = &#123;name: 'A'&#125;; changeName() &#123; this.user.name = 'B'; &#125;&#125; å¦‚æœæ‚¨ç°åœ¨è¿è¡Œæ­¤ç¤ºä¾‹ï¼Œåˆ™åœ¨ç¬¬ä¸€æ¬¡å˜æ›´æ£€æµ‹åï¼Œæ‚¨å°†çœ‹åˆ°ç”¨æˆ·åç§°è¢«æ‰“å°å‡ºæ¥ï¼š 1User name: A ä½†æ˜¯å½“æˆ‘ä»¬ç‚¹å‡»æŒ‰é’®å¹¶å›è°ƒä¸­æ›´æ”¹åç§°æ—¶ï¼š 123changeName() &#123; this.user.name = 'B';&#125; è¯¥åç§°å¹¶æ²¡æœ‰åœ¨å±å¹•ä¸Šæ›´æ–°ï¼Œè¿™æ˜¯å› ä¸º Angular å¯¹è¾“å…¥å‚æ•°æ‰§è¡Œæµ…æ¯”è¾ƒï¼Œå¹¶ä¸”å¯¹ user å¯¹è±¡çš„å¼•ç”¨æ²¡æœ‰æ”¹å˜ã€‚é‚£æˆ‘ä»¬æ€ä¹ˆè§£å†³è¿™ä¸ªé—®é¢˜å‘¢ï¼Ÿ å¥½å§ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨æ£€æµ‹åˆ°å·®å¼‚æ—¶æ‰‹åŠ¨æ£€æŸ¥åç§°å¹¶è§¦å‘å˜æ›´æ£€æµ‹ï¼š 123456789101112131415161718192021@Component(&#123; selector: 'b-comp', template: ` &lt;span&gt;I am B component&lt;/span&gt; &lt;span&gt;User name: &#123;&#123;user.name&#125;&#125;&lt;/span&gt; `, changeDetection: ChangeDetectionStrategy.OnPush&#125;)export class BComponent &#123; @Input() user; previousName = ''; constructor(private cd: ChangeDetectorRef) &#123;&#125; ngDoCheck() &#123; if (this.previousName !== this.user.name) &#123; this.previousName = this.user.name; this.cd.markForCheck(); &#125; &#125;&#125; å¦‚æœæ‚¨ç°åœ¨è¿è¡Œæ­¤ä»£ç ï¼Œä½ å°†åœ¨å±å¹•ä¸Šçœ‹åˆ°æ›´æ–°çš„åç§°ã€‚ å¼‚æ­¥æ›´æ–°ç°åœ¨ï¼Œè®©æˆ‘ä»¬çš„ä¾‹å­æ›´å¤æ‚ä¸€ç‚¹ã€‚æˆ‘ä»¬å°†ä»‹ç»ä¸€ç§åŸºäº RxJs çš„æœåŠ¡ï¼Œå®ƒå¯ä»¥å¼‚æ­¥å‘å‡ºæ›´æ–°ã€‚è¿™ç±»ä¼¼äº NgRx çš„ä½“ç³»ç»“æ„ã€‚æˆ‘å°†ä½¿ç”¨ä¸€ä¸ª BehaviorSubject ä½œä¸ºå€¼çš„æ¥æºï¼Œå› ä¸ºæˆ‘ä»¬éœ€è¦åœ¨è¿™ä¸ªæµçš„æœ€å¼€å§‹è®¾ç½®åˆå§‹å€¼ï¼š 12345678910111213141516@Component(&#123; selector: 'a-comp', template: ` &lt;span&gt;I am A component&lt;/span&gt; &lt;button (click)=\"changeName()\"&gt;Trigger change detection&lt;/button&gt; &lt;b-comp [user]=\"user\"&gt;&lt;/b-comp&gt; `&#125;)export class AComponent &#123; stream = new BehaviorSubject(&#123;name: 'A'&#125;); user = this.stream.asObservable(); changeName() &#123; this.stream.next(&#123;name: 'B'&#125;); &#125;&#125; æ‰€ä»¥æˆ‘ä»¬éœ€è¦åœ¨å­ç»„ä»¶ä¸­è®¢é˜…è¿™ä¸ªæµå¹¶ä»ä¸­è·å–åˆ° user å¯¹è±¡ã€‚æˆ‘ä»¬éœ€è¦è®¢é˜…æµå¹¶æ£€æŸ¥å€¼æ˜¯å¦æ›´æ–°ã€‚è¿™æ ·åšçš„å¸¸ç”¨æ–¹æ³•æ˜¯ä½¿ç”¨ AsyncPipeã€‚ AsyncPipeæ‰€ä»¥è¿™é‡Œæ˜¯å­ç»„ä»¶ B çš„å®ç°ï¼š 1234567891011@Component(&#123; selector: 'b-comp', template: ` &lt;span&gt;I am B component&lt;/span&gt; &lt;span&gt;User name: &#123;&#123;(user | async).name&#125;&#125;&lt;/span&gt; `, changeDetection: ChangeDetectionStrategy.OnPush&#125;)export class BComponent &#123; @Input() user;&#125; è¿™æ˜¯æ¼”ç¤ºã€‚ä½†æ˜¯ï¼Œè¿˜æœ‰å¦ä¸€ç§ä¸ä½¿ç”¨ç®¡é“çš„æ–¹æ³•å—ï¼Ÿ æ‰‹åŠ¨æ£€æŸ¥å¹¶ä¸”å˜æ›´æ£€æµ‹æ˜¯çš„ï¼Œæˆ‘ä»¬å¯ä»¥æ‰‹åŠ¨æ£€æŸ¥å€¼å¹¶åœ¨éœ€è¦æ—¶è§¦å‘å˜æ›´æ£€æµ‹ã€‚æ­£å¦‚å¼€å¤´çš„ä¾‹å­ä¸€æ ·ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ NgDoCheck ç”Ÿå‘½å‘¨æœŸé’©å­ï¼š 12345678910111213141516171819202122232425262728@Component(&#123; selector: 'b-comp', template: ` &lt;span&gt;I am B component&lt;/span&gt; &lt;span&gt;User name: &#123;&#123;user.name&#125;&#125;&lt;/span&gt; `, changeDetection: ChangeDetectionStrategy.OnPush&#125;)export class BComponent &#123; @Input('user') user$; user; previousName = ''; constructor(private cd: ChangeDetectorRef) &#123;&#125; ngOnInit() &#123; this.user$.subscribe((user) =&gt; &#123; this.user = user; &#125;) &#125; ngDoCheck() &#123; if (this.previousName !== this.user.name) &#123; this.previousName = this.user.name; this.cd.markForCheck(); &#125; &#125;&#125; ä½ å¯ä»¥åœ¨è¿™æŸ¥çœ‹ã€‚ æˆ‘ä»¬å¸Œæœ›æŠŠå€¼çš„æ¯”è¾ƒä¸æ›´æ–°é€»è¾‘ä» NgDoCheck ä¸­ç§»è‡³è®¢é˜…çš„å›è°ƒå‡½æ•°ï¼Œå› ä¸ºæˆ‘ä»¬æ˜¯ä»é‚£é‡Œè·å–åˆ°æ–°å€¼çš„ï¼š 123456789101112131415export class BComponent &#123; @Input('user') user$; user = &#123;name: null&#125;; constructor(private cd: ChangeDetectorRef) &#123;&#125; ngOnInit() &#123; this.user$.subscribe((user) =&gt; &#123; if (this.user.name !== user.name) &#123; this.cd.markForCheck(); this.user = user; &#125; &#125;) &#125;&#125; ä¾‹å­åœ¨è¿™ã€‚ æœ‰è¶£çš„æ˜¯ï¼Œè¿™å…¶å®æ­£æ˜¯ AsyncPipe èƒŒåçš„å·¥ä½œåŸç†ï¼š 123456789101112131415161718192021222324252627282930@Pipe(&#123;name: 'async', pure: false&#125;)export class AsyncPipe implements OnDestroy, PipeTransform &#123; constructor(private _ref: ChangeDetectorRef) &#123;&#125; transform(obj: ...): any &#123; ... this._subscribe(obj); ... if (this._latestValue === this._latestReturnedValue) &#123; return this._latestReturnedValue; &#125; this._latestReturnedValue = this._latestValue; return WrappedValue.wrap(this._latestValue); &#125; private _subscribe(obj): void &#123; ... this._strategy.createSubscription( obj, (value: Object) =&gt; this._updateLatestValue(obj, value)); &#125; private _updateLatestValue(async: any, value: Object): void &#123; if (async === this._obj) &#123; this._latestValue = value; this._ref.markForCheck(); &#125; &#125;&#125; é‚£ä¹ˆé‚£ç§è§£å†³æ–¹æ¡ˆæ›´å¿«ï¼Ÿç°åœ¨æˆ‘ä»¬çŸ¥é“å¦‚ä½•ä½¿ç”¨æ‰‹åŠ¨è¿›è¡Œå˜æ›´æ£€æµ‹è€Œä¸æ˜¯ä½¿ç”¨ AsyncPipeï¼Œè®©æˆ‘ä»¬å›ç­”ä¸‹æœ€ä¸€å¼€å§‹çš„é—®é¢˜ã€‚é‚£ç§æ–¹æ³•æ›´å¿«ï¼Ÿ å—¯â€¦è¿™å–å†³äºä½ å¦‚ä½•æ¯”è¾ƒå®ƒä»¬ï¼Œä½†åœ¨å…¶ä»–æ¡ä»¶ç›¸åŒçš„æƒ…å†µä¸‹ï¼Œæ‰‹åŠ¨æ–¹æ³•ä¼šæ›´å¿«ã€‚å°½ç®¡æˆ‘ä¸è®¤ä¸ºä¸¤è€…ä¼šæœ‰æ˜æ˜¾åŒºåˆ«ã€‚ä»¥ä¸‹æ˜¯ä¸ºä»€ä¹ˆæ‰‹åŠ¨æ–¹æ³•å¯ä»¥æ›´å¿«çš„å‡ ä¸ªä¾‹å­ã€‚ å°±å†…å­˜è€Œè¨€ï¼Œæ‚¨ä¸éœ€è¦åˆ›å»º Pipe ç±»çš„å®ä¾‹ã€‚å°±ç¼–è¯‘æ—¶é—´è€Œè¨€ï¼Œç¼–è¯‘å™¨ä¸å¿…èŠ±æ—¶é—´è§£æç®¡é“ç‰¹å®šè¯­æ³•å¹¶ç”Ÿæˆç®¡é“ç‰¹å®šè¾“å‡ºã€‚å°±è¿è¡Œæ—¶é—´è€Œè¨€ï¼ŒèŠ‚çœäº†å¼‚æ­¥ç®¡é“ä¸ºç»„ä»¶è¿›è¡Œå˜æ›´æ£€æµ‹æ‰€è°ƒç”¨çš„å‡½æ•°çš„æ—¶é—´ã€‚è¿™ä¸ªä¾‹å­æ¼”ç¤ºäº†å½“ä»£ç ä¸­åŒ…å« pipe æ—¶ updateRenderer æ‰€ç”Ÿæˆçš„ä»£ç ï¼š 12345function (_ck, _v) &#123; var _co = _v.component; var currVal_0 = jit_unwrapValue_7(_v, 3, 0, asyncpipe.transform(_co.user)).name; _ck(_v, 3, 0, currVal_0);&#125; å¦‚æ‚¨æ‰€è§ï¼Œå¼‚æ­¥ç®¡é“çš„ä»£ç è°ƒç”¨ç®¡é“å®ä¾‹ä¸Šçš„ transform æ–¹æ³•ä»¥è·å–æ–°å€¼ã€‚ç®¡é“å°†è¿”å›ä»è®¢é˜…ä¸­æ”¶åˆ°çš„æœ€æ–°å€¼ã€‚ å°†å…¶ä¸ä¸ºæ‰‹åŠ¨æ–¹æ³•ç”Ÿæˆçš„æ™®é€šä»£ç è¿›è¡Œæ¯”è¾ƒï¼š 12345function(_ck,_v) &#123; var _co = _v.component; var currVal_0 = _co.user.name; _ck(_v,3,0,currVal_0);&#125; è¿™å°±æ˜¯ Angular åœ¨æ£€æŸ¥ B ç»„ä»¶æ—¶è°ƒç”¨çš„æ–¹æ³•ã€‚ ä¸€äº›æ›´æœ‰è¶£çš„äº‹æƒ…ä¸æ‰§è¡Œæµ…æ¯”è¾ƒçš„è¾“å…¥ç»‘å®šä¸åŒï¼Œå¼‚æ­¥ç®¡é“çš„å®ç°æ ¹æœ¬ä¸æ‰§è¡Œæ¯”è¾ƒï¼ˆæ„Ÿè°¢ Olena Horal æ³¨æ„åˆ°è¿™ä¸€ç‚¹ï¼‰ã€‚å®ƒå°†æ¯ä¸ªæ–°å‘å°„çš„å€¼è®¤ä¸ºæ˜¯æ›´æ–°ï¼Œå³ä½¿å®ƒä¸å…ˆå‰å‘å°„çš„å€¼ä¸€æ ·ã€‚ä¸‹é¢çš„ä»£ç æ˜¯çˆ¶ç»„ä»¶ A çš„å®ç°ï¼Œå®ƒæ¯æ¬¡éƒ½å‘å°„å‡ºç›¸åŒçš„å¯¹è±¡ã€‚å°½ç®¡å¦‚æ­¤ï¼ŒAngular ä»ç„¶ä¼šå¯¹ B ç»„ä»¶è¿›è¡Œå˜æ›´æ£€æµ‹ï¼š 12345678export class AComponent &#123; o = &#123;name: 'A'&#125;; user = new BehaviorSubject(this.o); changeName() &#123; this.user.next(this.o); &#125;&#125; è¿™æ„å‘³ç€æ¯æ¬¡å‘å‡ºæ–°å€¼æ—¶ï¼Œä½¿ç”¨å¼‚æ­¥ç®¡é“çš„ç»„ä»¶éƒ½ä¼šè¢«æ ‡è®°ä»¥è¿›è¡Œæ£€æŸ¥ã€‚å¹¶ä¸” Angular å°†åœ¨ä¸‹æ¬¡è¿è¡Œå˜æ›´æ£€æµ‹æ—¶æ£€æŸ¥è¯¥ç»„ä»¶ï¼Œå³ä½¿è¯¥å€¼æœªæ›´æ”¹ã€‚ è¿™æ˜¯åº”ç”¨äºä»€ä¹ˆæƒ…å†µå‘¢ï¼Ÿå—¯â€¦åœ¨æˆ‘ä»¬çš„ä¾‹å­ä¸­ï¼Œæˆ‘ä»¬åªå…³æ³¨ user å¯¹è±¡çš„ name å±æ€§ï¼Œå› ä¸ºæˆ‘ä»¬éœ€è¦åœ¨æ¨¡æ¿ä¸­ä½¿ç”¨å®ƒã€‚æˆ‘ä»¬å¹¶ä¸å…³å¿ƒæ•´ä¸ªå¯¹è±¡ä»¥åŠå¯¹è±¡çš„å¼•ç”¨å¯èƒ½ä¼šæ”¹å˜çš„äº‹å®ã€‚å¦‚æœ name æ²¡æœ‰å‘ç”Ÿæ”¹å˜ï¼Œæˆ‘ä»¬ä¸éœ€è¦é‡æ–°æ¸²æŸ“ç»„ä»¶ã€‚ä½†ä½ æ— æ³•ç”¨å¼‚æ­¥ç®¡é“æ¥é¿å…è¿™ç§æƒ…å†µã€‚ NgDoCheck å¹¶ä¸æ˜¯æ²¡æœ‰é—®é¢˜:)ç”±äºä»…åœ¨æ£€æŸ¥çˆ¶ç»„ä»¶æ—¶è§¦å‘é’©å­ï¼Œå¦‚æœå…¶ä¸­ä¸€ä¸ªçˆ¶ç»„ä»¶ä½¿ç”¨ OnPush ç­–ç•¥å¹¶ä¸”åœ¨å˜æ›´æ£€æµ‹æœŸé—´æœªæ£€æŸ¥ï¼Œåˆ™ä¸ä¼šè§¦å‘è¯¥é’©å­ã€‚å› æ­¤ï¼Œå½“æ‚¨é€šè¿‡æœåŠ¡æ”¶åˆ°æ–°å€¼æ—¶ï¼Œä¸èƒ½ä¾èµ–å®ƒæ¥è§¦å‘å˜æ›´æ£€æµ‹ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæˆ‘åœ¨è®¢é˜…å›è°ƒä¸­è°ƒç”¨ markForCheck æ–¹æ³•æ˜¯æ­£ç¡®çš„è§£å†³æ–¹æ¡ˆã€‚ æ€»ç»“åŸºæœ¬ä¸Šï¼Œæ‰‹åŠ¨æ¯”è¾ƒå¯ä»¥è®©æ‚¨æ›´å¥½åœ°æ§åˆ¶æ£€æŸ¥ã€‚æ‚¨å¯ä»¥å®šä¹‰ä½•æ—¶éœ€è¦æ£€æŸ¥ç»„ä»¶ã€‚è¿™ä¸è®¸å¤šå…¶ä»–å·¥å…·ç›¸åŒ - æ‰‹åŠ¨æ§åˆ¶ä¸ºæ‚¨æä¾›äº†æ›´å¤§çš„çµæ´»æ€§ï¼Œä½†æ‚¨å¿…é¡»çŸ¥é“è‡ªå·±åœ¨åšä»€ä¹ˆã€‚ä¸ºäº†è·å¾—è¿™äº›çŸ¥è¯†ï¼Œæˆ‘é¼“åŠ±æ‚¨æŠ•å…¥æ—¶é—´å’Œç²¾åŠ›å­¦ä¹ å’Œé˜…è¯»æ›´å¤šæ–‡ç« ã€‚ ä½ ä¸ç”¨æ‹…å¿ƒ NgDoCheck ç”Ÿå‘½å‘¨æœŸé’©å­è¢«è°ƒç”¨çš„é¢‘ç‡ï¼Œæˆ–è€…å®ƒä¼šæ¯”ç®¡é“çš„ transform æ–¹æ³•æ›´é¢‘ç¹åœ°è¢«è°ƒç”¨ã€‚é¦–å…ˆï¼Œæˆ‘ä¸Šé¢å·²ç»å±•ç¤ºäº†è§£å†³æ–¹æ¡ˆï¼Œå½“ä½¿ç”¨å¼‚æ­¥æµæ—¶ï¼Œä½ åº”è¯¥åœ¨è®¢é˜…çš„å›è°ƒä¸­è€Œéåœ¨è¯¥é’©å­å‡½æ•°ä¸­æ‰‹åŠ¨æ‰§è¡Œå˜æ›´æ£€æµ‹ã€‚å…¶æ¬¡ï¼Œåªæœ‰åœ¨çˆ¶ç»„ä»¶è¢«æ£€æµ‹åæ‰ä¼šè°ƒç”¨è¯¥é’©å­å‡½æ•°ã€‚å¦‚æœçˆ¶ç»„ä»¶æ²¡æœ‰è¢«æ£€æŸ¥ï¼Œåˆ™ä¸ä¼šè°ƒç”¨è¯¥é’©å­ã€‚å¯¹äºç®¡é“è€Œè¨€ï¼Œç”±äºæµä¸­çš„æµ…æ¯”è¾ƒå’Œæ›´æ”¹å¼•ç”¨çš„åŸå› ï¼Œç®¡é“çš„ transform æ–¹æ³•è¢«è°ƒç”¨çš„æ¬¡æ•°åªä¼šå’Œæ‰‹åŠ¨æ–¹æ³•ç›¸åŒç”šè‡³æ›´å¤šã€‚ æƒ³è¦äº†è§£æ›´è¿‡å…³äº Angular ä¸­ change detection çš„ç›¸å…³çŸ¥è¯†ï¼Ÿä»è¿™5ç¯‡æ–‡ç« å…¥æ‰‹ä¼šè®©ä½ æˆä¸º Angular å˜æ›´æ£€æµ‹æœºåˆ¶çš„ä¸“å®¶ã€‚å¦‚æœä½ æƒ³è¦ç‰¢å›ºæŒæ¡ Angular ä¸­å˜æ›´æ£€æµ‹æœºåˆ¶ï¼Œé‚£ä¹ˆè¿™ä¸€ç³»åˆ—çš„æ–‡ç« æ˜¯å¿…è¯»çš„ã€‚æ¯ä¸€ç¯‡æ–‡ç« éƒ½ä¼šåŸºäºå‰ä¸€ç¯‡æ–‡ç« ä¸­æ‰€è§£é‡Šçš„ç›¸å…³ä¿¡æ¯ï¼Œæ—¢åŒ…å«é«˜å±‚æ¬¡çš„æ¦‚è¿°åˆå›Šæ‹¬äº†å…·ä½“çš„å®ç°ç»†èŠ‚ï¼Œå¹¶ä¸”éƒ½é™„æœ‰ç›¸å…³æºä»£ç ã€‚","tags":[{"name":"Angular","slug":"Angular","permalink":"http://tanyibing.com/tags/Angular/"}]},{"title":"ã€ç¿»è¯‘ã€‘è°ƒè¯•Rxjsï¼ˆäºŒï¼‰ï¼šæ—¥å¿—è®°å½•","date":"2018-11-25T15:32:52.000Z","path":"2018/11/25/Rxjsï¼ˆäºŒï¼‰ï¼šæ—¥å¿—è®°å½•/","text":"[ç¿»è¯‘] è°ƒè¯• Rxjsï¼ˆäºŒï¼‰ï¼šæ—¥å¿—è®°å½• åŸæ–‡ï¼šDebugging RxJS, Part 2: Logging è¯‘è€…ï¼šIce Panpanï¼›æ ¡éªŒè€…ï¼šæš‚æ—  banner æ—¥å¿—è®°å½•å¹¶ä¸æ˜¯ä¸€ä»¶è®©äººå…´å¥‹çš„äº‹ã€‚ ç„¶è€Œï¼Œè¿™æ˜¯è·å¾—è¶³å¤Ÿçš„ä¿¡æ¯æ¥æ¨ç†é—®é¢˜æœ€ç›´æ¥çš„æ–¹æ³•ï¼Œè€Œä¸éœ€è¦å»çŒœæµ‹ã€‚å®ƒé€šå¸¸æ˜¯è°ƒè¯• RxJS ä»£ç çš„é¦–é€‰æ–¹æ³•ã€‚è¿™æ˜¯è¿™ä¸ªç³»åˆ—æ–‡ç« çš„ç¬¬äºŒç¯‡ï¼Œä¸“æ³¨äºä½¿ç”¨æ—¥å¿—è®°å½•æ¥è§£å†³å®é™…é—®é¢˜ã€‚åœ¨ç¬¬ä¸€ç¯‡è°ƒè¯• Rxjsï¼ˆä¸€ï¼‰ï¼šå·¥å…·ä¸­,ä¸»è¦ä»‹ç»çš„æ˜¯ rxjs-spyã€‚åœ¨æœ¬æ–‡ä¸­ï¼Œæˆ‘å°†å±•ç¤ºå¦‚ä½•ä½¿ç”¨ rxjs-spy ä»¥æœ€å°çš„å½±å“æ¥è·å–è¯¦ç»†å¹¶æœ‰é’ˆå¯¹æ€§çš„ä¿¡æ¯ã€‚ è®©æˆ‘ä»¬çœ‹ä¸€ä¸ªä½¿ç”¨ rxjs å’Œ rxjs-spy UMDæ†ç»‘çš„ç®€å•æ¡ˆä¾‹ï¼š 1234567891011121314RxSpy.spy();RxSpy.log(/user-.+/);RxSpy.log('users');const names = ['benlesh', 'kwonoj', 'staltz'];const users = Rx.Observable.forkJoin(...names.map(name =&gt; Rx.Observable .ajax .getJSON(`https://api.github.com/users/$&#123;name&#125;`) .tag(`user-$&#123;name&#125;`))).tag('users');users.subscribe(); è¯¥ç¤ºä¾‹ä½¿ç”¨ forkJoin ç»„åˆäº†ä¸€ä¸ªç”¨æ¥å‘å°„å‡ºGitHubç”¨æˆ·æ•°ç»„çš„ Observableã€‚ rxjs-spy ä½¿ç”¨ tag æ“ä½œç¬¦æ¥æ ‡è®° Observableï¼Œå¹¶ä¸”ä»…ä»…é€šè¿‡å­—ç¬¦ä¸²æ¥ç»™ Observable æ³¨é‡Šã€‚è¿™ä¸ªç¤ºä¾‹åœ¨ç»„åˆ Observable ä¹‹å‰ï¼Œé¦–å…ˆå¯ç”¨ç›‘å¬åŠŸèƒ½ï¼Œå¹¶é…ç½®äº†å“ªäº› Observable è¦è¢«è®°å½•â€”â€”åŒ¹é… /user-.+/ çš„æ­£åˆ™è¡¨è¾¾å¼æˆ–è€…å¸¦æœ‰ users æ ‡ç­¾çš„é‚£äº› Observableã€‚ è¿™ä¸ªç¤ºä¾‹çš„æ§åˆ¶å°è¾“å‡ºå¦‚ä¸‹ï¼š Console_01 é™¤äº† Observable çš„ next å’Œ complete çš„é€šçŸ¥ä¹‹å¤–ï¼Œè®°å½•çš„è¾“å‡ºè¿˜åŒ…æ‹¬è®¢é˜…å’Œå–æ¶ˆè®¢é˜…çš„é€šçŸ¥ã€‚å®ƒæ˜¾ç¤ºäº†å‘ç”Ÿçš„ä¸€åˆ‡ï¼š å¯¹ç»„åˆçš„ Observable çš„è®¢é˜…å½±å“çš„æ¯ä¸€ä¸ªç”¨æˆ·APIè¯·æ±‚çš„ Observable çš„å¹¶è¡Œè®¢é˜…ï¼› è¯·æ±‚ä»¥ä»»æ„é¡ºåºå®Œæˆï¼› Observable å…¨éƒ¨å®Œæˆï¼› å¹¶ä¸”åœ¨å…¨éƒ¨å®Œæˆåå–æ¶ˆå¯¹ç»„åˆ Observable çš„è®¢é˜…ã€‚ æ¯ä¸ªè®°å½•çš„é€šçŸ¥è¿˜åŒ…æ‹¬æœ‰å…³æ¥å—é€šçŸ¥çš„è®¢é˜…è€…çš„ä¿¡æ¯â€”â€”åŒ…æ‹¬è®¢é˜…è€…å…·æœ‰çš„è®¢é˜…é‡ä»¥åŠ subscribe è°ƒç”¨çš„å †æ ˆç—•è¿¹ï¼š Console_02 å †æ ˆç—•è¿¹æŒ‡çš„æ˜¯ subscribe è°ƒç”¨çš„æ ¹â€”â€”å³å½±å“è®¢é˜…è€…å¯¹ Observable è®¢é˜…çš„æ˜¾å¼è°ƒç”¨ã€‚å› æ­¤ï¼Œç”¨æˆ·è¯·æ±‚çš„ Observable çš„å †æ ˆç—•è¿¹ä¹Ÿå‚è€ƒäº† medium.js ä¸­çš„ subscribe è°ƒç”¨ï¼š Console_03 å½“æˆ‘è°ƒè¯•æ—¶ï¼Œæˆ‘å‘ç°çŸ¥é“è°ƒç”¨ subscribe çš„å®é™…çš„æ ¹ä½ç½®æ¯”çŸ¥é“ç»„åˆ Observable ä¸­æŸä¸ª subscribe çš„ä½ç½®æ›´æœ‰ç”¨ã€‚ ç°åœ¨è®©æˆ‘ä»¬çœ‹ä¸€ä¸ªç°å®ä¸­å®é™…çš„é—®é¢˜ã€‚ åœ¨ç¼–å†™ redux-observable epics æˆ– ngrx effects æ—¶ï¼Œæˆ‘çœ‹åˆ°å‡ ä¸ªå¼€å‘äººå‘˜ç±»ä¼¼çš„ä»£ç ï¼š 12345678910import &#123; Observable &#125; from 'rxjs/Observable';import &#123; ajax &#125; from 'rxjs/observable/dom/ajax';const getRepos = action$ =&gt; action$.ofType('REPOS_REQUEST') .map(action =&gt; action.payload.user) .switchMap(user =&gt; ajax.getJSON(`https://api.notgithub.com/users/$&#123;user&#125;/repos`)) .map(repos =&gt; &#123; type: 'REPOS_RESPONSE', payload: &#123; repos &#125; &#125;) .catch(error =&gt; Observable.of(&#123; type: 'REPOS_ERROR' &#125;)) .tag('getRepos'); ä¹ä¸€çœ‹ï¼Œè¿™çœ‹ä¸Šå»è¿˜ä¸é”™ã€‚å¤§éƒ¨åˆ†æ—¶é—´å®ƒéƒ½å¯ä»¥æ­£å¸¸å·¥ä½œï¼Œå®ƒæ˜¯é‚£ç§å¯ä»¥å·å·æ··è¿‡å•å…ƒæµ‹è¯•çš„bugã€‚ é—®é¢˜æ˜¯ï¼Œå®ƒæœ‰æ—¶ä¼šåœæ­¢å·¥ä½œï¼Œç‰¹åˆ«æ˜¯åœ¨ä¸€ä¸ªé”™è¯¯çš„åŠ¨ä½œå‘ç”Ÿä¹‹åã€‚ è®°å½•æ˜¾ç¤ºæ­£åœ¨å‘ç”Ÿçš„äº‹ï¼š Console_04 åœ¨é”™è¯¯çš„åŠ¨ä½œè¢«å‘å°„å‡ºå»ä¹‹åï¼Œçœ‹åˆ° redux-observalbeåŸºç¡€ç»“æ„ä»epicä¸­è§£é™¤è®¢é˜…çš„ Observable å®Œæˆäº†ã€‚è¯¥æ–‡æ¡£çš„ catch è§£é‡Šäº†ä¸ºä»€ä¹ˆå‡ºç°è¿™ç§æƒ…å†µã€‚ æ— è®º selector è¿”å›äº†ä»€ä¹ˆæ ·çš„ Observableï¼Œéƒ½å°†è¿åœ¨ Observable é“¾åé¢ã€‚ åœ¨è¿™ä¸ªepicä¸­ï¼Œcatch å®Œæˆåè¿”å›çš„ Observable ä¹Ÿçœ‹åˆ°äº†epicçš„å®Œæˆã€‚ è§£å†³çš„æ–¹æ¡ˆæ˜¯å°† map å’Œ catch ç§»åˆ° switchMap ä¸­ï¼Œåƒä¸‹é¢è¿™æ ·ï¼š 123456789101112import &#123; Observable &#125; from 'rxjs/Observable';import &#123; ajax &#125; from 'rxjs/observable/dom/ajax';const getRepos = action$ =&gt; action$.ofType('REPOS_REQUEST') .map(action =&gt; action.payload.user) .switchMap(user =&gt; ajax .getJSON(`https://api.notgithub.com/users/$&#123;user&#125;/repos`) .map(repos =&gt; &#123; type: 'REPOS_RESPONSE', payload: &#123; repos &#125; &#125;) .catch(error =&gt; Observable.of(&#123; type: 'REPOS_ERROR' &#125;)) ) .tag('getRepos'); è¿™ä¸ªepicå°†ä¸å†å®Œæˆï¼Œå¹¶ç»§ç»­å‘é€é”™è¯¯åŠ¨ä½œï¼š Console_05 åœ¨è¿™ä¸¤ä¸ªç¤ºä¾‹ä¸­ï¼Œéœ€è¦å¯¹æ­£åœ¨è°ƒè¯•çš„ä»£ç è¿›è¡Œçš„å”¯ä¸€ä¿®æ”¹æ˜¯æ·»åŠ äº†ä¸€äº›æ ‡è®°æ³¨é‡Šã€‚ æ³¨é‡Šçš„å½±å“å¾ˆå°ï¼Œä¸€æ—¦æ·»åŠ ï¼Œæˆ‘å€¾å‘äºå°†å®ƒä»¬ç•™åœ¨ä»£ç ä¸­ã€‚æ ‡ç­¾è¿ç®—ç¬¦å¯ä»¥ç‹¬ç«‹äºè¯Šæ–­ rxjs-spy ä½¿ç”¨â€”â€”ä½¿ç”¨rxjs-spy/add/operator/tag æˆ–ç›´æ¥å¯¼å…¥ rxjs-spy/operator/tagï¼Œå› æ­¤ä¿ç•™æ ‡è®°çš„å¼€é”€å¾ˆå°ã€‚ å¯ä»¥ä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼é…ç½®è®°å½•å™¨ï¼Œè¿™å¯ä»¥äº§ç”Ÿè®¸å¤šå¯èƒ½çš„æ ‡è®°æ–¹æ³•ã€‚ä¾‹å¦‚ï¼Œä½¿ç”¨å¤åˆæ ‡è®°,ä¾‹å¦‚ github/users å’Œ github/repos å°†å…è®¸æ‚¨ä¸ºæ‰€æœ‰è¢«æ ‡è®°åå­˜å‚¨åœ¨å­˜å‚¨åº“é‡Œçš„ github Observable å¯ç”¨æ—¥å¿—è®°å½•ã€‚ è®°å½•å¹¶ä¸ä»¤äººå…´å¥‹ï¼Œä½†å¯ä»¥ä»è®°å½•çš„è¾“å‡ºä¸­æ”¶é›†çš„ä¿¡æ¯é€šå¸¸å¯ä»¥èŠ‚çœå¤§é‡æ—¶é—´ã€‚é‡‡ç”¨çµæ´»çš„æ ‡è®°æ–¹æ³•å¯ä»¥è¿›ä¸€æ­¥å‡å°‘å¤„ç†ä¸æ—¥å¿—è®°å½•ç›¸å…³çš„ä»£ç æ‰€èŠ±è´¹çš„æ—¶é—´ã€‚","tags":[{"name":"Rxjs","slug":"Rxjs","permalink":"http://tanyibing.com/tags/Rxjs/"}]},{"title":"ã€ç¿»è¯‘ã€‘è°ƒè¯•Rxjsï¼ˆä¸€ï¼‰ï¼šå·¥å…·","date":"2018-11-19T12:34:46.000Z","path":"2018/11/19/ã€ç¿»è¯‘ã€‘è°ƒè¯•Rxjsï¼ˆä¸€ï¼‰ï¼šå·¥å…·/","text":"[ç¿»è¯‘] è°ƒè¯•Rxjsï¼ˆä¸€ï¼‰ï¼šå·¥å…· åŸæ–‡ï¼šDebugging RxJS, Part 1: Tooling æˆ‘æ˜¯ä¸€ä¸ª Rxjs çš„ä¿¡ä»°è€…ï¼Œæˆ‘åœ¨æˆ‘æ‰€æœ‰çš„é¡¹ç›®ä¸­éƒ½ä½¿ç”¨ Rxjsã€‚æœ‰äº† Rxjsï¼Œæˆ‘å‘ç°å¾ˆå¤šæ›¾ç»è§‰å¾—ä¹å‘³çš„äº‹éƒ½å˜å¾—ç—›å¿«ã€‚ä½†æ˜¯æœ‰ä¸€ä»¶äº‹ä¸æ˜¯è¿™æ ·ï¼šè°ƒè¯•ã€‚ Rxjs ä¸­å¼‚æ­¥çš„æœ¬è´¨åœ¨ç»„åˆä¹‹åè®©è°ƒè¯•å˜å¾—æ›´å…·æŒ‘æˆ˜æ€§ï¼šæ²¡æœ‰å¤ªå¤šçš„çŠ¶æ€ï¼ˆstateï¼‰ä¾›ä½ æ£€æŸ¥ï¼Œå¹¶ä¸”è°ƒç”¨å †æ ˆï¼ˆcall stackï¼‰ä¹Ÿå¸®ä¸äº†å¤ªå¤§çš„å¿™ã€‚æˆ‘è¿‡å»ä½¿ç”¨çš„æ–¹æ³•æ˜¯åœ¨æ•´ä¸ªä»£ç å¤šå¤„æ·»åŠ  do æ“ä½œç¬¦å¹¶ä¸”è®°å½•ï¼Œä»¥æ­¤æ¥æ£€æŸ¥é‚£äº›ç»„åˆçš„ Observable äº§ç”Ÿçš„å€¼ã€‚è¿™å¹¶ä¸æ˜¯æˆ‘æƒ³è¦çš„æ–¹æ³•ï¼Œå› ä¸ºï¼š å½“æˆ‘åœ¨è°ƒè¯•æ—¶ä¿®æ”¹ä»£ç ï¼Œæˆ‘ä¸å¾—ä¸è¿›è¡Œæ›´å¤šçš„æ—¥å¿—è®°å½•å·¥ä½œï¼› å½“è°ƒè¯•ç»“æŸä¹‹åï¼Œæˆ‘å¿…é¡»åˆ é™¤æ—¥å¿—è®°å½•æˆ–è€…æ³¨é‡Šæ‰å®ƒï¼› å½“åœ¨ä¸€ä¸ªæ­£å¸¸çš„ç»„åˆObservableä¸­å­˜åœ¨â€˜æ‹æ‰â€™çš„æ“ä½œæ—¶ï¼Œå¦‚ä½•è¿›è¡Œæ—¥å¿—è®°å½•éœ€è¦æ ¼å¤–çš„å°å¿ƒã€‚ å°±ç®—æ˜¯ä¸“é—¨æœ‰çš„ log æ“ä½œç¬¦ï¼Œç»“æœä¹Ÿä¸ä¼šå¾ˆç†æƒ³ã€‚ æœ€è¿‘ï¼Œæˆ‘ç•™äº†ä¸€äº›æ—¶é—´æ¥ä¸º Rxjs æ„å»ºä¸€ä¸ªè°ƒè¯•å·¥å…·ï¼Œæˆ‘è§‰å¾—è¿™ä¸ªå·¥å…·å¿…é¡»å…·å¤‡ä»¥ä¸‹çš„åŠŸèƒ½ï¼š åº”è¯¥å°½å¯èƒ½çš„ä¸æ˜¾çœ¼ï¼› ä¸éœ€è¦é€šè¿‡ä¿®æ”¹ä»£ç æ¥è¿›è¡Œè°ƒè¯•ï¼› åœ¨è°ƒè¯•ç»“æŸåï¼Œä¸éœ€è¦åˆ é™¤æˆ–æ³¨é‡Šæ‰è°ƒè¯•çš„ä»£ç ï¼› åº”è¯¥å¯ä»¥è½»æ¾çš„å¯ç”¨å’Œç¦ç”¨æ—¥å¿—è®°å½•ï¼› å®ƒåº”è¯¥æä¾›ä¸æµè§ˆå™¨æ§åˆ¶å°çš„ä¸€äº›é›†æˆâ€”â€”â€”â€”ç”¨äºæ‰“å¼€/å…³é—­è°ƒè¯•ç”¨èƒ½å’Œæ£€æŸ¥çŠ¶æ€ç­‰ã€‚ å¦‚æœæƒ³è¦æ›´å®Œç¾ï¼Œè¿˜è¦ä¸€äº›ä¸œè¥¿ï¼š å®ƒåº”è¯¥æ”¯æŒæš‚åœ Observableï¼› å®ƒåº”è¯¥æ”¯æŒä¿®æ”¹ Observable æˆ–è€…å®ƒä»¬å‘å‡ºçš„å€¼ï¼› å®ƒåº”è¯¥æ”¯æŒæ§åˆ¶å°æ„å¤–çš„æ—¥å¿—è®°å½•æœºåˆ¶ï¼› å®ƒåº”è¯¥æ˜¯å¯æ‰©å±•çš„; å®ƒåº”è¯¥åœ¨æŸç§ç¨‹åº¦ä¸Šå¯ä»¥æ•è·å¯è§†åŒ–è®¢é˜…ä¾èµ–å…³ç³»æ‰€éœ€çš„æ•°æ®ã€‚ è€ƒè™‘åˆ°è¿™äº›åŠŸèƒ½ï¼Œæˆ‘å»ºç«‹äº† rxjs-spyã€‚ æ ¸å¿ƒæ¦‚å¿µrxjs-spy å¼•å…¥äº† tag æ“ä½œç¬¦ï¼Œå°†å­—ç¬¦ä¸²æ ‡è®°ä¸ Observable ç›¸å…³è”ã€‚è¿™ä¸ªæ“ä½œç¬¦ä¸ä¼šä»¥ä»»ä½•æ–¹å¼æ›´æ”¹ Observable çš„è¡Œä¸ºæˆ–å€¼ã€‚ tag æ“ä½œç¬¦å¯ä»¥è¢«å•ç‹¬å¯¼å…¥ï¼š import &quot;rxjs-spy/add/operator/tag&quot;ã€‚å¹¶ä¸”å…¶ä»–çš„ rxjs-spy æ–¹æ³•å¯ä»¥åœ¨ç”Ÿäº§ç¯å¢ƒä¸‹çœç•¥ï¼Œæ‰€ä»¥å”¯ä¸€çš„å¼€é”€å°±æ˜¯å­—ç¬¦ä¸²æ³¨é‡Šã€‚ å¤§å¤šæ•°å·¥å…·çš„æ–¹æ³•æ¥å—åŒ¹é…å™¨ï¼Œä»¥ç¡®å®šå®ƒä»¬å°†åº”ç”¨äºå“ªäº›æ ‡è®°çš„ Observable ã€‚åŒ¹é…å™¨å¯ä»¥æ˜¯ä¼ é€’æ ‡ç­¾æœ¬èº«çš„ç®€å•å­—ç¬¦ä¸²ï¼Œæ­£åˆ™è¡¨è¾¾å¼æˆ–è°“è¯ã€‚ é€šè¿‡è°ƒç”¨ spy æ¥é…ç½®å·¥å…·æ—¶ï¼Œå®ƒä¼šä¿®æ”¹ Observable.prototype.subscribe æ¥ç›‘å¬æ‰€æœ‰çš„ subscriptions, notifications å’Œ unsubscriptionsã€‚è¿™ä¹Ÿå°±æ˜¯æ„å‘³ç€ï¼Œåªæœ‰å·²ç»è¢«è®¢é˜…çš„ Observable æ‰ä¼šè¢«ç›‘å¬ã€‚ rxjs-spy å…¬å¼€äº†ä¸€ä¸ªæ—¨åœ¨ä»ä»£ç ä¸­è°ƒç”¨çš„æ¨¡å—APIå’Œä¸€ä¸ªç”¨äºåœ¨æµè§ˆå™¨æ§åˆ¶å°ä¸­äº¤äº’ä½¿ç”¨çš„æ§åˆ¶å°APIã€‚å¤§å¤šæ•°æ—¶å€™ï¼Œæˆ‘æ—©æ—©åœ°åœ¨åº”ç”¨ç¨‹åºå¯åŠ¨ä»£ç é‡Œæ¡ç”¨æ¨¡å—APIçš„æ–¹æ³•ï¼Œå¹¶ä½¿ç”¨æ§åˆ¶å°APIè¿›è¡Œå‰©ä½™çš„è°ƒè¯•ã€‚ æ§åˆ¶å°APIåŠŸèƒ½åœ¨è°ƒè¯•æ—¶ï¼Œæˆ‘é€šå¸¸ä½¿ç”¨æµè§ˆå™¨çš„æ§åˆ¶å°æ¥æ£€æŸ¥å’Œæ“ä½œæ ‡è®°çš„ Observablesã€‚æ§åˆ¶å°APIåŠŸèƒ½æœ€å®¹æ˜“é€šè¿‡ç¤ºä¾‹è§£é‡Šï¼š 123456789101112131415161718192021import &#123; Observable &#125; from \"rxjs/Observable\";import &#123; spy &#125; from \"rxjs-spy\";import \"rxjs/add/observable/interval\";import \"rxjs/add/operator/map\";import \"rxjs/add/operator/mapTo\";import \"rxjs-spy/add/operator/tag\";spy();const interval = new Observable .interval(2000) .tag(\"interval\");const people = interval .map((value) =&gt; &#123; const names = [\"alice\", \"bob\"]; return names[value % names.length]; &#125;) .tag(\"people\") .subscribe(); rxjs-spy ä¸­çš„æ§åˆ¶å°APIé€šè¿‡ rxSpy åœ¨å…¨å±€æš´éœ²ã€‚ è°ƒç”¨ rxSpy.show() å°†æ˜¾ç¤ºæ‰€æœ‰å·²ç»è¢«æ ‡è®°çš„ Observable çš„åˆ—è¡¨ï¼ŒæŒ‡ç¤ºå…¶çŠ¶æ€ï¼ˆincompleteï¼Œcomplete æˆ–è€… erroredï¼‰ï¼Œè®¢é˜…è€…ï¼ˆsubscribersï¼‰çš„æ•°é‡å’Œæœ€è¿‘å‘å‡ºçš„å€¼ï¼ˆå¦‚æœå·²ç»å‘å‡ºä¸€ä¸ªå€¼ï¼‰ã€‚æ§åˆ¶å°è¾“å‡ºå°†å¦‚ä¸‹æ‰€ç¤ºï¼š Console_1 è¦æ˜¾ç¤ºç‰¹å®šæ ‡è®°çš„ Observable çš„ä¿¡æ¯ï¼Œå¯ä»¥å°†æ ‡è®°åç§°æˆ–è€…æ­£åˆ™è¡¨è¾¾å¼ä¼ é€’ç»™ showï¼š Console_2 å¯ä»¥é€šè¿‡è°ƒç”¨ rxSpy.log æ¥æ˜¾ç¤ºè¢«æ ‡è®°çš„ Observable çš„æ—¥å¿—ä¿¡æ¯ï¼š Console_3 log ä¸å¸¦å‚æ•°è°ƒç”¨å°†ä¼šæ˜¾ç¤ºæ‰€æœ‰æ ‡è®°çš„ Observable çš„æ—¥å¿—è®°å½•ã€‚ æ¨¡å—APIä¸­çš„å¤§å¤šæ•°æ–¹æ³•éƒ½è¿”å›ä¸€ä¸ªæ’¤é”€åŠŸèƒ½ï¼Œå¯ä»¥è°ƒç”¨è¯¥åŠŸèƒ½æ¥æ’¤é”€æ–¹æ³•è°ƒç”¨ã€‚åœ¨æ§åˆ¶å°ä¸­ï¼Œç®¡ç†èµ·æ¥å¾ˆç¹çï¼Œæ‰€ä»¥è¿˜æœ‰å¦ä¸€ç§é€‰æ‹©ã€‚ è°ƒç”¨ rxSpy.undo() å°†æ˜¾ç¤ºå·²ç»è°ƒç”¨çš„æ–¹æ³•çš„åˆ—è¡¨ï¼š Console_4 è°ƒç”¨ rxSpy.undo å¹¶ä¼ é€’ä¸æ–¹æ³•è°ƒç”¨å…³è”çš„æ•°å­—å°†çœ‹åˆ°è¯¥è°ƒç”¨çš„æ’¤é”€å‡½æ•°è¢«æ‰§è¡Œã€‚ä¾‹å¦‚ï¼Œè°ƒç”¨ rxSpy.undo(3) å°†çœ‹åˆ°è¢«æ ‡è®°ä¸º interval çš„ Observable çš„è®°å½•è¢«æ’¤é”€ä¹‹åçš„ç»“æœï¼š Console_5 æœ‰æ—¶ï¼Œåœ¨è°ƒè¯•æ—¶ä¿®æ”¹ Observable æˆ–å…¶å€¼æ—¶ï¼Œè¿™ä¸ªæ–¹æ³•å°±å¾ˆæœ‰ç”¨ã€‚æ§åˆ¶å°APIåŒ…å«ä¸€ç§ let æ–¹æ³•ï¼Œå…¶åŠŸèƒ½ä¸ RxJS ä¸­çš„ let æ“ä½œç¬¦å¤§è‡´ç›¸åŒã€‚å®ƒçš„å®ç°æ–¹å¼æ˜¯é€šè¿‡è°ƒç”¨ let æ–¹æ³•å¯¹æ ‡è®°çš„ Observable çš„å½“å‰å’Œæœªæ¥çš„è®¢é˜…è€…äº§ç”Ÿå½±å“ã€‚ä¾‹å¦‚ã€‚ä»¥ä¸‹è°ƒç”¨å°†çœ‹åˆ° people Observable å‘å°„ mallory è€Œä¸æ˜¯ alice æˆ– bob: Console_6 ä¸ log æ–¹æ³•ä¸€æ ·ï¼Œlet å¯ä»¥æ’¤æ¶ˆå¯¹è¯¥æ–¹æ³•çš„è°ƒç”¨ï¼š Console_7 èƒ½å¤Ÿåœ¨è°ƒè¯•æ—¶æš‚åœä¸€ä¸ª Observable å¯¹æˆ‘æ¥è¯´å‡ ä¹æ˜¯ä¸å¯æˆ–ç¼ºçš„ã€‚è°ƒç”¨ rxSpy.pause å°†æš‚åœä¸€ä¸ªæ ‡è®°çš„ Observableï¼Œå¹¶è¿”å›ä¸€ä¸ªå¯ç”¨äºæ§åˆ¶å’Œæ£€æŸ¥ Observable çš„é€šçŸ¥ï¼ˆnotificationsï¼‰çš„ deckï¼š Console_8 åœ¨è¯¥ deck ä¸Šè°ƒç”¨ log å°†æ˜¾ç¤º Observable æ˜¯å¦æš‚åœï¼Œå¹¶æ˜¾ç¤ºè¢«æš‚åœçš„é€šçŸ¥ï¼ˆnotificationsï¼‰ã€‚ï¼ˆé€šçŸ¥æ˜¯ Notification ä½¿ç”¨ materialize æ“ä½œç¬¦è·å¾—çš„rxjså®ä¾‹ï¼‰ Console_9 åœ¨ deck ä¸Šè°ƒç”¨ step å°†å‘å‡ºä¸€ä¸ªè¢«æš‚åœä½çš„é€šçŸ¥ï¼ˆnotificationsï¼‰ï¼š Console_10 è°ƒç”¨ resume å°†å‘å‡ºæ‰€æœ‰è¢«æš‚åœçš„é€šçŸ¥ï¼ˆnotificationsï¼‰ï¼Œå¹¶å°†æ¢å¤ Observableï¼š Console_11 è°ƒç”¨ pause å°†çœ‹åˆ° Observable é‡æ–°è¿›å…¥æš‚åœçŠ¶æ€ï¼š Console_12 å¾ˆå®¹æ˜“å¿˜è®°å°†è¿”å›çš„ deck åˆ†é…ç»™å˜é‡ï¼Œå› æ­¤æ§åˆ¶å°APIåŒ…å«ä¸€ä¸ª deck æ–¹æ³•ï¼Œå’Œ undo æ–¹æ³•è¡Œä¸ºç›¸ä¼¼ã€‚è°ƒç”¨å®ƒå°†æ˜¾ç¤º pause è°ƒç”¨çš„åˆ—è¡¨ï¼š Console_13 è°ƒç”¨å®ƒå¹¶ä¼ é€’ä¸è°ƒç”¨ç›¸å…³è”çš„æ•°å­—å°†è¿”å›ç›¸å¯¹åº”çš„ deck ï¼š Console_14 åƒ log å’Œ let çš„è°ƒç”¨ä¸€æ ·ï¼Œpause çš„è°ƒç”¨ä¹Ÿå¯ä»¥æ’¤é”€ã€‚æ’¤é”€ pause çš„è°ƒç”¨å°†çœ‹åˆ°æ ‡è®°çš„ Observable æ¢å¤æ­£å¸¸ï¼š Console_15 å¸Œæœ›ä»¥ä¸Šçš„ä¾‹å­å¯ä»¥å¯¹ rxjs-spy çš„æ§åˆ¶å°APIè¿›è¡Œä¸€ä¸ªæ¦‚è¿°ã€‚Debugging RxJS çš„åç»­éƒ¨åˆ†å°†é‡ç‚¹ä»‹ç» rxjs-spy çš„å…·ä½“åŠŸèƒ½ä»¥åŠå¦‚ä½•ä½¿ç”¨å®ƒä»¬æ¥è§£å†³å®é™…çš„è°ƒè¯•é—®é¢˜ã€‚ å¯¹æˆ‘æ¥è¯´ï¼Œrxjs-spy è‚¯å®šè®©è°ƒè¯•Rxjsä¸å†é‚£ä¹ˆç¹çã€‚ æ›´å¤šä¿¡æ¯rxjs-spy çš„ä»£ç å¯ä»¥åœ¨ GitHubä¸Šæ‰¾åˆ°ï¼Œå¹¶ä¸”æœ‰ä¸€ä¸ªåœ¨çº¿çš„æ§åˆ¶å°APIç¤ºä¾‹ã€‚ è¯¥åŒ…å¯ä»¥é€šè¿‡NPMè¿›è¡Œå®‰è£…ã€‚ æœ‰å…³æœ¬ç³»åˆ—çš„ä¸€ä¸‹ç¯‡æ–‡ç« ï¼Œæ­£åœ¨ç¿»è¯‘ä¸­ï¼Œæ•¬è¯·æœŸå¾…ã€‚ã€‚ã€‚","tags":[{"name":"Rxjs","slug":"Rxjs","permalink":"http://tanyibing.com/tags/Rxjs/"}]},{"title":"apiæ¥å£è·¨åŸŸé—®é¢˜","date":"2018-11-08T06:55:20.000Z","path":"2018/11/08/apiæ¥å£è·¨åŸŸé—®é¢˜/","text":"ä»Šå¤©åœ¨è‡ªå·±çš„é¡¹ç›®ä¸­æƒ³è¦æä¾›ä¸€äº›apiï¼Œæš´éœ²å‡ºæ¥æƒ³è¦æä¾›æ•°æ®ï¼Œä¸‹é¢æ˜¯æˆ‘çš„apiæ¥å£ï¼Œå¾ˆç®€å•ï¼š const router = require(&apos;koa-router&apos;)(); router.get(&apos;/&apos;, async (ctx) =&gt; { ctx.body = &apos;api&apos;; }); router.get(&apos;/catelist&apos;, async (ctx) =&gt; { let catelist = await DB.find(&apos;articlecate&apos;, {}); ctx.body = { result: catelist } }); module.exports = router.routes(); æˆ‘ä»¬ä¸€èˆ¬è°ƒç”¨ä¼šæ€ä¹ˆå†™å‘¢ï¼Ÿå¦‚ä¸‹ï¼š $(function(){ $(&apos;#button&apos;).click(function(){ $.getJSON(&apos;http://localhost:8000/api/catelist&apos;, function(data){ onsole.log(data); }) }) }) æˆ‘ä»¬é€šè¿‡ç‚¹å‡»ä¸€ä¸ªæŒ‰é’®æ¥æ¥æ”¶æ•°æ®ã€‚ä½†æ˜¯ä¸€æ—¦æˆ‘ä»¬è·¨åŸŸä¹‹åè¿™æ ·å­å°±æ²¡åŠæ³•äº†ã€‚å•¥å«è·¨åŸŸå‘¢ï¼Œå°±æ˜¯å½“æˆ‘ä»¬çš„åŸŸåã€ç«¯å£ã€åè®®ä¸­åªè¦æœ‰ä¸€ä¸ªä¸ä¸€è‡´ï¼Œå°±è¯·æ±‚ä¸åˆ°æ•°æ®å•¦ï¼Œé‚£ä¸€èˆ¬çš„è§£å†³æ–¹æ³•æ€ä¹ˆæ•´å‘¢ï¼Ÿæˆ‘ä»¬å¯ä»¥ç”¨jsonpã€‚ jsonpæ˜¯ä¸ªä»€ä¹ˆåŸç†å‘¢ï¼Ÿå°±æ˜¯åˆ©ç”¨script srcå¯ä»¥è·¨åŸŸçš„ç‰¹æ€§æ¥å®ç°ã€‚æ‹¢å…±åˆ†ä¸¤æ­¥ï¼š æœ¬åœ°å†™ä¸€ä¸ªå›è°ƒå‡½æ•° åœ¨è¿œç¨‹æ‰§è¡Œè¿™ä¸ªå›è°ƒå‡½æ•°ï¼ŒæŠŠè¿œç¨‹çš„æ•°æ®ä¼ åˆ°æœ¬åœ° ä¸‹é¢ç»™ä¸ªä¾‹å­ï¼š function xxxx(data){ console.log(data); } å’‹ä»¬å…ˆå†™ä¸ªå‡½æ•°ï¼Œç„¶åç”¨ä¸ªscriptæ¥è¿œç¨‹è°ƒç”¨ä¸‹ï¼š &lt;script src=&quot;http://localhost:8000/api/catelist?callback=xxxx&quot;&gt;&lt;/script&gt; æ²¡é”™ï¼Œå’‹ä»¬åœ¨åé¢åŠ ä¸Šcallbackå°±è¡Œå•¦ã€‚å†çœ‹ä¸€ä¸ªjqueryç‰ˆæœ¬çš„ï¼š $(function(){ var url=&apos;http://localhost:8000/api/catelist&apos;; $.ajax({ url:url, dataType:&apos;jsonp&apos;, /*å®šä¹‰jsonpè¯·æ±‚*/ data:&apos;&apos;, /*getä¼ å€¼*/ jsonp:&apos;callback&apos;, /*å›è°ƒå‡½æ•°çš„å‚æ•°*/ success:function(data) { console.log(data); }, timeout:3000 /*è¶…æ—¶æ—¶é—´*/ }); }) ä½†æ˜¯è¿™æ ·åšæœ‰ä¸€ä¸ªå‰æï¼Œé‚£å°±æ˜¯åå°è¦å…è®¸jsonpï¼Œä½†è¿™æ ·çš„è¯ä¼šæåº¦ä¸å®‰å…¨ï¼Œæ€ä¹ˆè§£å†³å‘¢ï¼Œæˆ‘ä»¬ä¸€èˆ¬æ˜¯åŠ ä¸Šæ•°å­—ç­¾åæ¥ä¿è¯å®‰å…¨ã€‚","tags":[{"name":"Node","slug":"Node","permalink":"http://tanyibing.com/tags/Node/"},{"name":"Ajax","slug":"Ajax","permalink":"http://tanyibing.com/tags/Ajax/"}]},{"title":"å¸å›½CMSä½¿ç”¨æ€»ç»“","date":"2018-11-07T08:53:15.000Z","path":"2018/11/07/å¸å›½CMSä½¿ç”¨æ€»ç»“/","text":"å…¬å¸çš„åå°æ˜¯ä½¿ç”¨çš„å¸å›½CMSï¼Œæƒ³è¦å¹²å¥½æ´»ï¼Œæ€»å¾—ä¼šç”¨å•Šã€‚å¥½å§ï¼Œæ‘¸æ‘¸ç´¢ç´¢çš„ç”¨äº†ä¸€æ®µæ—¶é—´ï¼Œä¹Ÿè‰è‰çš„æ€»ç»“ä¸€ä¸‹å§ã€‚ é¦–å…ˆåå°å•¥æœ€é‡è¦ï¼Œè‚¯å®šæ˜¯æ•°æ®ï¼Œæ‰€ä»¥ç³»ç»Ÿæ¨¡å‹ä¹Ÿå¯ä»¥å«æ•°æ®æ¨¡å‹ä¹Ÿå°±æ˜¾å¾—å¾ˆé‡è¦ï¼Œé‡Œé¢çš„å­—æ®µè¦è€ƒè™‘çš„å‘¨åˆ°ä¸€äº›ï¼Œä»¥ä¾¿å¤ç”¨ï¼Œå¦åˆ™æ”¹èµ·æ¥å°±å¾ˆè›‹ç–¼äº†ã€‚ å¸å›½CMSä¸­è¿˜æœ‰ä¸¤ä¸ªçµé­‚èˆ¬çš„ä¸œè¥¿ï¼šâ€œä¸‡èƒ½æ ‡ç­¾ï¼ˆecmsinfoï¼‰â€ã€â€œçµåŠ¨æ ‡ç­¾ï¼ˆe:loopï¼‰â€ï¼Œè¿™ä¸¤ç©æ„å„¿å…¶ä¸­ä¹‹ä¸€åªè¦ä¼šäº†ï¼Œæ¨¡ç‰ˆéƒ½æ˜¯ä¸€æŠŠå”†ã€‚æ˜å¤©æˆ‘å¾—æ‰¾ä¸ªæ—¶é—´å¥½å¥½çœ‹ä¸€ä¸‹è¿™ä¸ªæ­¦åŠŸç§˜ç±ã€‚ ä»¥ä¸Šä¸¤ä¸ªåŸºæœ¬æ˜¯æœ€é‡è¦çš„ä¸œä¸œäº†ï¼Œæ•°æ®åŠ æ¨¡ç‰ˆï¼Œç«™å°±èµ·æ¥äº†ã€‚ä½†å› ä¸ºä¸æ˜¯è‡ªå·±å†™çš„åå°ç³»ç»Ÿï¼Œæ‰€ä»¥æœ‰äº›ä¸œè¥¿è¿˜æ˜¯è¦å»æ”¹ä»£ç çš„ï¼Œæ¯”å¦‚åˆ†é¡µè¿™ä¸ªç©æ„ï¼Œä½ è¯´è¯´ä½ è¦åœ¨å‰ç«¯å®ç°åˆ†é¡µä½ è¯¥å’‹æ•´ï¼Œåˆä¸èƒ½å»æŸ¥æ•°æ®åº“ï¼Œæ‰€ä»¥å°±è¿˜æ˜¯è¦æ‰¾åˆ°ç›¸åº”çš„ä»£ç ï¼Œæ”¹ä¸€æ”¹æ ·å¼å•¥çš„ï¼Œå»ºç«™çš„è¯åŸºæœ¬å°±åªéœ€è¦è¿™äº›çŸ¥è¯†å§ï¼Œåƒç±»ä¼¼é‡‡é›†å•¥ç©æ„å„¿çš„ç›®å‰ä¸ºæ­¢è¿˜æ²¡æœ‰é‡åˆ°è¿‡ï¼Œæ‰€ä»¥ä¸ç®¡äº†ã€‚","tags":[{"name":"CMS","slug":"CMS","permalink":"http://tanyibing.com/tags/CMS/"}]},{"title":"bootstrapä½¿ç”¨æ€»ç»“","date":"2018-11-06T13:05:57.000Z","path":"2018/11/06/bootstrapä½¿ç”¨æ€»ç»“/","text":"å¥½ä¹…å’©æœ‰å†™åšå®¢äº†ï¼Œå› ä¸ºæœ€è¿‘åœ¨æ’¸å¾ˆå¤šé¡µé¢ï¼Œä½¿ç”¨çš„æ˜¯Bootstrapï¼Œå› ä¸ºè®¾è®¡æ²¡æœ‰ç»™æˆ‘ä¸¤å¥—è®¾è®¡å›¾ï¼Œæ‰€ä»¥åªèƒ½ä½¿ç”¨è¿™ä¸ªæ¡†æ¶æ¥å…¼å®¹ç§»åŠ¨ç«¯ã€‚ç°åœ¨ä¹Ÿå¯ä»¥æ€»ç»“ä¸‹æˆ‘ä½¿ç”¨è¿‡ç¨‹ä¸­æŒæ¡äº†å•¥æ–°çŸ¥è¯†ï¼š å› ä¸ºæˆ‘ç”¨çš„æ˜¯3è¿™ä¸ªå¤§ç‰ˆæœ¬ï¼Œæ‰€ä»¥è®¾å¤‡è¿˜æ˜¯åˆ†ä¸ºå››ç§ï¼šxsï¼ˆ768ï¼‰ã€smï¼ˆ768-992ï¼‰ã€mdï¼ˆ992-1200ï¼‰ã€lgï¼ˆ1200ï¼‰ã€‚ä¸ç”¨è¯´äº†ï¼Œè¿™æ˜¯æ …æ ¼ç³»ç»Ÿçš„æ ¸å¿ƒï¼Œé€šè¿‡åª’ä½“æŸ¥è¯¢æ¥å°†ä¸€è¡Œåˆ†ä¸º12åˆ—çš„ã€‚æ¯ä¸ªcoléƒ½ä¼šå¸¦æœ‰å·¦å³ä¸¤è¾¹15pxçš„paddingã€‚ containerå’Œcontainer-fluidçš„åŒºåˆ«æ˜¯container-fluidæ˜¯æ’‘æ»¡æ•´ä¸ªå±å¹•çš„å®½åº¦ï¼Œä½†æ˜¯ä»–ä¸¤éƒ½æœ‰å·¦å³ä¸¤è¾¹å„15pxçš„paddingï¼Œä¸ºçš„æ˜¯é˜²æ­¢æ–‡å­—æ˜¾ç¤ºè§¦æ‘¸åˆ°å±å¹•è¾¹ç•Œï¼Œå¦‚æœä¸æƒ³è¦è¿™ä¸ªpaddingï¼Œå¯ä»¥åœ¨containerå’Œcontainer-fluidä¸­åŠ ä¸Šrowï¼Œå› ä¸ºrowçš„å·¦å³marginéƒ½æ˜¯-15pxï¼Œæ­£å¥½æŠµæ¶ˆpaddingã€‚å…³äºè¿™ä¸ªpaddingå’Œmarginå…¶å®å¯ä»¥å¾ˆå·§å¦™çš„ä½¿ç”¨ï¼Œå¦‚æœæˆ‘ä»¬æƒ³åœ¨columnä¸­åµŒå¥—columnï¼Œå…ˆæŠŠè¦è¢«åµŒå¥—çš„columnæ”¾åˆ°rowä¸­ï¼Œå†æŠŠrowæ”¾åˆ°ä½œä¸ºå®¹å™¨çš„columnä¸­ï¼Œè€Œä¸éœ€è¦åœ¨æ”¾ç½®ä¸€ä¸ªcontainerã€‚è¿™ä¹Ÿæ˜¯å› ä¸ºBootstrapåœ¨ä¸€å¼€å§‹ä¾¿è¯´äº†: ä½ çš„å†…å®¹åº”å½“æ”¾ç½®äºâ€œåˆ—ï¼ˆcolumnï¼‰â€å†…ï¼Œå¹¶ä¸”ï¼Œåªæœ‰â€œåˆ—ï¼ˆcolumnï¼‰â€å¯ä»¥ä½œä¸ºè¡Œï¼ˆrowï¼‰â€çš„ç›´æ¥å­å…ƒç´ ã€‚ â€œè¡Œï¼ˆrowï¼‰â€å¿…é¡»åŒ…å«åœ¨ .container ï¼ˆå›ºå®šå®½åº¦ï¼‰æˆ– .container-fluid ï¼ˆ100% å®½åº¦ï¼‰ä¸­ï¼Œä»¥ä¾¿ä¸ºå…¶èµ‹äºˆåˆé€‚çš„æ’åˆ—ï¼ˆaligmentï¼‰å’Œå†…è¡¥ï¼ˆpaddingï¼‰ã€‚ è¿˜æœ‰ä¸€ç‚¹æ˜¯containerå’Œcontainer-fluidæ˜¯ä¸èƒ½åµŒå¥—çš„ï¼Œè¿™ä¸€ç‚¹æˆ‘å‘ç°å…¬å¸ä¹‹å‰çš„é¡¹ç›®ä¸­å¾ˆå¤šåœ°æ–¹éƒ½æ²¡æœ‰æ³¨æ„ã€‚ æˆ‘ä»¬è¿˜å¯ä»¥é€šè¿‡col-xxx-offset-xxã€col-xxx-pull-xxã€col-xxx-pull-xxæ¥å®ç°è·³è¿‡xxåˆ—ã€å‘å³æ¨xxåˆ—ã€å‘å·¦æ¨xxåˆ—çš„æ•ˆæœã€‚ å½“æˆ‘çš„æœ‰å…ˆæ ·å¼åœ¨ç§»åŠ¨ç«¯å®åœ¨æ˜¯ä¸å¥½å±•ç°çš„æ—¶å€™ï¼Œè¿™æ—¶æˆ‘ä»¬å°±éœ€è¦ä¸¤ä¸ªä¸ä¸€æ ·çš„ç»“æ„ï¼Œä¸€ä¸ªåœ¨å¤§å±ä¸Šå±•ç¤ºï¼Œä¸€ä¸ªåœ¨å°å±ä¸Šå±•ç¤ºã€‚è¿™å°±éœ€è¦ç”¨åˆ°visibile-xs-xxxã€hide-xs-xxxã€visibile-xs-block/inline/block-inlineè¿™äº›æ¥æ§åˆ¶å±•ç¤ºã€‚ è¿˜æœ‰ä¸€ç‚¹æ˜¯formè¡¨å•ä¸€å®šè¦æ·»åŠ labelç„¶åå¯ä»¥é€šè¿‡è®¾ç½®.sr-onlyæ¥éšè—ï¼Œè¿™æ˜¯ä¸ºäº†ç»™ç›²äººæ›´å¥½çš„ä½“éªŒï¼ŒåŒæ—¶ä¹Ÿæ˜¯seoçš„ä¸€ç§æŠ€å·§ã€‚ ä»¥ä¸Šæ˜¯ä¸€äº›é›¶é›¶æ•£æ•£çš„æ„Ÿæ‚Ÿã€‚æˆ‘åœ¨å·¥ä½œçš„æ—¶å€™å‘ç°ï¼Œæœ‰äº›äººä¸èƒ½æ‹æ¸…è‡ªé€‚åº”å’Œå“åº”å¼çš„åŒºåˆ«ï¼Œå˜´é‡Œè€è¯´ç€â€˜è‡ªé€‚åº”ã€è‡ªé€‚åº”â€™ï¼Œå´åªæ‹¿å‡ºä¸€å¥—è®¾è®¡å›¾ã€‚å…¶å®å“åº”å¼æ‰æ˜¯ä¸€å¥—è®¾è®¡é€‚åº”æ‰€æœ‰ç«¯ï¼Œè€Œè‡ªé€‚ç”¨æ˜¯éœ€è¦å¤šå¥—è®¾è®¡å›¾çš„ã€‚ åœ¨å¼€å‘è¿‡ç¨‹ä¸­å‘ç°æœ‰çš„åœ°æ–¹çš„ç»“æ„åœ¨ç§»åŠ¨ç«¯å°±æ˜¯ä¸å¥½çœ‹ï¼Œå°±éœ€è¦æ”¹å˜ç»“æ„ï¼Œä¸€æ—¦åœ°æ–¹å¤šäº†çš„è¯å…¶å®ä¸å¦‚è®¾è®¡ä¸¤å¥—ã€‚ è¿˜æœ‰ä¸€ç‚¹å°±æ˜¯bootstrapçš„å®šåˆ¶ï¼Œå®šåˆ¶æ¯”è¾ƒæ–¹ä¾¿ï¼Œå¯ä»¥èŠ‚çœå¾ˆå¤šä»£ç ï¼Œå…¶å®è¿˜æœ‰æ›´å¥½çš„æ–¹æ³•å°±æ˜¯ä¿®æ”¹æºç ï¼Œè¿™æ ·çš„è¯æˆ‘ä»¬çš„è‡ªç”±åº¦æ›´é«˜ï¼Œå¯ä»¥æ›´åŠ æ·±å…¥çš„å®šåˆ¶ã€‚","tags":[{"name":"Bootstrap","slug":"Bootstrap","permalink":"http://tanyibing.com/tags/Bootstrap/"}]},{"title":"angularå†™ä¸€ä¸ªè”åŠ¨è¡¨å•æ§ä»¶","date":"2018-10-18T11:48:48.000Z","path":"2018/10/18/angularå†™ä¸€ä¸ªè”åŠ¨è¡¨å•æ§ä»¶/","text":"é¦–å…ˆå±•ç¤ºä¸‹è¿™ä¸ªè¡¨å•çš„æ ·å¼ï¼š è¿™å°±æ˜¯æˆ‘ä»¬éœ€è¦è®¾è®¡æˆçš„è¡¨å•æ ·å¼ï¼Œä»å›¾ä¸­æˆ‘ä»¬å¯ä»¥çœ‹å‡ºè¿™ä¸ªè¡¨å•å¯ä»¥åˆ†æˆä¸‰ä¸ªéƒ¨åˆ†ï¼š è¯ä»¶è¾“å…¥éƒ¨åˆ† å‡ºç”Ÿæ—¥æœŸéƒ¨åˆ† åœ°å€éƒ¨åˆ† æˆ‘ä»¬ä¸åº”è¯¥å°†è¿™äº›éƒ¨åˆ†éƒ½å†™åœ¨ä¸€èµ·ï¼Œå› ä¸ºè¿™æ ·æˆ‘ä»¬çš„è¡¨å•å°†ä¼šç‰¹åˆ«å¤æ‚ï¼Œå› ä¸ºæˆ‘ä»¬å°†æ‰€æœ‰çš„é€»è¾‘éƒ½å†™åœ¨äº†ä¸€èµ·ï¼Œè€Œä¸”ä¹Ÿä¸é€‚åˆå¤ç”¨ã€‚æ‰€æœ‰æˆ‘ä»¬å°†è¿™ä¸‰ä¸ªéƒ¨åˆ†å†™æˆä¸‰ä¸ªæ§ä»¶ï¼Œä¸‹é¢å°±åˆ†åˆ«ç»™å‡ºæ¨¡ç‰ˆï¼š è¯ä»¶è¾“å…¥éƒ¨åˆ†æ¨¡ç‰ˆï¼š &lt;div&gt; &lt;mat-form-field&gt; &lt;mat-select placeholder=&quot;è¯ä»¶ç±»å‹&quot; (ngModelChange)=&quot;onIdTypeChange($event.value)&quot; [(ngModel)]=&quot;identity.identityType&quot;&gt; &lt;mat-option *ngFor=&quot;let type of identityTypes&quot; [value]=&quot;type.value&quot;&gt; {{type.label}} &lt;/mat-option&gt; &lt;/mat-select&gt; &lt;/mat-form-field&gt; &lt;/div&gt; &lt;div class=&quot;id-input&quot;&gt; &lt;mat-form-field&gt; &lt;input matInput type=&quot;text&quot; placeholder=&quot;è¯ä»¶å·ç &quot; (change)=&quot;onIdNoChange($event.target.value)&quot; [(ngModel)]=&quot;identity.identityNo&quot;&gt; &lt;mat-error&gt;è¯ä»¶å·ç è¾“å…¥æœ‰è¯¯&lt;/mat-error&gt; &lt;/mat-form-field&gt; &lt;/div&gt; å‡ºç”Ÿæ—¥æœŸéƒ¨åˆ†æ¨¡ç‰ˆ: &lt;div [formGroup]=&quot;form&quot;&gt; &lt;div&gt; &lt;mat-form-field&gt; &lt;input matInput [matDatepicker]=&quot;birthPicker&quot; type=&quot;text&quot; placeholder=&quot;å‡ºç”Ÿæ—¥æœŸ&quot; formControlName=&quot;birthday&quot;&gt; &lt;mat-datepicker-toggle matSuffix [for]=&quot;birthPicker&quot;&gt;&lt;/mat-datepicker-toggle&gt; &lt;mat-datepicker #dueDatePicker&gt;&lt;/mat-datepicker&gt; &lt;mat-error&gt;æ—¥æœŸä¸æ­£ç¡®&lt;/mat-error&gt; &lt;/mat-form-field&gt; &lt;mat-datepicker touchUi=&quot;true&quot; #birthPicker&gt;&lt;/mat-datepicker&gt; &lt;/div&gt; &lt;ng-container formGroupName=&quot;age&quot;&gt; &lt;div&gt; &lt;mat-form-field&gt; &lt;input matInput type=&quot;number&quot; placeholder=&quot;å¹´é¾„&quot; formControlName=&quot;ageNum&quot;&gt; &lt;/mat-form-field&gt; &lt;/div&gt; &lt;div&gt; &lt;mat-button-toggle-group formControlName=&quot;ageUnit&quot; [(ngModel)]=&quot;selectedUnit&quot;&gt; &lt;mat-button-toggle *ngFor=&quot;let unit of ageUnits&quot; [value]=&quot;unit.value&quot;&gt; {{ unit.label }} &lt;/mat-button-toggle&gt; &lt;/mat-button-toggle-group&gt; &lt;/div&gt; &lt;mat-error class=&quot;mat-body-2&quot; *ngIf=&quot;form.get(&apos;age&apos;).hasError(&apos;ageInvalid&apos;)&quot;&gt;å¹´é¾„æˆ–å•ä½ä¸æ­£ç¡®&lt;/mat-error&gt; &lt;/ng-container&gt; &lt;/div&gt; åœ°å€éƒ¨åˆ†æ¨¡ç‰ˆ: &lt;div class=&quot;address-group&quot;&gt; &lt;mat-form-field&gt; &lt;mat-select placeholder=&quot;è¯·é€‰æ‹©çœä»½&quot; [(ngModel)]=&quot;_address.province&quot; (ngModelChange)=&quot;onProvinceChange()&quot;&gt; &lt;mat-option *ngFor=&quot;let p of provinces$ | async&quot; [value]=&quot;p&quot;&gt; {{ p }} &lt;/mat-option&gt; &lt;/mat-select&gt; &lt;/mat-form-field&gt; &lt;mat-form-field&gt; &lt;mat-select placeholder=&quot;è¯·é€‰æ‹©åŸå¸‚&quot; [(ngModel)]=&quot;_address.city&quot; (ngModelChange)=&quot;onCityChange()&quot;&gt; &lt;mat-option *ngFor=&quot;let c of cities$ | async&quot; [value]=&quot;c&quot;&gt; {{ c }} &lt;/mat-option&gt; &lt;/mat-select&gt; &lt;/mat-form-field&gt; &lt;mat-form-field&gt; &lt;mat-select placeholder=&quot;è¯·é€‰æ‹©åŒºå¿&quot; [(ngModel)]=&quot;_address.district&quot; (ngModelChange)=&quot;onDistrictChange()&quot;&gt; &lt;mat-option *ngFor=&quot;let d of districts$ | async&quot; [value]=&quot;d&quot;&gt; {{ d }} &lt;/mat-option&gt; &lt;/mat-select&gt; &lt;/mat-form-field&gt; &lt;div class=&quot;street&quot;&gt; &lt;mat-form-field&gt; &lt;input matInput placeholder=&quot;è¡—é“åœ°å€&quot; [(ngModel)]=&quot;_address.street&quot; (ngModelChange)=&quot;onStreetChange()&quot;&gt; &lt;/mat-form-field&gt; &lt;/div&gt; &lt;/div&gt; æˆ‘ä½¿ç”¨çš„æ˜¯materialä¸»é¢˜ï¼Œæ¨¡ç‰ˆçœ‹èµ·æ¥å¯èƒ½æœ‰ç‚¹å¤æ‚ã€‚æ¥ä¸‹æ¥æˆ‘ä»¬åˆ†åˆ«çœ‹ä¸‹æ¯ä¸ªæ¨¡å—éœ€è¦å®ç°çš„æ•ˆæœï¼š è¯ä»¶éƒ¨åˆ†å°±æ˜¯æ­£å¸¸çš„è¾“å…¥ï¼Œä½†æ˜¯åé¢è¦å®ç°ä¸€ä¸ªè”åŠ¨çš„æ•ˆæœï¼Œå› ä¸ºçœä»½è¯åŒ…å«äº†å¾ˆå¤šä¿¡æ¯ã€‚ å¹´é¾„éƒ¨åˆ†æœ¬èº«å°±éœ€è¦ä¸€ä¸ªè”åŠ¨ï¼Œæ•ˆæœå¦‚ä¸‹ï¼š åœ°åŒºéƒ¨åˆ†éœ€è¦éœ€è¦æ ¹æ®å…¶ä»–é€‰æ‹©é¡¹è¿›è¡Œç­›é€‰ï¼š æœ€åæˆ‘ä»¬éœ€è¦æœ‰ä¸€ä¸ªæ ¹æ®èº«ä»½è¯ä¿¡æ¯ï¼Œå¾—åˆ°æˆ‘ä»¬åœ°å€å’Œç”Ÿæ—¥çš„è”åŠ¨ï¼Œæœ€ç»ˆçš„æ•ˆæœå¦‚ä¸‹ï¼š æ•ˆæœæˆ‘ä»¬æœ‰å·²ç»çœ‹åˆ°äº†ï¼Œæ¥ä¸‹æ¥å°±è¦å¯¹å„ä¸ªæ§ä»¶è¿›è¡Œç¼–å†™äº†ï¼š è¯ä»¶éƒ¨åˆ†: import { Component, OnInit, forwardRef, OnDestroy, ChangeDetectionStrategy } from &apos;@angular/core&apos;; import { NG_VALUE_ACCESSOR, NG_VALIDATORS, ControlValueAccessor, FormControl } from &apos;@angular/forms&apos;; import { Subscription, Subject, Observable, combineLatest } from &apos;rxjs&apos;; import { IdentityType, Identity } from &apos;../../domain&apos;; @Component({ selector: &apos;app-identity-input&apos;, templateUrl: &apos;./identity-input.component.html&apos;, styleUrls: [&apos;./identity-input.component.scss&apos;], providers: [ { provide: NG_VALUE_ACCESSOR, useExisting: forwardRef(() =&gt; IdentityInputComponent), multi: true, }, { provide: NG_VALIDATORS, useExisting: forwardRef(() =&gt; IdentityInputComponent), multi: true, } ], changeDetection: ChangeDetectionStrategy.OnPush, }) export class IdentityInputComponent implements ControlValueAccessor, OnInit, OnDestroy { identityTypes: { value: IdentityType, label: string }[] = [ { value: IdentityType.IdCard, label: &apos;èº«ä»½è¯&apos; }, { value: IdentityType.Insurance, label: &apos;åŒ»ä¿&apos; }, { value: IdentityType.Passport, label: &apos;æŠ¤ç…§&apos; }, { value: IdentityType.Military, label: &apos;å†›å®˜è¯&apos; }, { value: IdentityType.Other, label: &apos;å…¶å®ƒ&apos; } ]; identity: Identity = { identityType: null, identityNo: null }; private _idType = new Subject&lt;IdentityType&gt;(); private _idNo = new Subject&lt;string&gt;(); private _sub: Subscription; private propagateChange = (_: any) =&gt; { }; constructor() { } ngOnInit() { const val$ = combineLatest(this.idType, this.idNo, (_type, _no) =&gt; { return { identityType: _type, identityNo: _no }; }); this._sub = val$.subscribe(v =&gt; { this.identity = v; this.propagateChange(v); }); } ngOnDestroy(): void { if (this._sub) { this._sub.unsubscribe(); } } writeValue(obj: any): void { } registerOnChange(fn: any): void { this.propagateChange = fn; } registerOnTouched(fn: any): void { } setDisabledState?(isDisabled: boolean): void { } // éªŒè¯è¡¨å•ï¼ŒéªŒè¯ç»“æœæ­£ç¡®è¿”å› null å¦åˆ™è¿”å›ä¸€ä¸ªéªŒè¯ç»“æœå¯¹è±¡ validate(c: FormControl): { [key: string]: any } { if (!c.value) { return null; } switch (c.value.identityType) { case IdentityType.IdCard: { return this.validateIdCard(c); } case IdentityType.Passport: { return this.validatePassport(c); } case IdentityType.Military: { return this.validateMilitary(c); } case IdentityType.Insurance: default: { return null; } } } onIdTypeChange(idType) { this._idType.next(idType); } onIdNoChange(idNo) { this._idNo.next(idNo); } private get idType(): Observable&lt;IdentityType&gt; { return this._idType.asObservable(); } private get idNo(): Observable&lt;string&gt; { return this._idNo.asObservable(); } private validateIdCard(c: FormControl): { [key: string]: any } { const val = c.value.identityNo; if (val.length !== 18) { return { idNotValid: true }; } const pattern = /^[1-9]\\d{5}[1-9]\\d{3}((0\\d)|(1[0-2]))(([0|1|2]\\d)|3[0-1])\\d{3}[x0-9]$/; return pattern.test(val) ? null : { idNotValid: true }; } private validatePassport(c: FormControl): { [key: string]: any } { const value = c.value.identityNo; if (value.length !== 9) { return { idNotValid: true }; } const pattern = /^[GgEe]\\d{8}$/; return pattern.test(value) ? null : { idNotValid: true }; } private validateMilitary(c: FormControl): { [key: string]: any } { const value = c.value.identityNo; const pattern = /[\\u4e00-\\u9fa5](å­—ç¬¬)(\\d{4,8})(å·?)$/; return pattern.test(value) ? null : { idNotValid: true }; } } å¹´é¾„éƒ¨åˆ†: import { Component, forwardRef, OnInit, OnDestroy, Input } from &apos;@angular/core&apos;; import { FormGroup, NG_VALUE_ACCESSOR, NG_VALIDATORS, ControlValueAccessor, FormControl, FormBuilder } from &apos;@angular/forms&apos;; import { map, merge, filter, startWith, debounceTime, distinctUntilChanged } from &apos;rxjs/operators&apos;; import { Observable, Subscription, combineLatest } from &apos;rxjs&apos;; import { subDays, subMonths, subYears, differenceInDays, differenceInMonths, differenceInYears, isBefore, parse, format } from &apos;date-fns&apos;; import { isValidDate } from &apos;../../utils/date.util&apos;; export enum AgeUnit { Year = 0, Month, Day } export interface Age { age: number; unit: AgeUnit; } @Component({ selector: &apos;app-age-input&apos;, templateUrl: &apos;./age-input.component.html&apos;, styleUrls: [&apos;./age-input.component.scss&apos;], providers: [ { provide: NG_VALUE_ACCESSOR, useExisting: forwardRef(() =&gt; AgeInputComponent), multi: true // å…è®¸ä»¤ç‰Œå¤šå¯¹ä¸€ }, { provide: NG_VALIDATORS, useExisting: forwardRef(() =&gt; AgeInputComponent), multi: true } ] }) export class AgeInputComponent implements ControlValueAccessor, OnInit, OnDestroy { @Input() daysTop = 90; @Input() daysBottom = 0; @Input() monthsTop = 24; @Input() monthsBottom = 1; @Input() yearsTop = 150; @Input() yearsBottom = 1; @Input() format = &apos;YYYY-MM-DD&apos;; @Input() debounceTime = 300; selectedUnit = AgeUnit.Year; ageUnits = [ { value: AgeUnit.Year, label: &apos;å²&apos; }, { value: AgeUnit.Month, label: &apos;æœˆ&apos; }, { value: AgeUnit.Day, label: &apos;æ—¥&apos; } ]; form: FormGroup; sub: Subscription; private propagateChange = (_: any) =&gt; { }; constructor(private fb: FormBuilder) { } ngOnInit(): void { this.form = this.fb.group({ birthday: [&apos;&apos;, this.validateDate], age: this.fb.group({ ageNum: [&apos;&apos;], ageUnit: [AgeUnit.Year] }, { validator: this.validateAge(&apos;ageNum&apos;, &apos;ageUnit&apos;) }) }); const birthday = this.form.get(&apos;birthday&apos;); const ageNum = this.form.get(&apos;age&apos;).get(&apos;ageNum&apos;); const ageUnit = this.form.get(&apos;age&apos;).get(&apos;ageUnit&apos;); const birthday$ = birthday.valueChanges.pipe( map(d =&gt; { return { date: d, from: &apos;birthday&apos; }; }), debounceTime(this.debounceTime), distinctUntilChanged(), filter(_ =&gt; birthday.valid) ); const ageNum$ = ageNum.valueChanges.pipe( startWith(ageNum.value), debounceTime(this.debounceTime), distinctUntilChanged(), ); const ageUnit$ = ageUnit.valueChanges.pipe( startWith(ageUnit.value), debounceTime(this.debounceTime), distinctUntilChanged() ); // rxjs6ç‰ˆæœ¬ä¸­æ–¹æ³•è¢«æ”¹é€ äº† const age$ = combineLatest(ageNum$, ageUnit$).pipe( map(([_n, _u]) =&gt; this.toDate({ age: _n, unit: _u })), map(d =&gt; { return { date: d, from: &apos;age&apos; }; }), filter(_ =&gt; this.form.get(&apos;age&apos;).valid) ); const merged$ = Observable.prototype.pipe( merge(birthday$, age$), filter(_ =&gt; this.form.valid) ); this.sub = merged$.subscribe(d =&gt; { const age = this.toAge(d.date); if (d.from === &apos;birthday&apos;) { if (age.age !== ageNum.value) { ageNum.patchValue(age.age, { emitEvent: false }); } if (age.unit !== ageUnit.value) { this.selectedUnit = age.unit; ageUnit.patchValue(age.age, { emitEvent: false }); } this.propagateChange(d.date); } else { const ageToCompare = this.toAge(this.form.get(&apos;birthday&apos;).value); if (age.age !== ageToCompare.age || age.unit !== ageToCompare.unit) { birthday.patchValue(d.date, { emitEvent: false }); this.propagateChange(d.date); } } }); } ngOnDestroy(): void { if (this.sub) { this.sub.unsubscribe(); } } writeValue(obj: any): void { if (obj) { const date = format(obj, this.format); this.form.get(&apos;birthday&apos;).patchValue(date); const age = this.toAge(date); this.form.get(&apos;age&apos;).get(&apos;ageNum&apos;).patchValue(age.age); this.form.get(&apos;age&apos;).get(&apos;ageUnit&apos;).patchValue(age.unit); } } registerOnChange(fn: any): void { this.propagateChange = fn; } registerOnTouched(fn: any): void { } setDisabledState?(isDisabled: boolean): void { } toAge(dateStr: string): Age { const date = parse(dateStr); const now = Date.now(); return isBefore(subDays(now, this.daysTop), date) ? { age: differenceInDays(now, date), unit: AgeUnit.Day } : isBefore(subMonths(now, this.monthsTop), date) ? { age: differenceInMonths(now, date), unit: AgeUnit.Month } : { age: differenceInYears(now, date), unit: AgeUnit.Year }; } toDate(age: Age): string { const now = Date.now(); switch (age.unit) { case AgeUnit.Year: { return format(subYears(now, age.age), this.format); } case AgeUnit.Month: { return format(subMonths(now, age.age), this.format); } case AgeUnit.Day: { return format(subDays(now, age.age), this.format); } default: { return null; } } } validate(c: FormControl): { [key: string]: any } { const val = c.value; if (!val) { return null; } if (isValidDate(val)) { return null; } return { dateOfBirthInvalid: true }; } // è¡¨å•éªŒè¯å™¨ validateAge(ageNumkey: string, ageUnitKey: string) { return (group: FormGroup): { [key: string]: any } =&gt; { const ageNum = group.controls[ageNumkey]; const ageUnit = group.controls[ageUnitKey]; let result = false; const ageNumVal = ageNum.value; switch (ageUnit.value) { case AgeUnit.Year: { result = ageNumVal &gt;= this.yearsBottom &amp;&amp; ageNumVal &lt; this.yearsTop; break; } case AgeUnit.Month: { result = ageNumVal &gt;= this.monthsBottom &amp;&amp; ageNumVal &lt; this.monthsTop; break; } case AgeUnit.Day: { result = ageNumVal &gt;= this.daysBottom &amp;&amp; ageNumVal &lt; this.daysTop; break; } default: { break; } } return result ? null : { ageInvalid: true }; }; } validateDate(c: FormControl): { [key: string]: any } { const val = c.value; return isValidDate(val) ? null : { birthdayInvalid: true }; } } åœ°åŒºéƒ¨åˆ†: import { Component, OnInit, forwardRef, ChangeDetectionStrategy, OnDestroy } from &apos;@angular/core&apos;; import { NG_VALUE_ACCESSOR, NG_VALIDATORS, ControlValueAccessor, FormControl } from &apos;@angular/forms&apos;; import { Subscription, Subject, combineLatest, Observable, of } from &apos;rxjs&apos;; import { Address } from &apos;../../domain/user.model&apos;; import { startWith, map } from &apos;rxjs/operators&apos;; import { getProvinces, getCitiesByProvince, getAreasByCity } from &apos;../../utils/area.util&apos;; @Component({ selector: &apos;app-area-list&apos;, templateUrl: &apos;./area-list.component.html&apos;, styleUrls: [&apos;./area-list.component.scss&apos;], providers: [ { provide: NG_VALUE_ACCESSOR, useExisting: forwardRef(() =&gt; AreaListComponent), multi: true, }, { provide: NG_VALIDATORS, useExisting: forwardRef(() =&gt; AreaListComponent), multi: true, }, ], changeDetection: ChangeDetectionStrategy.OnPush, }) export class AreaListComponent implements ControlValueAccessor, OnInit, OnDestroy { _address: Address = { province: &apos;&apos;, city: &apos;&apos;, district: &apos;&apos;, street: &apos;&apos; }; _province = new Subject(); _city = new Subject(); _district = new Subject(); _street = new Subject(); provinces$: Observable&lt;string[]&gt;; cities$: Observable&lt;string[]&gt;; districts$: Observable&lt;string[]&gt;; private _sub: Subscription; private propagateChange = (_: any) =&gt; { }; constructor() { } ngOnInit() { const province$ = this._province.asObservable().pipe(startWith(&apos;&apos;)); const city$ = this._city.asObservable().pipe(startWith(&apos;&apos;)); const district$ = this._district.asObservable().pipe(startWith(&apos;&apos;)); const street$ = this._street.asObservable().pipe(startWith(&apos;&apos;)); const val$ = combineLatest([province$, city$, district$, street$], (_p, _c, _d, _s) =&gt; { return { province: _p, city: _c, district: _d, street: _s }; }); this._sub = val$.subscribe(v =&gt; { this.propagateChange(v); }); this.provinces$ = of(getProvinces()); // æ ¹æ®çœä»½çš„é€‰æ‹©å¾—åˆ°åŸå¸‚åˆ—è¡¨ this.cities$ = province$.pipe( map((p: string) =&gt; getCitiesByProvince(p)) ); // æ ¹æ®çœä»½å’ŒåŸå¸‚çš„é€‰æ‹©å¾—åˆ°åœ°åŒºåˆ—è¡¨ this.districts$ = combineLatest(province$, city$, (p, c) =&gt; ({ province: p, city: c })).pipe( map(a =&gt; getAreasByCity(a.province, a.city)) ); } ngOnDestroy(): void { if (this._sub) { this._sub.unsubscribe(); } } // è®¾ç½®åˆå§‹å€¼ writeValue(obj: Address): void { if (obj) { this._address = obj; if (this._address.province) { this._province.next(this._address.province); } if (this._address.city) { this._city.next(this._address.city); } if (this._address.district) { this._district.next(this._address.district); } if (this._address.street) { this._street.next(this._address.street); } } } registerOnChange(fn: any): void { this.propagateChange = fn; } registerOnTouched(fn: any): void { } setDisabledState?(isDisabled: boolean): void { } // éªŒè¯è¡¨å•ï¼ŒéªŒè¯ç»“æœæ­£ç¡®è¿”å› null å¦åˆ™è¿”å›ä¸€ä¸ªéªŒè¯ç»“æœå¯¹è±¡ validate(c: FormControl): { [key: string]: any } { const val = c.value; if (!val) { return null; } if (val.province &amp;&amp; val.city &amp;&amp; val.district &amp;&amp; val.street &amp;&amp; val.street.length &gt;= 4) { return null; } return { addressNotValid: true }; } onProvinceChange() { this._province.next(this._address.province); } onCityChange() { this._city.next(this._address.city); } onDistrictChange() { this._district.next(this._address.district); } onStreetChange() { this._street.next(this._address.street); } } å½“ç„¶äº†ï¼Œè¿™äº›ä¸æ˜¯å…¨éƒ¨çš„ä»£ç ï¼Œæœ‰äº›é‡å¤çš„åŠŸèƒ½æˆ‘å†™æˆäº†å•ç‹¬çš„tsæ–‡ä»¶ï¼Œæœ‰å…´è¶£çš„å¯ä»¥å»æˆ‘çš„githubä¸Šçœ‹ã€‚ è¿™æ ·æˆ‘ä»¬åªæ˜¯å®Œæˆäº†å„ä¸ªè‡ªå®šä¹‰æ§ä»¶ï¼Œè¿™æ ·çš„å¥½å¤„æ˜¯æˆ‘ä»¬çš„æ§ä»¶å¯ä»¥é‡å¤ä½¿ç”¨ï¼Œè€Œä¸”å„éƒ¨åˆ†é€»è¾‘éƒ½åœ¨å„è‡ªçš„éƒ¨åˆ†ï¼Œæ‰€ä»¥æœ€åæˆ‘ä»¬éœ€è¦ä¸€ä¸ªæ•´ä½“æ¥åŒ…å«è¿™äº›æ§ä»¶ã€‚ &lt;form [formGroup]=&quot;form&quot; (ngSubmit)=&quot;onSubmit(form, $event)&quot;&gt; &lt;mat-card&gt; &lt;mat-tab-group&gt; &lt;mat-tab label=&quot;å¸å·ä¿¡æ¯&quot;&gt; &lt;mat-card-header&gt; &lt;mat-card-title&gt;æ³¨å†Œ&lt;/mat-card-title&gt; &lt;/mat-card-header&gt; &lt;mat-card-content&gt; &lt;mat-form-field class=&quot;full-width&quot;&gt; &lt;input matInput placeholder=&quot;æ‚¨çš„email*&quot; type=&quot;email&quot; formControlName=&quot;email&quot;&gt; &lt;/mat-form-field&gt; &lt;mat-form-field class=&quot;full-width&quot;&gt; &lt;input matInput placeholder=&quot;æ‚¨çš„å§“å*&quot; type=&quot;text&quot; formControlName=&quot;name&quot;&gt; &lt;/mat-form-field&gt; &lt;mat-form-field class=&quot;full-width&quot;&gt; &lt;input matInput placeholder=&quot;è¾“å…¥æ‚¨çš„å¯†ç *&quot; type=&quot;password&quot; formControlName=&quot;password&quot;&gt; &lt;/mat-form-field&gt; &lt;mat-form-field class=&quot;full-width&quot;&gt; &lt;input matInput placeholder=&quot;é‡å¤è¾“å…¥æ‚¨çš„å¯†ç *&quot; type=&quot;password&quot; formControlName=&quot;repeat&quot;&gt; &lt;/mat-form-field&gt; &lt;app-image-list-select [useSvgIcon]=&quot;true&quot; [cols]=&quot;6&quot; [title]=&quot;&apos;é€‰æ‹©å¤´åƒï¼š&apos;&quot; [items]=&quot;items&quot; formControlName=&quot;avatar&quot;&gt; &lt;/app-image-list-select&gt; &lt;button mat-raised-button color=&quot;primary&quot; type=&quot;submit&quot;&gt;æ³¨å†Œ&lt;/button&gt; &lt;/mat-card-content&gt; &lt;mat-card-actions class=&quot;text-right&quot;&gt; &lt;p&gt;å·²æœ‰è´¦æˆ·ï¼Ÿ&lt;a href=&quot;&quot;&gt;ç™»å½•&lt;/a&gt;&lt;/p&gt; &lt;p&gt;å¿˜è®°å¯†ç ï¼Ÿ&lt;a href=&quot;&quot;&gt;æ‰¾å›&lt;/a&gt;&lt;/p&gt; &lt;/mat-card-actions&gt; &lt;/mat-tab&gt; &lt;mat-tab label=&quot;ä¸ªäººä¿¡æ¯&quot;&gt; &lt;div class=&quot;full-width control-padding&quot;&gt; &lt;app-identity-input formControlName=&quot;identity&quot; class=&quot;full-width control-padding&quot;&gt;&lt;/app-identity-input&gt; &lt;/div&gt; &lt;div class=&quot;full-width control-padding&quot;&gt; &lt;app-age-input formControlName=&quot;dateOfBirth&quot;&gt;&lt;/app-age-input&gt; &lt;/div&gt; &lt;div class=&quot;full-width control-padding&quot;&gt; &lt;app-area-list formControlName=&quot;address&quot;&gt;&lt;/app-area-list&gt; &lt;/div&gt; &lt;/mat-tab&gt; &lt;/mat-tab-group&gt; &lt;/mat-card&gt; &lt;/form&gt; è¿™ä¸ªéƒ¨åˆ†çš„å¤„ç†é€»è¾‘å¦‚ä¸‹ï¼š import { Component, OnInit, OnDestroy } from &apos;@angular/core&apos;; import { FormBuilder, Validators, FormGroup } from &apos;@angular/forms&apos;; import { debounceTime, filter } from &apos;rxjs/operators&apos;; import { Subscription } from &apos;rxjs&apos;; import { extractInfo, isValidAddr, getAddrByCode } from &apos;../../utils/identity.util&apos;; import { isValidDate } from &apos;../../utils/date.util&apos;; @Component({ selector: &apos;app-register&apos;, templateUrl: &apos;./register.component.html&apos;, styleUrls: [&apos;./register.component.scss&apos;] }) export class RegisterComponent implements OnInit, OnDestroy { items: string[]; form: FormGroup; sub: Subscription; private readonly avatarName = &apos;avatars&apos;; constructor(private fb: FormBuilder) { } ngOnInit() { const img = `${this.avatarName}:svg-${(Math.random() * 16).toFixed()}`; const nums = [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16]; this.items = nums.map(val =&gt; `avatars:svg-${val}`); this.form = this.fb.group({ email: [&apos;wang@163.com&apos;, Validators.compose([Validators.email, Validators.required])], name: [&apos;&apos;], password: [&apos;&apos;], repeat: [&apos;&apos;], avatar: [img], dateOfBirth: [&apos;1990-01-01&apos;], address: [&apos;&apos;], identity: [&apos;&apos;] }); const id$ = this.form.get(&apos;identity&apos;).valueChanges.pipe( debounceTime(300), filter(_ =&gt; this.form.get(&apos;identity&apos;).valid) ); this.sub = id$.subscribe(id =&gt; { const info = extractInfo(id.identityNo); if (isValidAddr(info.addrCode)) { const addr = getAddrByCode(info.addrCode); this.form.get(&apos;address&apos;).patchValue(addr); } if (isValidDate(info.dateOfBirth)) { this.form.get(&apos;dateOfBirth&apos;).patchValue(info.dateOfBirth); } }); } ngOnDestroy(): void { if (this.sub) { this.sub.unsubscribe(); } } onSubmit({ value, valid }, ev: Event) { ev.preventDefault(); if (!valid) { return; } console.log(value); } } è¿™æ ·å°±å½¢æˆäº†ä¸€ä¸ªå®Œæ•´çš„è‡ªå®šä¹‰è¡¨å•æ§ä»¶ï¼Œè€Œä¸”é‡Œé¢éƒ¨åˆ†è¿˜å¯ä»¥æ‹¿å‡ºæ¥å•ç‹¬ä½¿ç”¨ã€‚","tags":[{"name":"Angular","slug":"Angular","permalink":"http://tanyibing.com/tags/Angular/"},{"name":"Typescript","slug":"Typescript","permalink":"http://tanyibing.com/tags/Typescript/"},{"name":"Material","slug":"Material","permalink":"http://tanyibing.com/tags/Material/"}]},{"title":"rxjsä¸­çš„combineLatest","date":"2018-10-17T03:43:35.000Z","path":"2018/10/17/rxjsä¸­çš„combineLatest/","text":"åœ¨Rxjsç¬¬å…­ç‰ˆä¹‹å‰ï¼Œæˆ‘ä»¬ä½¿ç”¨combineLatestè¿™ä¸ªoperatoræ—¶çš„æ–¹å¼å¦‚ä¸‹ï¼š const age$ = Observable .combineLatest(ageNum$, ageUnit$, (_num, _unit) =&gt; this.toDate({age: _num, unit: _unit})) .map(d =&gt; ({date: d, from: &apos;age&apos;})) .filter(_ =&gt; this.form.get(&apos;age&apos;).valid); ä½†æ˜¯ï¼Œåœ¨Rxjsç¬¬å…­ç‰ˆä¸­combineLatestè¿™ä¸ªoperatorè¢«é—å¼ƒäº†ï¼Œè€Œæ˜¯è¢«æ”¹æˆä¸€ä¸ªfunctionï¼Œç„¶åé…åˆpipe()ä½¿ç”¨ï¼Œæ”¹é€ åçš„æ–¹æ³•å¦‚ä¸‹ï¼š const age$ = combineLatest(ageNum$, ageUnit$).pipe( map(([_n, _u]) =&gt; this.toDate({ age: _n, unit: _u })), map(d =&gt; { return { date: d, from: &apos;age&apos; }; }), filter(_ =&gt; this.form.get(&apos;age&apos;).valid) ); è¿™ä¹‹é—´å‘ç”Ÿäº†æ˜æ˜¾çš„å˜åŒ–ï¼Œé¦–å…ˆè°ƒç”¨çš„æ–¹å¼å°±ä¸åŒï¼Œç‰ˆæœ¬å…­ä¹‹å‰æ˜¯è°ƒç”¨Observable.combineLatestï¼Œè€Œåœ¨ç‰ˆæœ¬å…­ä¹‹åç›´æ¥å°±å¯ä»¥ä½¿ç”¨combineLatest()ï¼›è¿˜æœ‰ä¸€ä¸ªä¸åŒå°±æ˜¯å‚æ•°ä¸åŒäº†ï¼ŒåŸå…ˆçš„å‚æ•°æœ€åå¯ä»¥æ¥å—ä¸€ä¸ªprojectï¼Œå®ç°å¯¹å…ƒç´ çš„æ“ä½œï¼Œä½†æ˜¯ç¬¬å…­ç‰ˆä¹‹åï¼Œæˆ‘ä»¬éœ€è¦pipeå‡ºæ¥ä¹‹åï¼Œä½¿ç”¨mapæ¥å¯¹å…ƒç´ è¿›è¡Œæ“ä½œï¼Œè€Œä¸”å…ƒç´ æ˜¯åœ¨ä¸€ä¸ªæ•°ç»„é‡Œé¢çš„ï¼Œè¿™å½’æ ¹ç»“åº•æ˜¯å› ä¸ºè¿”å›çš„ç±»å‹ä¸ä¸€æ ·äº†ï¼Œoperatorè¿”å›çš„å°±æ˜¯ä¸€ä¸ªoperatorï¼Œè€Œç¬¬å…­ç‰ˆä¹‹åè¿”å›çš„æ˜¯ä¸€ä¸ªObservableå¯¹è±¡ï¼Œæˆ‘ä»¬å¯ä»¥ç»§ç»­å¯¹å…¶è¿›è¡Œæ“ä½œã€‚","tags":[{"name":"Rxjs","slug":"Rxjs","permalink":"http://tanyibing.com/tags/Rxjs/"},{"name":"Angular","slug":"Angular","permalink":"http://tanyibing.com/tags/Angular/"}]},{"title":"ä½¿ç”¨jså®ç°å›¾ç‰‡çš„å¾ªç¯æ’­æ”¾","date":"2018-10-14T05:38:01.000Z","path":"2018/10/14/ä½¿ç”¨jså®ç°å›¾ç‰‡çš„å¾ªç¯æ’­æ”¾/","text":"ä»Šå¤©æƒ³è¦å®ç°å¾ˆå¤šå›¾ç‰‡çš„å¾ªç¯æ’­æ”¾ï¼Œæˆ‘ä»¬é¦–å…ˆè¦æŠŠæ‰€æœ‰çš„å›¾ç‰‡æ”¾åˆ°ä¸€è¡Œä¸Šé¢ï¼Œå…·ä½“æ€ä¹ˆå†™cssåœ¨è¿™å°±ä¸å•°å—¦äº†ï¼Œæœ€åçš„htmlç»“æ„å¦‚ä¸‹ï¼š &lt;div class=&quot;container&quot;&gt; &lt;ul class=&quot;first&quot;&gt; &lt;li&gt; &lt;img src=&quot;./images/1.jpg&quot; alt=&quot;&quot;&gt; &lt;/li&gt; &lt;li&gt; &lt;img src=&quot;./images/2.jpg&quot; alt=&quot;&quot;&gt; &lt;/li&gt; &lt;li&gt; &lt;img src=&quot;./images/3.jpg&quot; alt=&quot;&quot;&gt; &lt;/li&gt; &lt;/ul&gt; &lt;ul class=&quot;second&quot;&gt; &lt;li&gt; &lt;img src=&quot;./images/1.jpg&quot; alt=&quot;&quot;&gt; &lt;/li&gt; &lt;li&gt; &lt;img src=&quot;./images/2.jpg&quot; alt=&quot;&quot;&gt; &lt;/li&gt; &lt;li&gt; &lt;img src=&quot;./images/3.jpg&quot; alt=&quot;&quot;&gt; &lt;/li&gt; &lt;/ul&gt; &lt;/div&gt; è¿™é‡Œæˆ‘è®¾ç½®äº†ä¸¤ä¸ªç›¸åŒçš„å›¾ç‰‡ulæ˜¯ä¸ºäº†æ›´å¥½çš„å®ç°æ— ç¼æ’­æ”¾ï¼Œç´§æ¥ç€jsä»£ç å¦‚ä¸‹ï¼š window.onload = function () { var container = document.querySelector(&apos;.container&apos;); var first = document.querySelector(&apos;.first&apos;); var second = document.querySelector(&apos;.second&apos;); // è·å¾—ä¸€ä¸ªulå›¾ç‰‡å¾ªç¯éœ€è¦çš„é•¿åº¦ var length = ul1.offsetWidth; var x = 0; // å½“ä¸€ä¸ªå¾ªç¯ç»“æŸæ—¶ï¼Œå°†xé‡ç½®ä¸º0ï¼Œç¬¬äºŒä¸ªulå…¶å®å°±æ˜¯èµ·ä¸€ä¸ªå¼¥è¡¥ä¸Šä¸€ä¸ªçš„ç©ºç™½çš„ä½œç”¨ã€‚ var fun = function () { first.style.left = x/100 + &apos;rem&apos;; second.style.left = (x + length)/100 + &apos;rem&apos;; x--; if ((x + length) == 0) { x = 0; } } var loop = setInterval(fun, 10); // é¼ æ ‡ç§»ä¸Šå»æš‚åœæ»šåŠ¨ container.onmouseover = function () { clearInterval(loop); } // é¼ æ ‡ç§»å¼€ç»§ç»­æ»šåŠ¨ container.onmouseout = function () { loop = setInterval(fun, 10); } } æ³¨é‡Šé‡Œé¢è§£é‡Šå•¦ï¼Œå¾ˆç®€å•ã€‚","tags":[{"name":"JavaScript","slug":"JavaScript","permalink":"http://tanyibing.com/tags/JavaScript/"}]},{"title":"angularä¸­selectçš„changeäº‹ä»¶","date":"2018-10-11T14:53:39.000Z","path":"2018/10/11/angularä¸­selectçš„changeäº‹ä»¶/","text":"ä»Šå¤©åœ¨ä½¿ç”¨materialä¸­çš„selectç»„ä»¶çš„æ—¶å€™å‘ç°ï¼Œæˆ‘çš„selectä¸Šé¢çš„changeäº‹ä»¶é€šè¿‡ä¸‹é¢çš„æ–¹æ³•å¹¶ä¸èƒ½æ¥æ”¶æ•°æ®ï¼Œæ¨¡æ¿å¦‚ä¸‹ï¼š &lt;mat-form-field&gt; &lt;mat-select placeholder=&quot;è¯·é€‰æ‹©çœä»½&quot; [(ngModel)]=&quot;_address.province&quot; (change)=&quot;onProvinceChange()&quot;&gt; &lt;mat-option *ngFor=&quot;let p of provinces$ | async&quot; [value]=&quot;p&quot;&gt; {{ p }} &lt;/mat-option&gt; &lt;/mat-select&gt; &lt;/mat-form-field&gt; æˆ‘æƒ³é€šè¿‡selectçš„å˜åŒ–æ¥æ§åˆ¶å…¶ä»–æ•°æ®çš„æ˜¾ç¤ºï¼Œä½†æ˜¯changeæ–¹æ³•å¥½åƒç›‘å¬ä¸åˆ°æ”¹å˜ä¸€æ ·ï¼Œæœ€åé€šè¿‡åº¦å¨˜ï¼Œæ‰¾åˆ°äº†æ–¹æ³•ï¼Œå°†changeäº‹ä»¶æ”¹æˆngModelChangeå°±å¯ä»¥äº†ï¼š &lt;mat-form-field&gt; &lt;mat-select placeholder=&quot;è¯·é€‰æ‹©çœä»½&quot; [(ngModel)]=&quot;_address.province&quot; (ngModelChange)=&quot;onProvinceChange()&quot;&gt; &lt;mat-option *ngFor=&quot;let p of provinces$ | async&quot; [value]=&quot;p&quot;&gt; {{ p }} &lt;/mat-option&gt; &lt;/mat-select&gt; &lt;/mat-form-field&gt; è¿™æ ·å°±å¯ä»¥è·å¾—äº‹ä»¶äº†ã€‚","tags":[{"name":"Angular","slug":"Angular","permalink":"http://tanyibing.com/tags/Angular/"},{"name":"Typescript","slug":"Typescript","permalink":"http://tanyibing.com/tags/Typescript/"},{"name":"Material","slug":"Material","permalink":"http://tanyibing.com/tags/Material/"}]},{"title":"è®¾ç½®inputä¸­placeholderçš„å­—ä½“é¢œè‰²","date":"2018-10-10T14:22:46.000Z","path":"2018/10/10/è®¾ç½®inputä¸­placeholderçš„å­—ä½“é¢œè‰²/","text":"åœ¨ä¸€ä¸ªæœ‰èƒŒæ™¯çš„divä¸­åˆ›å»ºä¸€ä¸ªformä¹‹åï¼Œæˆ‘å‘ç°inputçš„èƒŒæ™¯é»˜è®¤æ˜¯ç™½è‰²çš„ï¼Œè¿™æ ·çš„è¯å°±æ— æ³•çœ‹åˆ°èƒŒæ™¯å›¾ï¼Œæ‰€ä»¥æˆ‘å°†inputçš„èƒŒæ™¯è°ƒæˆé€æ˜ï¼Œå¹¶åŠ ä¸Šè¾¹æ¡†æ¥å‡¸æ˜¾å‡ºinputçš„å­˜åœ¨ï¼š input { background: transparent; border: #ffffff solid 1px; } è¿™æ ·æˆ‘ä»¬çš„inputæ¡†å°±å‘ˆç°é€æ˜çš„çŠ¶æ€ã€‚ä½†æ˜¯æˆ‘å‘ç°inputä¸­çš„placeholderçš„é¢œè‰²æ˜¯é»‘è‰²çš„ï¼Œåœ¨æˆ‘çš„èƒŒæ™¯ä¸‹é¢ä¸æ˜¯ç‰¹åˆ«æ¸…æ™°ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è…°æ”¹å˜placeholderçš„å­—ä½“é¢œè‰²ï¼š ::-webkit-input-placeholder{/*Webkit browsers*/ color:#999; font-size:16px; } :-moz-placeholder{/*Mozilla Firefox 4 to 8*/ color:#999; font-size:16px; } ::moz-placeholder{/*Mozilla Firefox 19+*/ color:#999; font-size:16px; } :-ms-input-placeholder{/*Internet Explorer 10+*/ color:#999; font-size:16px; } æˆ‘ä»¬åªè¦åœ¨ï¼šå‰é¢åŠ ä¸Šinputæˆ–è€…textareaå°±å¯ä»¥æ”¹å˜placeholderçš„å­—ä½“ã€‚å®ƒçš„å…¼å®¹æ€§å¦‚ä¸‹ï¼š","tags":[{"name":"HTML","slug":"HTML","permalink":"http://tanyibing.com/tags/HTML/"},{"name":"CSS","slug":"CSS","permalink":"http://tanyibing.com/tags/CSS/"}]},{"title":"åœ¨VScodeä¸­ä½¿ç”¨Git","date":"2018-10-09T13:31:16.000Z","path":"2018/10/09/åœ¨VScodeä¸­ä½¿ç”¨Git/","text":"åœ¨VsCodeä¸­ä½¿ç”¨Gitæ¥å°†æˆ‘çš„ä¿®æ”¹ä¿å­˜åˆ°è¿œç¨‹ä»“åº“çš„æ“ä½œï¼š é¦–å…ˆæˆ‘ä»¬åœ¨Githubä¸Šåˆ›å»ºä¸€ä¸ªä»“åº“ï¼Œå¦åˆ™æˆ‘ä»¬çš„é¡¹ç›®æ²¡åŠæ³•ä¿å­˜åˆ°è¿œç¨‹ä»“åº“ã€‚ æ¥ä¸‹æ¥æˆ‘ä¸€èˆ¬æ˜¯åœ¨æœ¬åœ°åˆ›å»ºä¸€ä¸ªç›®å½•ï¼Œå¹¶ä¸”ç”¨VsCodeæ‰“å¼€ç›®å½•ã€‚ ç„¶åæˆ‘ä»¬å¼€å§‹å°†æœ¬åœ°ç›®å½•å’Œè¿œç¨‹ä»“åº“å…³è”èµ·æ¥ï¼Œé¦–å…ˆåœ¨VsCodeä¸­è¿è¡Œgit initå‘½ä»¤æ¥å°†æ–‡ä»¶å¤¹åˆå§‹åŒ–æˆGitä»“åº“ã€‚ ç„¶åæˆ‘ä»¬è¿è¡Œgit remote add origin XXX(ä½ çš„githubä»“åº“åœ°å€),è¿™æ ·å°±å®Œæˆäº†å…³è”ã€‚ æ¥ç€ç‚¹å‡»å›¾ä¸­çš„masteræŒ‰é’®ï¼Œå°±å¯ä»¥çœ‹åˆ°æˆ‘ä»¬çš„è¿œç¨‹ä»“åº“ï¼Œé€‰æ‹©å®ƒï¼Œå¹¶åœ¨ç›®å½•ä¸‹è¿›è¡Œå·¥ä½œã€‚&gt; æˆ‘ä»¬ä¹Ÿè®¸éœ€è¦å®šä¹‰ä¸€ä¸ª.gitignoreæ–‡ä»¶æ¥å¿½ç•¥æ‰ä¸€äº›ä½ ä¸æƒ³å±•ç¤ºç»™åˆ«äººçœ‹çš„ï¼Œæˆ–è€…ä¸é‡è¦çš„æ–‡ä»¶ã€‚ åˆ«å¿˜åœ¨å·¥ä½œåŒºå·¥ä½œä¹‹åè¦æäº¤æ›´æ”¹ï¼Œå¹¶ä¸”åŒæ­¥åˆ°è¿œç¨‹ä»“åº“ã€‚","tags":[{"name":"VsCode","slug":"VsCode","permalink":"http://tanyibing.com/tags/VsCode/"},{"name":"Git","slug":"Git","permalink":"http://tanyibing.com/tags/Git/"}]},{"title":"MongoDBæ€ä¹ˆå¯¼å…¥æ•°æ®","date":"2018-10-08T14:44:24.000Z","path":"2018/10/08/MongoDBæ€ä¹ˆå¯¼å…¥æ•°æ®/","text":"ä½¿ç”¨nodeçš„è¿‡ç¨‹ä¸­ä½¿ç”¨äº†MongoDBï¼Œåœ¨MongoDBä¸­æ€ä¹ˆç›´æ¥å°†æ•°æ®å¯¼å…¥æ•°æ®åº“å‘¢ï¼Ÿæˆ‘ä»¬åªéœ€è¦ä¸€æ¡å‘½ä»¤å°±è¡Œäº†ã€‚ mongorestore -h dbhost -d dbname path å…¶ä¸­dbhostä»£è¡¨ä½ çš„hostï¼Œä¸€èˆ¬åœ¨è‡ªå·±çš„ç”µè„‘ä¸Šçš„è¯æ˜¯127.0.0.1ï¼Œdbnameä»£è¡¨è¦å¯¼å…¥çš„æ•°æ®åº“ï¼Œå¯ä»¥æ˜¯ä¸å­˜åœ¨çš„ï¼Œé»˜è®¤ä¼šåˆ›å»ºä¸€ä¸ªæ–°çš„æ•°æ®åº“ï¼Œpathå°±æ˜¯ä½ çš„æ•°æ®åº“æ•°æ®å­˜æ”¾çš„ä½ç½®ã€‚è·¯å¾„ä¸­æœ€å¥½ä¸è¦æœ‰ä¸­æ–‡ï¼Œä»¥é˜²å¯¼å…¥å¤±è´¥ã€‚è¿™è¡Œå‘½ä»¤ä¸éœ€è¦è¿›å…¥åˆ°æ•°æ®åº“é‡Œé¢å†æ‰§è¡Œï¼Œç›´æ¥åœ¨cmdä¸­è¿è¡Œå°±å¯ä»¥äº†ã€‚ æƒ³è¦å¯¼å‡ºçš„è¯ä¹Ÿå¾ˆç®€å•ï¼Œåªè¦æ‰§è¡Œä¸‹é¢çš„å‘½ä»¤ï¼š mongodump -h dbhost -d dbname -o dbdirectory -o dbdirectoryæ˜¯æŒ‡å¯¼å‡ºåˆ°å“ªä¸ªç›®å½•ã€‚ä½†æ˜¯å¯¼å‡ºä¹‹å‰æˆ‘ä»¬éœ€è¦æ‰“å¼€æˆ‘ä»¬çš„æ•°æ®è·¯æœåŠ¡ï¼š mongod â€“dbpath yourpath å†æ‰§è¡Œä¸Šé¢çš„å¯¼å‡ºå‘½ä»¤å°±OKå•¦ã€‚","tags":[{"name":"MongoDB","slug":"MongoDB","permalink":"http://tanyibing.com/tags/MongoDB/"}]},{"title":"ES6ä¸­çš„export & import","date":"2018-10-07T15:44:24.000Z","path":"2018/10/07/ES6ä¸­çš„export-import/","text":"ä¸Šæ¬¡è¯´äº†ä¸€ä¸‹exportså’Œmodule.exportsçš„åŒºåˆ«ï¼Œä½†æ˜¯åªè®²äº†é‚£ä¸€ç§çŠ¶æ€ï¼Œæ‰€ä»¥ä»Šå¤©ç‰¹æ„å†æ¥çœ‹çœ‹ES6ä¸­moduleçš„å†…å®¹ã€‚ åœ¨ES6ä¸­ï¼Œä¸“é—¨å®ç°äº†æ¨¡å—åŒ–çš„åŠŸèƒ½ã€‚æƒ³è¦æ›´ä»”ç»†çš„é˜…è¯»å¯ä»¥çœ‹ä¸€çœ‹é˜®ä¸€å³°çš„ã€ŠESMAScript6å…¥é—¨ã€‹ä¸­çš„Moduleçš„è¯­æ³•ã€‚é‡Œé¢æ˜¯è¿™ä¹ˆè¯´çš„ï¼š åœ¨ ES6 ä¹‹å‰ï¼Œç¤¾åŒºåˆ¶å®šäº†ä¸€äº›æ¨¡å—åŠ è½½æ–¹æ¡ˆï¼Œæœ€ä¸»è¦çš„æœ‰ CommonJS å’Œ AMD ä¸¤ç§ã€‚å‰è€…ç”¨äºæœåŠ¡å™¨ï¼Œåè€…ç”¨äºæµè§ˆå™¨ã€‚ES6 åœ¨è¯­è¨€æ ‡å‡†çš„å±‚é¢ä¸Šï¼Œå®ç°äº†æ¨¡å—åŠŸèƒ½ï¼Œè€Œä¸”å®ç°å¾—ç›¸å½“ç®€å•ï¼Œå®Œå…¨å¯ä»¥å–ä»£ CommonJS å’Œ AMD è§„èŒƒï¼Œæˆä¸ºæµè§ˆå™¨å’ŒæœåŠ¡å™¨é€šç”¨çš„æ¨¡å—è§£å†³æ–¹æ¡ˆã€‚ ç”±æ­¤å¯è§ES6ä¸­çš„æ¨¡å—åŒ–åŠŸèƒ½è¿˜æ˜¯å¾ˆå¼ºå¤§çš„ã€‚ exportå…ˆçœ‹å‡ ç§exportçš„å†™æ³•ï¼š // ç¬¬ä¸€ç§ è¾“å‡ºä¸¤ä¸ªå˜é‡ export var firstName = &apos;Michael&apos;; export var lastName = &apos;Jackson&apos;; // ç¬¬äºŒç§ å’Œç¬¬ä¸€ç§ä¸€æ ·ï¼Œç›¸åŒæƒ…å†µåº”è¯¥ä¼˜å…ˆä½¿ç”¨ç¬¬äºŒç§ã€‚ var firstName = &apos;Michael&apos;; var lastName = &apos;Jackson&apos;; export {firstName, lastName, year}; // ç¬¬ä¸‰ç§ è¾“å‡ºå‡½æ•°æˆ–ç±» export function multiply(x, y) { return x * y; }; ä¸Šé¢çš„ä¸‰ç§æƒ…å†µåœ¨æ³¨é‡Šé‡Œè§£é‡Šäº†ï¼Œå°±æŒ‰è¿™ç§æ¨¡å¼å†™ã€‚ä½†æ˜¯è¦æ³¨æ„çš„æ˜¯ä¸è¦å†™æˆä¸‹é¢çš„æ ·å­; // æŠ¥é”™ export 1; // æŠ¥é”™ var m = 1; export m; è¿™æ ·å†™æ˜¯ç›´æ¥è¾“å‡ºï¼Œè€Œä¸æ˜¯é€šè¿‡æ¥å£ï¼Œæ‰€ä»¥ä¼šæŠ¥é”™ã€‚åº”è¯¥å†™æˆä¸‹é¢è¿™æ ·ï¼š // å†™æ³•ä¸€ export var m = 1; // å†™æ³•äºŒ var m = 1; export {m}; // å†™æ³•ä¸‰ var n = 1; export {n as m}; åŒæ ·çš„ï¼Œfunctionå’Œclassä¹Ÿè¦æŒ‰è¿™ç§æ¥å£çš„æ–¹å¼å»å†™ï¼š // æŠ¥é”™ function f() {} export f; // æ­£ç¡® export function f() {}; // æ­£ç¡® function f() {} export {f}; importçœ‹å‡ ä¸ªimportçš„å†™æ³•ï¼š // æ™®é€šå†™æ³• import {firstName, lastName, year} from &apos;./profile.js&apos;; // é‡å‘½åå†™æ³• import { lastName as surname } from &apos;./profile.js&apos;; // æ•´ä½“åŠ è½½å†™æ³• import * as name from &apos;./profile.js&apos;; è¿™å°±æ˜¯importçš„å‡ ç§å†™æ³•ï¼Œä¸è¦å¦–æ¥å¦–å»çš„ï¼Œä¾‹å¦‚ä½¿ç”¨è¡¨è¾¾å¼å’Œå˜é‡ã€ä¿®æ”¹æ¥å£å•Šä»€ä¹ˆçš„æ“ä½œï¼Œå³ä½¿å¯ä»¥æ“ä½œï¼Œä¹Ÿæ˜¯æä¸æ¨èçš„ï¼Œé˜²æ­¢å‡ºç°é”™è¯¯åæ‰¾ä¸åˆ°é—®é¢˜çš„æ ¹æºã€‚ export defaultexport defaultæ˜¯ä¸€ç§é»˜è®¤è¾“å‡ºçš„æ–¹å¼ï¼Œä»–çš„å½¢å¼å¦‚ä¸‹ï¼š // è¾“å‡º export default function () { console.log(&apos;foo&apos;); } // è¾“å…¥ import customName from &apos;./export-default&apos;; customName(); å¯ä»¥å‘ç°ï¼Œé»˜è®¤è¾“å‡ºä¹‹åï¼Œå¼•å…¥æ—¶è¢«å½“æˆåŒ¿åå‡½æ•°ï¼Œæˆ‘ä»¬å¯ä»¥ç»™ä»–èµ·ä»»æ„çš„åå­—ã€‚export defaultå¯ä»¥ç”¨åœ¨éåŒ¿åå‡½æ•°å‰é¢ï¼Œä½†æ˜¯åœ¨å¤–éƒ¨è¿˜æ˜¯ä¼šè¢«å½“æˆåŒ¿åå‡½æ•°æ¥åŠ è½½ã€‚è¿˜å¯ä»¥å‘ç°çš„æ˜¯ï¼Œä½¿ç”¨é»˜è®¤è¾“å‡ºä¹‹åï¼Œåœ¨importæ—¶ä¸å†éœ€è¦å¤§æ‹¬å·äº†ï¼Œè¿™æ˜¯å› ä¸ºexport defaultåªèƒ½ä½¿ç”¨ä¸€æ¬¡ï¼Œæ‰€ä»¥åœ¨å¼•å…¥æ—¶å¯ä»¥ä¸åŠ å¤§æ‹¬å·ã€‚ æ­£æ˜¯å› ä¸ºexport defaultå‘½ä»¤å…¶å®åªæ˜¯è¾“å‡ºä¸€ä¸ªå«åšdefaultçš„å˜é‡ï¼Œæ‰€ä»¥å®ƒåé¢ä¸èƒ½è·Ÿå˜é‡å£°æ˜è¯­å¥ã€‚ // æ­£ç¡® export var a = 1; // æ­£ç¡® var a = 1; export default a; // é”™è¯¯ export default var a = 1; // æ­£ç¡® export default 42; // æŠ¥é”™ export 42; å¤åˆå†™æ³•å¦‚æœåœ¨ä¸€ä¸ªæ¨¡å—ä¹‹ä¸­ï¼Œå…ˆè¾“å…¥åè¾“å‡ºåŒä¸€ä¸ªæ¨¡å—ï¼Œimportè¯­å¥å¯ä»¥ä¸exportè¯­å¥å†™åœ¨ä¸€èµ·ã€‚ä¾‹å¦‚ä¸‹é¢ï¼š export { foo, bar } from &apos;my_module&apos;; // å¯ä»¥ç®€å•ç†è§£ä¸º import { foo, bar } from &apos;my_module&apos;; export { foo, bar }; ä¸Šé¢ä»£ç ä¸­ï¼Œexportå’Œimportè¯­å¥å¯ä»¥ç»“åˆåœ¨ä¸€èµ·ï¼Œå†™æˆä¸€è¡Œã€‚ä½†éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œå†™æˆä¸€è¡Œä»¥åï¼Œfooå’Œbarå®é™…ä¸Šå¹¶æ²¡æœ‰è¢«å¯¼å…¥å½“å‰æ¨¡å—ï¼Œåªæ˜¯ç›¸å½“äºå¯¹å¤–è½¬å‘äº†è¿™ä¸¤ä¸ªæ¥å£ï¼Œå¯¼è‡´å½“å‰æ¨¡å—ä¸èƒ½ç›´æ¥ä½¿ç”¨fooå’Œbarã€‚","tags":[{"name":"JavaScript","slug":"JavaScript","permalink":"http://tanyibing.com/tags/JavaScript/"}]},{"title":"å‘å‘ç‰¢éªš","date":"2018-10-02T14:39:47.000Z","path":"2018/10/02/å‘å‘ç‰¢éªš/","text":"ä»Šå¤©åœ¨å®¶åƒé¥­ï¼Œå¤§å®¶éƒ½èšåœ¨ä¸€èµ·ï¼Œå–äº†å¾ˆå¤šé…’ï¼Œä¹ŸèŠäº†å¾ˆå¤šå®¶åº­çš„é—®é¢˜ã€‚ä»å°å’Œå®¶é•¿ä¹‹é—´çš„äº¤æµå°±å¾ˆå°‘ï¼ŒçœŸæ­£è®¤çœŸçš„äº¤æµå°±æ›´åŠ æ˜¯å±ˆæŒ‡å¯æ•°ã€‚æ›´å¤šçš„ä¹Ÿæ˜¯åœ¨äº‰åµä¹‹ä¸­åéœ²å¿ƒå£°ï¼Œä½†ä¹Ÿè¢«å†²åŠ¨çš„æƒ…ç»ªæ©ç›–äº†ã€‚é•¿å¤§ä¹‹åä¹Ÿå¤šå¤šå°‘å°‘æ€è€ƒè¿‡è¿™äº›äº‹æƒ…ã€‚è¿‡å»è¿™ä¹ˆä¹…äº†ï¼Œçˆ·çˆ·å¥¶å¥¶ä¹Ÿè½¬å˜äº†å¾ˆå¤šï¼Œæˆ‘çˆ¶äº²å¯¹æˆ‘çš„æ€åº¦ä¹Ÿæœ‰å¾ˆå¤§çš„æ”¹å˜ã€‚å…¶å®ä»–ä»¬åªæ˜¯ä¸ä¼šè¡¨è¾¾ï¼Œä¸å–„äºäº¤æµï¼Œä½†ä»–ä»¬ä¹Ÿæ˜¯çœŸå¿ƒå¸Œæœ›å­©å­ä»¬è¿‡å¾—å¥½ã€‚åæ€åæ€è‡ªå·±ï¼Œè¿˜æœ‰å¾ˆå¤šåœ°æ–¹æ²¡åšå¥½ã€‚ä»¥ååœ¨å¤–å·¥ä½œè¦ç»å¸¸ç»™å®¶é‡Œå¸¦ç”µè¯ï¼Œå›å®¶ä¹Ÿåº”è¯¥ä¹°äº›æ°´æœç»™çˆ·çˆ·å¥¶å¥¶ã€å¤–å…¬å¤–å©†ã€‚å› ä¸ºç•™ç»™ä»–ä»¬çš„æ—¶é—´ä¸å¤šäº†ï¼Œèƒ½å’Œæˆ‘ä»¬åœ¨ä¸€èµ·çš„æ—¥å­æ›´å°‘ã€‚è¦å¤šæŠ½ç©ºå›å®¶é™ªé™ªä»–ä»¬ï¼Œè®©ä»–ä»¬ä¸è¦å¤ªå¯‚å¯ã€‚ä¸è¦ç­‰åˆ°æœ€åå­æ¬²å…»è€Œäº²ä¸å¾…~~~","tags":[{"name":"balabala","slug":"balabala","permalink":"http://tanyibing.com/tags/balabala/"}]},{"title":"ä½¿ç”¨Rx.jså’Œjson-serveræ¨¡æ‹Ÿéšæœºè·å–å†…å®¹","date":"2018-09-29T09:03:56.000Z","path":"2018/09/29/ä½¿ç”¨Rx-jså’Œjson-serveræ¨¡æ‹Ÿéšæœºè·å–å†…å®¹/","text":"ä»Šå¤©ä½¿ç”¨angularä¸­çš„rx.jsæ¥å°†æˆ‘ä»¬çš„æ•°æ®è½¬æ¢æˆObservableï¼Œæ¯•ç«Ÿangularä¸­åˆ°å¤„éƒ½æ˜¯Observableå¯è§‚å¯Ÿå¯¹è±¡è¿™ç§æ–¹å¼ï¼Œå› ä¸ºä½¿ç”¨èµ·æ¥å¾ˆæ–¹ä¾¿ã€‚ æˆ‘ä»¬æ²¡æœ‰çœŸçš„åå°æ€ä¹ˆæ¨¡æ‹Ÿæ¥å£å‘¢ï¼Œæˆ‘ç›´æ¥ä½¿ç”¨äº†json-serverï¼Œè¿™ä¸ªä½¿ç”¨èµ·æ¥å¾ˆæ–¹ä¾¿ï¼Œåªéœ€è¦å†™å¥½ä¸€ä¸ªæ¨¡æ‹Ÿæ¥å£çš„jsonæ–‡ä»¶ï¼Œç„¶åæ‰§è¡Œå‘½ä»¤å°±è¡Œäº†ã€‚é¦–å…ˆæˆ‘ä»¬å®‰è£…ï¼š cnpm install --save-dev json-server ç„¶åæˆ‘ä»¬å†™ä¸€ä¸ªjsonæ–‡ä»¶ï¼Œç´§æ¥ç€æ‰§è¡Œä¸€æ¡å‘½ä»¤ï¼š json-server ./mock/data.json è¿™æ ·æˆ‘å°±èƒ½åœ¨localhost:3000ä¸‹é¢é€šè¿‡httpè¯·æ±‚åˆ°æˆ‘çš„jsonæ–‡ä»¶å•¦ã€‚ ç´§æ¥ç€æˆ‘ä»¬æŠŠè·å–jsonæ–‡ä»¶åŠŸèƒ½å°è£…æˆangularä¸­çš„ä¸€ä¸ªæœåŠ¡ï¼š import { Injectable, Inject } from &apos;@angular/core&apos;; import { Quote } from &apos;../domain/quote.model&apos;; import { Observable } from &apos;rxjs&apos;; import { HttpClient } from &apos;@angular/common/http&apos;; import { map } from &apos;rxjs/operators&apos;; @Injectable() export class QuoteService { constructor( private Http: HttpClient, @Inject(&apos;BASE_CONFIG&apos;) private config ) {} getQuote(): Observable&lt;Quote&gt; { const uri = `${this.config.uri}/quotes/${Math.floor(Math.random() * 10)}`; return this.Http.get(uri).pipe(map(res =&gt; res as Quote)); } } è¿™æ ·æˆ‘ä»¬å°±æ³¨å†Œäº†ä¸€ä¸ªæˆ‘ä»¬è‡ªå·±çš„æœåŠ¡ï¼Œè€Œä¸”æˆ‘ä»¬åŒè¿‡éšæœºè¯·æ±‚uriå¯ä»¥å®ç°éšæœºè·å–å†…å®¹ä¸­çš„ä¸€å¤©ã€‚è€Œä¸”ï¼Œæˆ‘ä»¬æœ€ååœ¨è¿”å›çš„æ—¶å€™ï¼Œè¿”å›çš„æ˜¯Observableç±»å‹çš„å†…å®¹ã€‚åœ¨éœ€è¦ä½¿ç”¨è¿™äº›å†…å®¹çš„ç»„ä»¶å†…ï¼Œæˆ‘ä»¬åªè¦æ³¨å†Œè¿™ä¸ªæœåŠ¡å°±å¯ä»¥äº†ï¼š constructor(private quoteService$: QuoteService) { this.quoteService$ .getQuote() .subscribe(q =&gt; this.quote = q); } æˆ‘ä»¬åœ¨ç»„ä»¶ä¸­æ³¨å†Œè¿™ä¸ªæœåŠ¡ä¹‹åï¼Œé€šè¿‡è®¢é˜…çš„æ–¹å¼è·å–åˆ°äº†æ•°æ®ï¼Œè¿™æ ·æ˜¯ä¸æ˜¯å¾ˆç®€å•ã€‚ æˆ‘ä»¬ä½¿ç”¨quoteService$è¿™æ ·çš„å†™æ³•æ˜¯å› ä¸ºï¼Œè¿™æ˜¯ä¸€ä¸ªæµï¼","tags":[{"name":"Rxjs","slug":"Rxjs","permalink":"http://tanyibing.com/tags/Rxjs/"},{"name":"Angular","slug":"Angular","permalink":"http://tanyibing.com/tags/Angular/"}]},{"title":"angularä¸­è‡ªå®šä¹‰è¡¨å•æ§ä»¶","date":"2018-09-28T15:51:23.000Z","path":"2018/09/28/angularä¸­è‡ªå®šä¹‰è¡¨å•æ§ä»¶/","text":"angularä¸­æœ‰ä¸¤ç§è¡¨å•ï¼Œä¸€ç§æ˜¯æ¨¡ç‰ˆé©±åŠ¨çš„è¡¨å•ï¼Œè¿˜æœ‰ä¸€ç§æ˜¯å“åº”å¼çš„è¡¨å•ã€‚å¦‚æœæˆ‘ä»¬çš„è¡¨å•æ¯”è¾ƒç®€å•çš„è¯æˆ‘ä»¬å¯ä»¥ä½¿ç”¨æ¨¡ç‰ˆé©±åŠ¨å‹è¡¨å•ï¼Œä½†æ˜¯ä¸€æ—¦æˆ‘ä¹ˆçš„è¡¨å•å¤æ‚èµ·æ¥ï¼Œé‚£ä¹ˆå“åº”å¼è¡¨å•æ˜¯æˆ‘ä»¬çš„é¦–é€‰ã€‚ ä½†æ˜¯ä¸€æ—¦æˆ‘ä»¬çš„è¡¨å•è¿‡äºå¤æ‚ä¹‹åï¼Œæˆ‘ä»¬å°±éœ€è¦å°†å¾ˆå¤šçš„é€»è¾‘å†™åœ¨ä¸€èµ·ï¼Œå¯¹äºæˆ‘ä»¬æ¥è¯´æ˜¯ä»¶å¾ˆç³Ÿç³•çš„äº‹æƒ…ï¼Œæ‰€ä»¥ï¼Œæˆ‘ä»¬éœ€è¦æŠŠå¤æ‚é—®é¢˜ç®€å•åŒ–ï¼Œå› æ­¤ï¼Œæˆ‘ä»¬å¯ä»¥è‡ªå®šä¹‰è¡¨å•æ§ä»¶ã€‚ æˆ‘éœ€è¦å®ç°ä¸€ä¸ªå¦‚ä¸‹çš„å¤´åƒé€‰æ‹©æ•ˆæœï¼š å¦‚æœå…‰æ˜¯æ·»åŠ å¤´åƒæˆ‘ä»¬å¯ä»¥ç›´æ¥å†™ï¼Œæ²¡å¿…è¦å†™æˆæ§ä»¶ï¼Œä½†æ˜¯ï¼Œæˆ‘åœ¨ä¹‹åçš„é¡¹ç›®ä¸­å¯èƒ½ä¹Ÿæƒ³ç»™æˆ‘å…¶ä»–è¡¨å•æ·»åŠ å›¾ç‰‡ä¹Ÿå®ç°è¿™æ ·çš„åŠŸèƒ½ï¼Œé‚£æˆ‘å°±éœ€è¦å°è£…ä¸€ä¸‹ï¼Œæ–¹ä¾¿ä»¥åå¤ç”¨ã€‚ æˆ‘åœ¨æ­¤å°±å†™ä¸€äº›åˆ å‡åçš„ä»£ç ï¼Œç†æ¸…æ€è·¯ã€‚é¦–å…ˆæˆ‘ä»¬ç»™å‡ºæˆ‘ä»¬è‡ªå®šä¹‰è¡¨å•æ§ä»¶çš„æ¨¡æ¿ï¼š &lt;div&gt; &lt;mat-icon *ngIf=&quot;useSvgIcon else imgSelect&quot;&gt;&lt;/mat-icon&gt; &lt;ng-template #imgSelect&gt; &lt;img [src]=&quot;selected&quot; alt=&quot;image selected&quot;&gt; &lt;/ng-template&gt; &lt;/div&gt; &lt;div class=&quot;scroll-container&quot;&gt; &lt;mat-grid-list&gt; &lt;mat-grid-tile *ngFor=&quot;let item of items&quot;&gt; &lt;div class=&quot;image-container&quot;&gt; &lt;mat-icon [svgIcon]=&quot;item&quot; *ngIf=&quot;useSvgIcon else imgItem&quot;&gt;&lt;/mat-icon&gt; &lt;ng-template #imgItem&gt; &lt;img [src]=&quot;item&quot; alt=&quot;image item&quot;&gt; &lt;/ng-template&gt; &lt;/mat-grid-tile&gt; &lt;/div&gt; ç¬¬ä¸€ä¸ªdivæ˜¯æˆ‘ä»¬å±•ç¤ºé€‰ä¸­çš„ï¼Œä¸‹é¢çš„æ˜¯å±•ç¤ºæ‰€æœ‰å¤´åƒï¼Œä½¿ç”¨çš„æ˜¯materialä¸­çš„gridlistã€‚ æˆ‘ä»¬æƒ³è¦è‡ªå®šä¹‰è¡¨å•æ§ä»¶ï¼Œæœ€é‡è¦çš„å°±æ˜¯å®ç°ControlValueAccessoræ¥å£ï¼Œä¾‹å­å¦‚ä¸‹ï¼š import { Component, forwardRef } from &apos;@angular/core&apos;; import { ControlValueAccessor, NG_VALUE_ACCESSOR } from &apos;@angular/forms&apos;; @Component({ selector: &apos;app-image-list-select&apos;, templateUrl: &apos;./image-list-select.component.html&apos;, styleUrls: [&apos;./image-list-select.component.scss&apos;], providers: [ { provide: NG_VALUE_ACCESSOR, useExisting: forwardRef(() =&gt; ImageListSelectComponent), multi: true // å…è®¸ä»¤ç‰Œå¤šå¯¹ä¸€ } ] }) export class ImageListSelectComponent implements ControlValueAccessor { constructor() { } // è¿™é‡Œæ˜¯åšä¸€ä¸ªç©ºå‡½æ•°ä½“ï¼ŒçœŸæ­£ä½¿ç”¨çš„æ–¹æ³•åœ¨ registerOnChange ä¸­ // ç”±æ¡†æ¶æ³¨å†Œï¼Œç„¶åæˆ‘ä»¬ä½¿ç”¨å®ƒæŠŠå˜åŒ–å‘å›è¡¨å• // æ³¨æ„ï¼Œå’Œ EventEmitter å°½ç®¡å¾ˆåƒï¼Œä½†å‘é€å›çš„å¯¹è±¡ä¸åŒ private propagateChange = (_: any) =&gt; {}; // å†™å…¥æ§ä»¶å€¼ writeValue(obj: any): void {} // å½“è¡¨å•æ§ä»¶å€¼æ”¹å˜æ—¶ï¼Œå‡½æ•° fn ä¼šè¢«è°ƒç”¨ // è¿™ä¹Ÿæ˜¯æˆ‘ä»¬æŠŠå˜åŒ– emit å›è¡¨å•çš„æœºåˆ¶ registerOnChange(fn: any): void { this.propagateChange = fn; } // è¿™é‡Œæ²¡æœ‰ä½¿ç”¨ï¼Œç”¨äºæ³¨å†Œ touched çŠ¶æ€ registerOnTouched(fn: any): void {} setDisabledState?(isDisabled: boolean): void {} } è¦å®ç°ControlValueAccessoræ¥å£ï¼Œæˆ‘ä»¬å°±éœ€è¦å®ç°ä¸Šé¢å››ä¸­æ–¹æ³•ï¼Œåœ¨writeValueï¼Œæˆ‘ä»¬å°±èƒ½è·å–åˆ°æ§ä»¶ä¸­å€¼çš„å€¼ï¼Œç„¶åæˆ‘ä»¬é€šè¿‡private propagateChange = (_: any) =&gt; {};è¿™ä¸ªç±»ä¼¼äºEventEmitterçš„å‡½æ•°å°†å€¼æš´éœ²å‡ºå»ã€‚å·®ä¸å¤šå°±è¡Œäº†ã€‚ æƒ³è¦äº†è§£è¿™ä¸ªé¡¹ç›®çš„å¯ä»¥å»æˆ‘çš„githubä¸Šçœ‹æˆ‘çš„é¡¹ç›®ï¼šè¿™æ˜¯åœ°å€","tags":[{"name":"Angular","slug":"Angular","permalink":"http://tanyibing.com/tags/Angular/"},{"name":"Typescript","slug":"Typescript","permalink":"http://tanyibing.com/tags/Typescript/"},{"name":"Material","slug":"Material","permalink":"http://tanyibing.com/tags/Material/"}]},{"title":"angularä¸­å†™è‡ªå·±çš„æŒ‡ä»¤","date":"2018-09-27T15:23:39.000Z","path":"2018/09/27/angularä¸­å†™è‡ªå·±çš„æŒ‡ä»¤/","text":"ä»Šå¤©æˆ‘ä»¬æƒ³å®ç°ä¸€ä¸ªç»„ä»¶æ‹–æ‹½çš„æ•ˆæœï¼Œä»¥æ–¹ä¾¿ä»¥åå¯ä»¥é€šè¿‡æ‹–æ‹½æ¥åˆ‡æ¢æˆ‘ä»¬ç»„ä»¶çš„ä½ç½®ã€‚æ‰€ä»¥ï¼Œæˆ‘ä»¬éœ€è¦è®¾è®¡è‡ªå·±çš„æŒ‡ä»¤Directiveã€‚ åœ¨angularä¸­æœ‰ä¸‰ç§æŒ‡ä»¤ï¼š ç»„ä»¶ â€” æ‹¥æœ‰æ¨¡æ¿çš„æŒ‡ä»¤ ç»“æ„å‹æŒ‡ä»¤ â€” é€šè¿‡æ·»åŠ å’Œç§»é™¤ DOM å…ƒç´ æ”¹å˜ DOM å¸ƒå±€çš„æŒ‡ä»¤ å±æ€§å‹æŒ‡ä»¤ â€” æ”¹å˜å…ƒç´ ã€ç»„ä»¶æˆ–å…¶å®ƒæŒ‡ä»¤çš„å¤–è§‚å’Œè¡Œä¸ºçš„æŒ‡ä»¤ ç»„ä»¶æ˜¯è¿™ä¸‰ç§æŒ‡ä»¤ä¸­æœ€å¸¸ç”¨çš„ï¼Œè€Œç»“æ„å‹çš„æŒ‡ä»¤ä¼šæ”¹å˜ DOM ç»“æ„ï¼Œå»ºè®®æ˜¯ä¸ä½¿ç”¨ï¼Œä½†çœŸè¦ä½¿ç”¨ä¹‹å‰å¾—å¥½å¥½æ€è€ƒä¸‹ï¼Œå¦åˆ™å¯èƒ½ä¼šå¸¦æ¥ä¸€äº›ä¸å¥½çš„ç»“æœã€‚æˆ‘ä»¬ä»Šå¤©å°±ä½¿ç”¨å±æ€§å‹çš„æŒ‡ä»¤æ¥å®ç°æˆ‘ä»¬æƒ³è¦çš„ä¸œè¥¿å§ã€‚ ç›´æ¥ä¸Šä»£ç å§ï¼š import { Directive, Input, HostListener, ElementRef, Renderer2 } from &apos;@angular/core&apos;; import { DragDropService } from &apos;../drag-drop.service&apos;; @Directive({ selector: &apos;[app-draggable]&apos; }) export class DragDirective { private _isDraggable = false; @Input() draggedClass: string; @Input(&apos;app-draggable&apos;) set isDraggable(val: boolean) { this._isDraggable = val; this.rd.setAttribute(this.el.nativeElement, &apos;draggable&apos;, `${val}`); } get isDraggable() { return this._isDraggable; } constructor( private el: ElementRef, private rd: Renderer2 ) { } @HostListener(&apos;dragstart&apos;, [&apos;$event&apos;]) onDragStart(ev: Event) { if (this.el.nativeElement === ev.target) { this.rd.addClass(this.el.nativeElement, this.draggedClass); } } @HostListener(&apos;dragend&apos;, [&apos;$event&apos;]) onDragEnd(ev: Event) { if (this.el.nativeElement === ev.target) { this.rd.removeClass(this.el.nativeElement, this.draggedClass); } } } è¿™æ˜¯æˆ‘ä»¬çš„ dragDective,å½“ç„¶ä»£ç æ²¡æœ‰å†™å…¨ï¼Œæˆ‘ä»¬åªæ˜¯åˆ—ä¸€ä¸ªæ€è·¯ï¼Œé¦–å…ˆæˆ‘ä»¬å¯ä»¥ä½¿ç”¨angular-cliç›´æ¥ç”Ÿæˆä¸€ä¸ªæŒ‡ä»¤æ¨¡ç‰ˆï¼š ng g d xxx //xxxä»£è¡¨æŒ‡ä»¤çš„åç§° ç”Ÿæˆä¹‹åç›´æ¥å°±æœ‰äº†selectorï¼Œé‡Œé¢å°±æ˜¯æˆ‘ä»¬æŒ‡ä»¤çš„åç§°ï¼Œç„¶åæˆ‘ä»¬é€šè¿‡ç±»ä¼¼äº.netçš„è¯­æ³•æ¥è·å–ä¸‹è¿™ä¸ªæŒ‡ä»¤æ˜¯trueè¿˜æ˜¯falseï¼š @Input(&apos;app-draggable&apos;) set isDraggable(val: boolean) { this._isDraggable = val; this.rd.setAttribute(this.el.nativeElement, &apos;draggable&apos;, `${val}`); } get isDraggable() { return this._isDraggable; } è¿™æ ·æˆ‘ä»¬å°±å¯ä»¥åœ¨æˆ‘ä»¬çš„ç»„ä»¶æ¨¡æ¿ä¸­åŠ ä¸Šè¿™ä¸ªæŒ‡ä»¤äº†ï¼š &lt;app-task-list class=&quot;list-container&quot; app-droppable [app-draggable]=&quot;true&quot;//è¿™å°±æ˜¯æŒ‡ä»¤çš„ä½ç½® (dropped)=&quot;handleMove($event,list)&quot; *ngFor=&quot;let list of lists&quot; &gt; å¦‚æ­¤ä¸€æ¥å¯ä»¥è¯´æ˜¯å®Œæˆäº†æ·»åŠ ï¼Œä½†æ˜¯æˆ‘ä»¬çš„æŒ‡ä»¤å•¥éƒ½æ²¡æœ‰åšï¼Œæ‰€ä»¥ä¹Ÿå°±ä¸ä¼šæœ‰æ•ˆæœï¼Œæˆ‘ä»¬å¯ä»¥å‘ç°çš„æ˜¯ï¼Œæˆ‘ä»¬çš„æŒ‡ä»¤ä»£ç ä¸­å‡ºç°å¾ˆå¤š@HostListenerï¼Œæ²¡é”™ï¼Œè¿™å°±æ˜¯æˆ‘ä»¬ç›‘å¬é¼ æ ‡äº‹ä»¶çš„æ–¹æ³•ï¼Œé€šè¿‡å“åº”äº‹ä»¶æ¥è¿›è¡Œä¸€ç³»åˆ—æ ·å¼çš„æ·»åŠ ï¼š @HostListener(&apos;dragstart&apos;, [&apos;$event&apos;]) onDragStart(ev: Event) { if (this.el.nativeElement === ev.target) { this.rd.addClass(this.el.nativeElement, this.draggedClass); } } @HostListener(&apos;dragend&apos;, [&apos;$event&apos;]) onDragEnd(ev: Event) { if (this.el.nativeElement === ev.target) { this.rd.removeClass(this.el.nativeElement, this.draggedClass); } } é‚£è¿™ä¸ªå…¶ä¸­çš„draggedClasså°±æ˜¯æˆ‘ä»¬è‡ªå·±å®šä¹‰çš„æ ·å¼ï¼Œæˆ‘ä»¬çš„é¼ æ ‡è¿›è¡Œæ‹–æ‹½çš„æ—¶å€™å°±èƒ½æ˜¾ç¤ºæˆ‘ä»¬çš„æ ·å¼ã€‚ ä»¥ä¸Šåªæ˜¯é¡¹ç›®ä¸­çš„ä¸€å°å—ä»£ç ï¼Œæ„Ÿå…´è¶£çš„å¯ä»¥å»æˆ‘çš„Githubä¸Šçœ‹çœ‹å“¦ï¼šè¿™æ˜¯åœ°å€","tags":[{"name":"Angular","slug":"Angular","permalink":"http://tanyibing.com/tags/Angular/"},{"name":"Typescript","slug":"Typescript","permalink":"http://tanyibing.com/tags/Typescript/"}]},{"title":"materialä¸­æ€ä¹ˆè®©ä¸»é¢˜è¦†ç›–dialogè¿™ä¸€ç±»ç»„ä»¶","date":"2018-09-26T14:13:15.000Z","path":"2018/09/26/materialä¸­æ€ä¹ˆè®©ä¸»é¢˜è¦†ç›–dialogè¿™ä¸€ç±»ç»„ä»¶/","text":"åœ¨materialä¸­å¾ˆå¤§ä¸€ä¸ªç‰¹è‰²å°±æ˜¯æˆ‘ä»¬å¯ä»¥æ ¹æ®è‡ªå·±çš„éœ€æ±‚è‡ªå®šä¹‰è‡ªå·±æƒ³è¦çš„ä¸»é¢˜ï¼Œæˆ‘å°±å¤§æ¦‚è®²è®²æ€ä¹ˆè‡ªå®šä¹‰å§ï¼Œå› ä¸ºæˆ‘çš„é‡ç‚¹æ˜¯æ€ä¹ˆè®©ä¸»é¢˜è¦†ç›–ä¸€äº›ç»„ä»¶ã€‚ æ€ä¹ˆè‡ªå®šä¹‰ä¸»é¢˜å‘¢ï¼Ÿæˆ‘è‡ªå·±å†™äº†ä¸€ä¸ªtheme.scssæ–‡ä»¶ï¼Œä»£ç å¦‚ä¸‹ï¼š é¦–å…ˆå¯¼å…¥ mat-coreï¼ˆï¼‰ sass æ··åˆã€‚è¿™åŒ…æ‹¬å¤šä¸ªç»„ä»¶ä½¿ç”¨çš„æ‰€æœ‰å¸¸è§æ ·å¼ã€‚è¿™åº”è¯¥åªåœ¨ä½ çš„åº”ç”¨ç¨‹åºä¸­åŒ…å«ä¸€æ¬¡ã€‚å¦‚æœè¿™ä¸ªmixinåŒ…å«å¤šæ¬¡ï¼Œä½ çš„åº”ç”¨ç¨‹åºå°†æœ€ç»ˆå¾—åˆ°è¿™äº›å¸¸ç”¨æ ·å¼çš„å¤šä¸ªå‰¯æœ¬ã€‚å°†ä¸»é¢˜æ•°æ®ç»“æ„å®šä¹‰ä¸ºå¤šä¸ªè°ƒè‰²æ¿çš„ç»„åˆã€‚å¯ä»¥ä½¿ç”¨ mat-light-theme æ–¹æ³•æˆ– mat-dark-theme æ–¹æ³•åˆ›å»ºæ­¤å¯¹è±¡ã€‚ç„¶åå°†æ–¹æ³•çš„è¾“å‡ºä¼ é€’ç»™ angular-material-theme æ··åˆï¼Œå®ƒå°†è¾“å‡ºä¸»é¢˜çš„æ‰€æœ‰å¯¹åº”æ ·å¼ã€‚ ç„¶åæˆ‘ä»¬éœ€è¦åœ¨style.scsså…¨å±€æ ·å¼ä¸‹å¼•å…¥è¿™ä¸ªæ–‡ä»¶ï¼Œè¿™æ ·å°±å¯ä»¥è‡ªç”±ä½¿ç”¨äº†ã€‚ ä½†æ˜¯æˆ‘ä»¬å‘ç°ï¼Œä¾‹å¦‚dialogè¿™äº›ç»„ä»¶æ— æ³•æ¸²æŸ“è‡ªå®šä¹‰çš„ä¸»é¢˜ï¼Œæˆ‘ä»¬è¯¥æ€ä¹ˆè§£å†³å‘¢ï¼Ÿå…¶å®ä¹Ÿå¾ˆç®€å•ï¼Œæˆ‘ä»¬åªéœ€è¦åœ¨æœ€å¤–å±‚çš„å®¹å™¨ä¸ŠåŠ ä¸Šä¸€å¥è¯ï¼š è¿™æ ·ä¹‹åå°±å¤§åŠŸå‘Šæˆäº†ï¼Œæˆ‘ä»¬åŸå…ˆçš„æ˜¯èƒŒæ™¯æœ‰é»‘å¤œä¸»é¢˜ï¼Œä½†æ˜¯dialogæ²¡æœ‰ä¸»é¢˜ï¼Œç„¶åå°±æˆåŠŸçš„ç»™dialogä¹ŸåŠ ä¸Šäº†ä¸»é¢˜ã€‚ ä¸Šé¢æ˜¯æ²¡æœ‰ä¸»é¢˜çš„æ ·å­ï¼ŒèƒŒæ™¯æ˜¯é»‘çš„ï¼Œdialogæ˜¯ç™½çš„ï¼Œä¸åè°ƒã€‚æ¥ä¸‹æ¥çœ‹çœ‹å®Œæˆä¹‹åçš„; ä½†æ˜¯è¿™æ ·åšæˆ‘ä»¬åœ¨é¡¹ç›®ä¸€å¼€å§‹å°±å®šæ­»äº†æˆ‘ä»¬åªèƒ½ç”¨é»‘å¤œæ¨¡å¼ï¼Œæˆ‘ä»¬éœ€è¦åœ¨ç‚¹å‡»ä¸€ä¸ªæŒ‰é’®çš„æ—¶å€™åˆ‡æ¢é¢œè‰²æ€ä¹ˆåŠå‘¢ï¼Œå¥½è¯´ï¼Œæˆ‘ä»¬æŠŠå®ƒæ”¾åˆ°è·Ÿç»„ä»¶é‡Œé¢çš„ä¸€ä¸ªæŒ‰é’®äº‹ä»¶é‡Œä¸å°±è¡Œäº†ï¼Œä»£ç å¦‚ä¸‹: è¿™ä¸‹æ˜¯çœŸçš„å½»åº•å®Œæˆäº†å“¦ï¼","tags":[{"name":"Angular","slug":"Angular","permalink":"http://tanyibing.com/tags/Angular/"},{"name":"Typescript","slug":"Typescript","permalink":"http://tanyibing.com/tags/Typescript/"},{"name":"Material","slug":"Material","permalink":"http://tanyibing.com/tags/Material/"}]},{"title":"materialä¸­æ€ä¹ˆä½¿ç”¨è‡ªå·±ä¸‹è½½çš„svgå›¾æ ‡","date":"2018-09-21T06:37:43.000Z","path":"2018/09/21/materialä¸­æ€ä¹ˆä½¿ç”¨è‡ªå·±ä¸‹è½½çš„svgå›¾æ ‡/","text":"materialæ˜¯è°·æ­Œå¼€å‘çš„å¾ˆå¥½çœ‹çš„ä¸€ä¸ªæ¡†æ¶ï¼Œæˆ‘å°±åœ¨æˆ‘æœ€è¿‘çš„é¡¹ç›®ä¸­ä½¿ç”¨äº†è¿™ä¸ªæ¡†æ¶ï¼Œå–œæ¬¢çš„ç«¥é‹å¯ä»¥å»ä»–ä»¬çš„å®˜ç½‘çœ‹çœ‹ï¼šmaterial.io å¼€å‘è¿‡ç¨‹ä¸­æˆ‘å‘ç°ä»–ä»¬çš„å›¾æ ‡åº“å’©æœ‰é˜¿é‡Œçš„é‚£ä¹ˆä¸°å¯Œï¼Œäºæ˜¯æƒ³ç”¨è‡ªå·±ä¸‹è½½çš„ï¼Œé‚£æˆ‘è¯¥æ€ä¹ˆæ“ä½œå‘¢ï¼Ÿï¼Œä¸‹é¢ä»‹ç»ä¸€ä¸‹æµç¨‹ã€‚ ä¸ºäº†æ–¹ä¾¿ï¼Œæˆ‘æ²¡æœ‰åœ¨éœ€è¦çš„æ¨¡å—ä¸­åå¤çš„æ·»åŠ ï¼Œè€Œæ˜¯åˆ›å»ºäº†ä¸€ä¸ªsvg.util.ts,å¹¶é€‰æ‹©åœ¨core moduleä¸­ä¸€æ¬¡æ€§åŠ è½½ï¼Œçœæ‰å¾ˆå¤šäº‹ã€‚é¦–å…ˆæˆ‘éœ€è¦åœ¨svg.util.tsä¸­å¼•å…¥å¿…é¡»çš„æ¨¡å—ï¼š è¿™ä¸¤ä¸ªæ¨¡å—æ˜¯æ ¸å¿ƒæ¨¡å—ï¼Œä¸€ä¸ªè´Ÿè´£æ³¨å†Œæ–°åŠ å…¥çš„svgå›¾æ ‡ï¼Œä¸€ä¸ªæ˜¯ä¸ºäº†é˜²æ­¢XSSæ¼æ´çš„å°†URLè®¾ä¸ºä¿¡ä»»å¯¹è±¡ã€‚ æ¥ä¸‹æ¥å°±å°†æˆ‘ä»¬çš„å›¾æ ‡éƒ½æ³¨å†Œè¿›å»ï¼š è¿™æ ·å­å·®ä¸å¤šå¿«å¯ä»¥äº†ï¼Œä½†æˆ‘ä»¬è¿˜éœ€è¦åœ¨core moduleä¸­å¼•å…¥HttpClientæ¨¡å—ï¼ˆè¿™ä¸€æ­¥å¿…é¡»è¦ï¼Œå¦åˆ™ä¼šæŠ¥é”™ï¼‰ï¼Œå› ä¸ºéœ€è¦ä¾èµ–å®ƒï¼Œæœ€ååœ¨core moduleçš„æ„é€ å‡½æ•°ä¸­è°ƒç”¨å°±è¡Œäº†ã€‚ ç„¶åæˆ‘ä»¬å°±èƒ½å…‰æ˜æ­£å¤§çš„ä½¿ç”¨å•¦ï¼š &lt;mat-icon svgIcon=&apos;æ³¨å†Œçš„åç§°&apos;&gt;&lt;/mat-icon&gt;","tags":[{"name":"Angular","slug":"Angular","permalink":"http://tanyibing.com/tags/Angular/"},{"name":"Typescript","slug":"Typescript","permalink":"http://tanyibing.com/tags/Typescript/"},{"name":"Material","slug":"Material","permalink":"http://tanyibing.com/tags/Material/"}]},{"title":"å°é²œIonic4ä¸­ç‚¹å‡»è·³è½¬æ–°é¡µé¢","date":"2018-09-20T03:15:48.000Z","path":"2018/09/20/å°é²œIonic4ä¸­ç‚¹å‡»è·³è½¬æ–°é¡µé¢/","text":"Ionicå·²ç»å‡ºäº†ç¬¬å››ç‰ˆäº†ï¼Œä¸è¿‡è¿˜åœ¨æµ‹è¯•é˜¶æ®µï¼Œé‚£æˆ‘ä»¬å…ˆæ¥ç©ç©å§ã€‚ é¦–å…ˆæˆ‘ä»¬ç”¨å‘½ä»¤è¡Œæ–°å»ºä¸€ä¸ªé¡µé¢newsï¼Œæˆ‘ä»¬å‘ç°ï¼Œè¿™ä¸€ç‰ˆä¸­ï¼Œæ–°å»ºçš„pageè¢«ç›´æ¥åŠ å…¥åˆ°äº†è·¯ç”±å½“ä¸­ï¼š ä¹Ÿå°±æ˜¯è¯´æˆ‘ä»¬å¯ä»¥ç›´æ¥ä½¿ç”¨è·¯ç”±è·³è½¬ï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬åœ¨homeé¡µé¢ä¸­åŠ ä¸€ä¸ªæŒ‰é’®ï¼Œå¹¶ä¸”ç»™å®ƒä¸ªç‚¹å‡»äº‹ä»¶ï¼š æ­¤æ—¶æˆ‘ä»¬åˆ°home.page.tsä¸­å»å®šä¹‰è¿™ä¸ªgoNews()æ–¹æ³•ã€‚æˆ‘ä»¬æ‰‹ä¸‹éœ€è¦åœ¨æ„é€ å‡½æ•°é‡Œé¢æ³¨å†ŒNavControllerï¼Œä½†æ˜¯æˆ‘æ¥ä¸‹æ¥å‘ç°ï¼Œè¿™ä¸ªç±»çš„pushæ–¹æ³•æ²¡å®šä¹‰ï¼Œé‚£æˆ‘ä»¬å»çœ‹ä¸‹æºç ï¼š æœç„¶æ˜¯æ²¡æœ‰pushæ–¹æ³•äº†ï¼Œä½†æ˜¯æœ‰ä¸ªnavigateForwardæ–¹æ³•å¥½åƒæœ‰é‚£ä¹ˆç‚¹æ„æ€ï¼Œè¯•è¯•å§ï¼š æœç„¶å¦‚æ­¤ï¼Œæ²¡é—®é¢˜ï¼Œç°åœ¨æˆ‘ä»¬å°±èƒ½å¤Ÿè·³è½¬å•¦ã€‚ å®˜ç½‘æ–‡æ¡£ç°åœ¨è¿˜ä¸æ˜¯å†™çš„å¾ˆæ¸…æ¥šï¼Œæƒ³è¦æ­£å¸¸ä½¿ç”¨è¿˜æ˜¯è¦æŸ¥æŸ¥æºç ã€‚","tags":[{"name":"Angular","slug":"Angular","permalink":"http://tanyibing.com/tags/Angular/"},{"name":"Typescript","slug":"Typescript","permalink":"http://tanyibing.com/tags/Typescript/"},{"name":"Ionic4","slug":"Ionic4","permalink":"http://tanyibing.com/tags/Ionic4/"}]},{"title":"exportså’Œmodule.exportsçš„åŒºåˆ«","date":"2018-09-19T01:35:45.000Z","path":"2018/09/19/exportså’Œmodule-exportsçš„åŒºåˆ«/","text":"exportså’Œmoduls.exportsçš„åŒºåˆ«æ¯ä¸€ä¸ªnode.jsæ‰§è¡Œæ–‡ä»¶ï¼Œéƒ½ä¼šè‡ªåŠ¨åˆ›å»ºä¸€ä¸ªmoduleå¯¹è±¡ï¼ŒåŒæ—¶ï¼Œmoduleå¯¹è±¡ä¼šåˆ›å»ºä¸€ä¸ªå«exportsçš„å±æ€§ï¼Œåˆå§‹åŒ–çš„å€¼æ˜¯{}ï¼š module.exports = {}; è¿™æ—¶æˆ‘ä»¬ä½¿ç”¨exportsçœ‹çœ‹ï¼š math.js exports.add=function(arg1,arg2){ return arg1+arg2; }; exports.minus=function(arg1,arg2){ return arg1-arg2; }; console.log(module); test.js var math=require(&apos;./math.js&apos;); console.log(&apos;math:&apos;+math); console.log(math.add(3,4)); console.log(math.minus(5,3)); æ§åˆ¶å°ä¸­ä¿¡æ¯:module: { id: &apos;/home/chander-zhang/NodeJS/test/math.js&apos;, exports: { add: [Function], minus: [Function] }, parent: { ... }, filename: &apos;/home/chander-zhang/NodeJS/test/math.js&apos;, loaded: false, children: [], paths: [ &apos;/home/chander-zhang/NodeJS/test/node_modules&apos;, &apos;/home/chander-zhang/NodeJS/node_modules&apos;, &apos;/home/chander-zhang/node_modules&apos;, &apos;/home/node_modules&apos;, &apos;/node_modules&apos; ] } math: [object Object] è¿™æ—¶çš„mathæ˜¯ä¸ªå¯¹è±¡ï¼Œå½“æˆ‘ä»¬ä½¿ç”¨module.exportsæ—¶ä¼šæ€ä¹ˆæ ·ï¼š math.js exports.add=function(arg1,arg2){ return arg1+arg2; }; minus=function(arg1,arg2){ return arg1-arg2; }; module.exports=minus; console.log(module); test.js var math=require(&apos;./math.js&apos;); console.log(&apos;math:&apos;+math); //console.log(math.add(3,4)); console.log(math.minus(5,3));//ç›¸å½“äºæ‰§è¡Œäº† minus(5,3) æ§åˆ¶å°ä¸­æ‰“å°å‡ºï¼šã€module: { id: &apos;/home/chander-zhang/NodeJS/test/math.js&apos;, exports: [Function], parent: { ... }, filename: &apos;/home/chander-zhang/NodeJS/test/math.js&apos;, loaded: false, children: [], paths: [ &apos;/home/chander-zhang/NodeJS/test/node_modules&apos;, &apos;/home/chander-zhang/NodeJS/node_modules&apos;, &apos;/home/chander-zhang/node_modules&apos;, &apos;/home/node_modules&apos;, &apos;/node_modules&apos; ] } math: function (arg1,arg2){ return arg1-arg2; } å¦‚æœä½¿ç”¨math.add()æˆ–math.minus()å°†ä¼šå‡ºé”™,å› ä¸ºæ­¤æ—¶mathæ˜¯ä¸€ä¸ªå‡½æ•°. å³ä¾¿moduleä¸­å‡ºç°äº†exports.add,ç”±äºä¸ºmodule.exportsèµ‹äº†å€¼,ä¹Ÿä¸èƒ½ä½¿ç”¨math.add().å› ä¸ºexportsæ˜¯æŒ‡å‘module.exportsçš„å¼•ç”¨ï¼Œè€Œrequireï¼ˆï¼‰è¿”å›çš„æ˜¯module.exportsè€Œä¸æ˜¯exportsï¼Œå½“æˆ‘ä»¬è‡ªå·±å®šä¹‰module.exportsæ—¶å°±ä¼šè¦†ç›–è‡ªåŠ¨ç”Ÿæˆçš„moudle.exportsã€‚","tags":[{"name":"JavaScript","slug":"JavaScript","permalink":"http://tanyibing.com/tags/JavaScript/"},{"name":"Node","slug":"Node","permalink":"http://tanyibing.com/tags/Node/"}]},{"title":"javascriptå¼‚æ­¥ï¼ˆå››ï¼‰","date":"2018-09-18T02:56:41.000Z","path":"2018/09/18/javascriptå¼‚æ­¥ï¼ˆå››ï¼‰/","text":"JavaScriptå¼‚æ­¥ï¼ˆå››ï¼‰â€”â€”â€”â€”async &amp; awaitå‰é¢å·²ç»ä»‹ç»äº†Generatorï¼Œæˆ‘çš„å”¯ä¸€æ„Ÿè§‰å°±æ˜¯â€”â€”â€”â€”å­¦ä¹ æˆæœ¬çœŸç‰¹å–µçš„é«˜ï¼Œæˆ‘ä»¬ä»Šå¤©è¿˜è¦çœ‹ä¸€ä¸ªå¼‚æ­¥çš„ç»ˆæè§£å†³æ–¹æ¡ˆâ€”â€”â€”â€”async-awaitï¼Œè¿™å°±æ˜¯ES7è‡ªå·±å‚ç…§Generatorå°è£…çš„ï¼Œå…¶å®æ›´åƒæ˜¯Generatorçš„è¯­æ³•ç³–ã€‚ ES7ä¸­çš„async-awaitGeneratorå’Œasync-awaitå¯¹æ¯”æˆ‘ä»¬å…ˆæ¥ä¸€æ®µGeneratorçš„å¼‚æ­¥å¤„ç†ä»£ç ï¼š co(function* () { const r1 = yield readFilePromise(&apos;some1.json&apos;) console.log(r1) // æ‰“å°ç¬¬ 1 ä¸ªæ–‡ä»¶å†…å®¹ const r2 = yield readFilePromise(&apos;some2.json&apos;) console.log(r2) // æ‰“å°ç¬¬ 2 ä¸ªæ–‡ä»¶å†…å®¹ }) æ¥ç€çœ‹çœ‹ä½¿ç”¨async-awaitï¼Œå¯¹æ¯”ä¸€ä¸‹; const readFilePromise = Q.denodeify(fs.readFile) // å®šä¹‰ async å‡½æ•° const readFileAsync = async function () { const f1 = await readFilePromise(&apos;data1.json&apos;) const f2 = await readFilePromise(&apos;data2.json&apos;) console.log(&apos;data1.json&apos;, f1.toString()) console.log(&apos;data2.json&apos;, f2.toString()) return &apos;done&apos; // å…ˆå¿½ç•¥ï¼Œåé¢ä¼šè®²åˆ° } // æ‰§è¡Œ const result = readFileAsync() æˆ‘ä»¬å¯ä»¥æ¯”è¾ƒçœ‹å‡ºï¼Œasync functionä»£æ›¿äº†function* ï¼Œawaitä»£æ›¿äº†yieldï¼Œè€Œä¸”ä½¿ç”¨async-awaitä¸åœ¨ç”¨coè¿™ä¸ªç¬¬ä¸‰æ–¹åº“äº†ï¼Œç›´æ¥æ‰§è¡Œå³å¯ã€‚ ä½¿ç”¨async-awaitçš„å·®å¼‚ç¬¬ä¸€ï¼Œawaitåé¢ä¸èƒ½å†è·Ÿthunkå‡½æ•°ï¼Œè€Œå¿…é¡»è·Ÿä¸€ä¸ªPromiseå¯¹è±¡ï¼ˆå› æ­¤ï¼ŒPromiseæ‰æ˜¯å¼‚æ­¥çš„ç»ˆæè§£å†³æ–¹æ¡ˆå’Œæœªæ¥ï¼‰ã€‚è·Ÿå…¶ä»–ç±»å‹çš„æ•°æ®ä¹ŸOKï¼Œä½†æ˜¯ä¼šç›´æ¥åŒæ­¥æ‰§è¡Œï¼Œè€Œä¸æ˜¯å¼‚æ­¥ã€‚ ç¬¬äºŒï¼Œæ‰§è¡Œconst result = readFileAsync()è¿”å›çš„æ˜¯ä¸ªPromiseå¯¹è±¡ï¼Œè€Œä¸”ä¸Šé¢ä»£ç ä¸­çš„return â€˜doneâ€™ä¼šç›´æ¥è¢«ä¸‹é¢çš„thenå‡½æ•°æ¥æ”¶åˆ° result.then(data =&gt; { console.log(data) // done }) ç¬¬ä¸‰ï¼Œä»ä»£ç çš„æ˜“è¯»æ€§æ¥å°†ï¼Œasync-awaitæ›´åŠ æ˜“è¯»ç®€ä»‹ï¼Œä¹Ÿæ›´åŠ ç¬¦åˆä»£ç çš„è¯­æ„ã€‚è€Œä¸”è¿˜ä¸ç”¨å¼•ç”¨ç¬¬ä¸‰æ–¹åº“ï¼Œä¹Ÿæ— éœ€å­¦ä¹ Generatoré‚£ä¸€å †ä¸œè¥¿ï¼Œä½¿ç”¨æˆæœ¬éå¸¸ä½ã€‚ å› æ­¤ï¼Œå¦‚æœ ES7 æ­£å¼å‘å¸ƒäº†ä¹‹åï¼Œå¼ºçƒˆæ¨èä½¿ç”¨async-awaitã€‚ä½†æ˜¯ç°åœ¨å°šæœªæ­£å¼å‘å¸ƒï¼Œä»ç¨³å®šæ€§è€ƒè™‘ï¼Œè¿˜æ˜¯Generatoræ›´å¥½ä¸€äº›ã€‚ å¼‚æ­¥æ“ä½œä»£ç çš„æ¼”å˜å†ç¨‹æœ€åå†æ¥æ„Ÿå—ä¸‹ä»callbackåˆ°async-awaitçš„å†ç¨‹å§ã€‚ callbackæ–¹å¼fs.readFile(&apos;some1.json&apos;, (err, data) =&gt; { fs.readFile(&apos;some2.json&apos;, (err, data) =&gt; { fs.readFile(&apos;some3.json&apos;, (err, data) =&gt; { fs.readFile(&apos;some4.json&apos;, (err, data) =&gt; { }) }) }) }) Promiseæ–¹å¼readFilePromise(&apos;some1.json&apos;).then(data =&gt; { return readFilePromise(&apos;some2.json&apos;) }).then(data =&gt; { return readFilePromise(&apos;some3.json&apos;) }).then(data =&gt; { return readFilePromise(&apos;some4.json&apos;) }) Generatoræ–¹å¼co(function* () { const r1 = yield readFilePromise(&apos;some1.json&apos;) const r2 = yield readFilePromise(&apos;some2.json&apos;) const r3 = yield readFilePromise(&apos;some3.json&apos;) const r4 = yield readFilePromise(&apos;some4.json&apos;) }) async-awaitæ–¹å¼const readFileAsync = async function () { const f1 = await readFilePromise(&apos;data1.json&apos;) const f2 = await readFilePromise(&apos;data2.json&apos;) const f3 = await readFilePromise(&apos;data3.json&apos;) const f4 = await readFilePromise(&apos;data4.json&apos;) } åˆ°è¿™åŸºæœ¬å°±å®Œäº†ï¼Œå¦‚æœæœ‰çœ‹åˆ°å¥½æ–‡ç« ä»¥åå†è¡¥å……ï¼Œjså¼‚æ­¥æ¢ç´¢çš„ä»»åŠ¡ç®—æ˜¯ç»“æŸäº†ã€‚","tags":[{"name":"JavaScript","slug":"JavaScript","permalink":"http://tanyibing.com/tags/JavaScript/"}]},{"title":"javascriptå¼‚æ­¥ï¼ˆä¸‰ï¼‰","date":"2018-09-18T01:18:08.000Z","path":"2018/09/18/javascriptå¼‚æ­¥ï¼ˆä¸‰ï¼‰/","text":"JavaScriptå¼‚æ­¥ï¼ˆä¸‰ï¼‰â€”â€”â€”â€”Generatorä¸Šæ¬¡å·²ç»ä»‹ç»è¿‡ä¸€ç‚¹Generatorå¯¹è±¡çš„çŸ¥è¯†äº†ï¼Œè¿™æ¬¡å°±ç»§ç»­è¯´è¯´Generatorçš„åº”ç”¨å§ã€‚ Generatorçš„åº”ç”¨ä½¿ç”¨nextå’Œyieldä¼ é€’å‚æ•°æˆ‘ä»¬å·²ç»çŸ¥é“ï¼Œyieldå…·æœ‰è¿”å›æ•°æ®çš„åŠŸèƒ½ï¼Œå¦‚ä¸‹ä»£ç ã€‚yieldåé¢çš„æ•°æ®è¢«è¿”å›ï¼Œå­˜æ”¾åˆ°è¿”å›ç»“æœä¸­çš„valueå±æ€§ä¸­ã€‚è¿™ç®—æ˜¯ä¸€ä¸ªæ–¹å‘çš„å‚æ•°ä¼ é€’ã€‚ function* G() { yield 100 } const g = G() console.log( g.next() ) // {value: 100, done: false} è¿˜æœ‰å¦ä¸€ä¸ªæ–¹å‘çš„å‚æ•°ä¼ é€’ï¼Œå°±æ˜¯nextå‘yieldä¼ é€’ï¼Œå¦‚ä¸‹ï¼š function* G() { const a = yield 100 console.log(&apos;a&apos;, a) // a aaa const b = yield 200 console.log(&apos;b&apos;, b) // b bbb const c = yield 300 console.log(&apos;c&apos;, c) // c ccc } const g = G() g.next() // value: 100, done: false g.next(&apos;aaa&apos;) // value: 200, done: false g.next(&apos;bbb&apos;) // value: 300, done: false g.next(&apos;ccc&apos;) // value: undefined, done: true æˆ‘ä»¬çœ‹çœ‹ä¸Šé¢ä»£ç çš„æ‰§è¡Œè¿‡ç¨‹ï¼š æ‰§è¡Œç¬¬ä¸€ä¸ªg.next()æ—¶ï¼Œæœªä¼ é€’ä»»ä½•å‚æ•°ï¼Œè¿”å›çš„{value: 100, done: false}ï¼Œè¿™ä¸ªåº”è¯¥æ²¡æœ‰ç–‘é—® æ‰§è¡Œç¬¬äºŒä¸ªg.next(â€˜aaaâ€™)æ—¶ï¼Œä¼ é€’çš„å‚æ•°æ˜¯â€™aaaâ€™ï¼Œè¿™ä¸ªâ€™aaaâ€™å°±ä¼šè¢«èµ‹å€¼åˆ°Gå†…éƒ¨çš„aæ ‡é‡ä¸­ï¼Œç„¶åæ‰§è¡Œconsole.log(â€˜aâ€™, a)æ‰“å°å‡ºæ¥ï¼Œæœ€åè¿”å›{value: 200, done: false} æ‰§è¡Œç¬¬ä¸‰ä¸ªã€ç¬¬å››ä¸ªæ—¶ï¼Œé“ç†éƒ½æ˜¯å®Œå…¨ä¸€æ ·çš„ï¼Œå¤§å®¶è‡ªå·±æ‹ä¸€æ‹ã€‚ æœ‰ä¸€ä¸ªè¦ç‚¹éœ€è¦æ³¨æ„ï¼Œå°±g.next(â€˜aaaâ€™)æ˜¯å°†â€™aaaâ€™ä¼ é€’ç»™ä¸Šä¸€ä¸ªå·²ç»æ‰§è¡Œå®Œäº†çš„yieldè¯­å¥å‰é¢çš„å˜é‡ï¼Œè€Œä¸æ˜¯å³å°†æ‰§è¡Œçš„yieldå‰é¢çš„å˜é‡ã€‚ forâ€¦ofçš„åº”ç”¨forâ€¦ofæ˜¯Iteratorå¯¹è±¡çš„ä¸€ä¸ªç»å…¸æ“ä½œï¼Œæˆ‘ä»¬ä½¿ç”¨ä¸€ä¸ªæ–æ³¢é‚£å¥‘æ•°åˆ—æ¥çœ‹ä¸€çœ‹ï¼š function* fibonacci() { let [prev, curr] = [0, 1] for (;;) { [prev, curr] = [curr, prev + curr] // å°†ä¸­é—´å€¼é€šè¿‡ yield è¿”å›ï¼Œå¹¶ä¸”ä¿ç•™å‡½æ•°æ‰§è¡Œçš„çŠ¶æ€ï¼Œå› æ­¤å¯ä»¥éå¸¸ç®€å•çš„å®ç° fibonacci yield curr } } for (let n of fibonacci()) { if (n &gt; 1000) { break } console.log(n) } è¿™æ ·æˆ‘ä»¬å°±èƒ½æ‰¾åˆ°1000é‡Œé¢çš„æ–æ³¢é‚£å¥‘æ•°åˆ—äº†ã€‚ yield*åµŒå¥—Generatorå¦‚æœæˆ‘ä»¬æœ‰ä¸¤ä¸ªGeneratorï¼Œæˆ‘ä»¬æƒ³åœ¨ç¬¬ä¸€ä¸ªä¸­åŒ…å«ç¬¬äºŒä¸ªï¼š function* G1() { yield &apos;a&apos; yield* G2() // ä½¿ç”¨ yield* æ‰§è¡Œ G2() yield &apos;b&apos; } function* G2() { yield &apos;x&apos; yield &apos;y&apos; } for (let item of G1()) { console.log(item) } ä¹‹å‰å­¦è¿‡çš„yieldåé¢ä¼šæ¥ä¸€ä¸ªæ™®é€šçš„ JS å¯¹è±¡ï¼Œè€Œyield åé¢ä¼šæ¥ä¸€ä¸ªGeneratorï¼Œè€Œä¸”ä¼šæŠŠå®ƒå…¶ä¸­çš„yieldæŒ‰ç…§è§„åˆ™æ¥ä¸€æ­¥ä¸€æ­¥æ‰§è¡Œã€‚å¦‚æœæœ‰å¤šä¸ªGeneratorä¸²è”ä½¿ç”¨çš„è¯ï¼ˆä¾‹å¦‚Koaæºç ä¸­ï¼‰ï¼Œç”¨yieldæ¥æ“ä½œéå¸¸æ–¹ä¾¿ã€‚ Generatorä¸­çš„thiså¯¹äºä»¥ä¸‹è¿™ç§å†™æ³•ï¼Œå¤§å®¶å¯èƒ½ä¼šå’Œæ„é€ å‡½æ•°åˆ›å»ºå¯¹è±¡çš„å†™æ³•äº§ç”Ÿæ··æ·†ï¼Œè¿™é‡Œä¸€å®šè¦æ³¨æ„ â€”â€” Generator ä¸æ˜¯å‡½æ•°ï¼Œæ›´ä¸æ˜¯æ„é€ å‡½æ•° function* G() {} const g = G() è€Œä»¥ä¸‹è¿™ç§å†™æ³•ï¼Œæ›´åŠ ä¸ä¼šæˆåŠŸã€‚åªæœ‰æ„é€ å‡½æ•°æ‰ä¼šè¿™ä¹ˆç”¨ï¼Œæ„é€ å‡½æ•°è¿”å›çš„æ˜¯thisï¼Œè€ŒGeneratorè¿”å›çš„æ˜¯ä¸€ä¸ªIteratorå¯¹è±¡ã€‚å®Œå…¨æ˜¯ä¸¤ç äº‹ï¼Œåƒä¸‡ä¸è¦ææ··äº†ã€‚ function* G() { this.a = 10 } const g = G() console.log(g.a) // æŠ¥é”™ Thunkå‡½æ•°ä¸ºä»€ä¹ˆè¦è¯´è¯´Thunkå‡½æ•°å‘¢ï¼Œå› ä¸ºå®ƒå’ŒGeneratorå¤„ç†å¼‚æ­¥æ“ä½œè¿˜æ˜¯æœ‰å…³ç³»çš„ï¼Œæˆ‘ä»¬å…ˆçœ‹çœ‹ã€‚ æ™®é€šå¼‚æ­¥å‡½æ•°fs.readFile(&apos;data1.json&apos;, &apos;utf-8&apos;, (err, data) =&gt; { // è·å–æ–‡ä»¶å†…å®¹ }) è¿™ä¸ªæ™®é€šçš„nodeè¯»å–æ–‡ä»¶çš„å‡½æ•°ä¼ é€’äº†ä¸‰ä¸ªå‡½æ•°ï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬è¿›è¡Œä¸€ç‚¹æ”¹é€ ã€‚ å°è£…æˆThunkå‡½æ•°const thunk = function (fileName, codeType) { // è¿”å›ä¸€ä¸ªåªæ¥å— callback å‚æ•°çš„å‡½æ•° return function (callback) { fs.readFile(fileName, codeType, callback) } } const readFileThunk = thunk(&apos;data1.json&apos;, &apos;utf-8&apos;) readFileThunk((err, data) =&gt; { // è·å–æ–‡ä»¶å†…å®¹ }) ä»ä¸Šé¢çš„Thunkå‡½æ•°å¯ä»¥çœ‹å‡ºï¼Œæ‰§è¡Œconst readFileThunk = thunk(â€˜data1.jsonâ€™, â€˜utf-8â€™)è¿”å›çš„å…¶å®æ˜¯ä¸€ä¸ªå‡½æ•°ï¼ŒreadFileThunkè¿™ä¸ªå‡½æ•°ï¼Œåªæ¥å—ä¸€ä¸ªå‚æ•°ï¼Œè€Œä¸”è¿™ä¸ªå‚æ•°æ˜¯ä¸€ä¸ªcallbackå‡½æ•°ã€‚ ä½¿ç”¨thunkifyåº“ä¸Šé¢çš„ä»£ç å°è£…ä½¿æˆ‘ä»¬è‡ªå·±åšçš„ï¼Œä½†æˆ‘ä»¬ä¸éœ€è¦æ¯é‡åˆ°ä¸€ä¸ªæƒ…å†µå°±è‡ªå·±åšï¼Œæˆ‘ä»¬å¯ä»¥ç›´æ¥ä½¿ç”¨ç¬¬ä¸‰æ–¹çš„thunkifyå°±å¯ä»¥äº†ã€‚ onst thunk = thunkify(fs.readFile) const readFileThunk = thunk(&apos;data1.json&apos;, &apos;utf-8&apos;) readFileThunk((err, data) =&gt; { // è·å–æ–‡ä»¶å†…å®¹ }) Generatorå¼‚æ­¥æ“ä½œä¸Šæ¬¡æˆ‘ä»¬åªæ˜¯å¤§æ¦‚çš„è®²äº†è®²ï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬è¯¦ç»†çœ‹çœ‹Generatoræ˜¯å¦‚ä½•è¿›è¡Œå¼‚æ­¥æ“ä½œçš„ Generatorä¸­ä½¿ç”¨Thunkç›´æ¥çœ‹ä»£ç å§ const readFileThunk = thunkify(fs.readFile) const gen = function* () { const r1 = yield readFileThunk(&apos;data1.json&apos;) console.log(r1) const r2 = yield readFileThunk(&apos;data2.json&apos;) console.log(r2) } æŒ¨ä¸ªè¯»å–ä¸¤ä¸ªæ–‡ä»¶çš„å†…å®¹æ¥ç€ä¸Šé¢çš„ä»£ç ç»§ç»­å†™ï¼š const g = gen() // è¯•ç€æ‰“å° g.next() è¿™é‡Œä¸€å®šè¦æ˜ç™½ value æ˜¯ä¸€ä¸ª thunkå‡½æ•° ï¼Œå¦åˆ™ä¸‹é¢çš„ä»£ç ä½ éƒ½çœ‹ä¸æ‡‚ // console.log( g.next() ) // g.next() è¿”å› {{ value: thunkå‡½æ•°, done: false }} // ä¸‹ä¸€è¡Œä¸­ï¼Œg.next().value æ˜¯ä¸€ä¸ª thunk å‡½æ•°ï¼Œå®ƒéœ€è¦ä¸€ä¸ª callback å‡½æ•°ä½œä¸ºå‚æ•°ä¼ é€’è¿›å» g.next().value((err, data1) =&gt; { // è¿™é‡Œçš„ data1 è·å–çš„å°±æ˜¯ç¬¬ä¸€ä¸ªæ–‡ä»¶çš„å†…å®¹ã€‚ä¸‹ä¸€è¡Œä¸­ï¼Œg.next(data1) å¯ä»¥å°†æ•°æ®ä¼ é€’ç»™ä¸Šé¢çš„ r1 å˜é‡ï¼Œæ­¤å‰å·²ç»è®²è¿‡è¿™ç§å‚æ•°ä¼ é€’çš„å½¢å¼ // ä¸‹ä¸€è¡Œä¸­ï¼Œg.next(data1).value åˆæ˜¯ä¸€ä¸ª thunk å‡½æ•°ï¼Œå®ƒåˆéœ€è¦ä¸€ä¸ª callback å‡½æ•°ä½œä¸ºå‚æ•°ä¼ é€’è¿›å» g.next(data1).value((err, data2) =&gt; { // è¿™é‡Œçš„ data2 è·å–çš„æ˜¯ç¬¬äºŒä¸ªæ–‡ä»¶çš„å†…å®¹ï¼Œé€šè¿‡ g.next(data2) å°†æ•°æ®ä¼ é€’ä¸ªä¸Šé¢çš„ r2 å˜é‡ g.next(data2) }) }) ä»”ç»†çœ‹æœ›ä¸Šé¢çš„æ³¨é‡Šï¼Œä¹Ÿè®¸ä¼šæœ‰ä¸­æç„¶å¤§æ‚Ÿçš„æ„Ÿè§‰ï¼ŒåŸæ¥æ˜¯è¿™æ ·å­æŠŠå¼‚æ­¥å†™æˆåŒæ­¥çš„æ„Ÿè§‰ã€‚ è‡ªé©±åŠ¨æµç¨‹æ¥ä¸‹æ¥æˆ‘ä»¬åšä¸€ä¸ªè‡ªé©±åŠ¨çš„æµç¨‹ï¼Œå®šä¹‰å¥½Generatorçš„ä»£ç ä¹‹åï¼Œå°±è®©ä»–è‡ªåŠ¨æ‰§è¡Œï¼š // è‡ªåŠ¨æµç¨‹ç®¡ç†çš„å‡½æ•° function run(generator) { const g = generator() function next(err, data) { const result = g.next(data) // è¿”å› { value: thunkå‡½æ•°, done: ... } if (result.done) { // result.done è¡¨ç¤ºæ˜¯å¦ç»“æŸï¼Œå¦‚æœç»“æŸäº†é‚£å°± return ä½œç½¢ return } result.value(next) // result.value æ˜¯ä¸€ä¸ª thunk å‡½æ•°ï¼Œéœ€è¦ä¸€ä¸ª callback å‡½æ•°ä½œä¸ºå‚æ•°ï¼Œè€Œ next å°±æ˜¯ä¸€ä¸ª callback å½¢å¼çš„å‡½æ•° } next() // æ‰‹åŠ¨æ‰§è¡Œä»¥å¯åŠ¨ç¬¬ä¸€æ¬¡ next } // å®šä¹‰ Generator const readFileThunk = thunkify(fs.readFile) const gen = function* () { const r1 = yield readFileThunk(&apos;data1.json&apos;) console.log(r1.toString()) const r2 = yield readFileThunk(&apos;data2.json&apos;) console.log(r2.toString()) } // å¯åŠ¨æ‰§è¡Œ run(gen) æˆ‘ä»¬ç®€å•åˆ†æä¸‹ï¼š æœ€åä¸€è¡Œrun(gen)ä¹‹åï¼Œè¿›å…¥runå‡½æ•°å†…éƒ¨æ‰§è¡Œ å…ˆconst g = generator()åˆ›å»ºGeneratorå®ä¾‹ï¼Œç„¶åå®šä¹‰ä¸€ä¸ªnextæ–¹æ³•ï¼Œå¹¶ä¸”ç«‹å³æ‰§è¡Œnext() æ³¨æ„è¿™ä¸ªnextå‡½æ•°çš„å‚æ•°æ˜¯err, dataä¸¤ä¸ªï¼Œå’Œæˆ‘ä»¬fs.readFileç”¨åˆ°çš„callbackå‡½æ•°å½¢å¼å®Œå…¨ä¸€æ · ç¬¬ä¸€æ¬¡æ‰§è¡Œnextæ—¶ï¼Œä¼šæ‰§è¡Œconst result = g.next(data)ï¼Œè€Œg.next(data)è¿”å›çš„æ˜¯{ value: thunkå‡½æ•°, done: â€¦ }ï¼Œvalueæ˜¯ä¸€ä¸ªthunkå‡½æ•°ï¼Œdoneè¡¨ç¤ºæ˜¯å¦ç»“æŸ å¦‚æœdone: trueï¼Œé‚£å°±ç›´æ¥returnäº†ï¼Œå¦åˆ™ç»§ç»­è¿›è¡Œ result.valueæ˜¯ä¸€ä¸ªthunkå‡½æ•°ï¼Œéœ€è¦æ¥å—ä¸€ä¸ªcallbackå‡½æ•°ä½œä¸ºå‚æ•°ä¼ é€’è¿›å»ï¼Œå› æ­¤æ­£å¥½æŠŠnextç»™ä¼ é€’è¿›å»ï¼Œè®©nextä¸€ç›´è¢«æ‰§è¡Œä¸‹å» coåº“è¿™ä¸ªæµç¨‹æˆ‘ä»¬ä¹Ÿå¯ä»¥ä½¿ç”¨ç¬¬ä¸‰æ–¹çš„åº“coï¼Œç”¨Generatorçš„å·¥ç¨‹å¸ˆè‚¯å®šéƒ½è¦ç”¨coï¼Œä¸¤è€…å¤©ç”Ÿä¸€å¯¹ã€‚ // å®šä¹‰ Generator const readFileThunk = thunkify(fs.readFile) const gen = function* () { const r1 = yield readFileThunk(&apos;data1.json&apos;) console.log(r1.toString()) const r2 = yield readFileThunk(&apos;data2.json&apos;) console.log(r2.toString()) } const c = co(gen) è€Œä¸”const c = co(gen)è¿”å›çš„æ˜¯ä¸€ä¸ªPromiseå¯¹è±¡ï¼Œå¯ä»¥æ¥ç€è¿™ä¹ˆå†™ c.then(data =&gt; { console.log(&apos;ç»“æŸ&apos;) }) Koaä¸­ä½¿ç”¨GeneratorKoaç¬¬ä¸€ç‰ˆä¸­å¤§é‡ä½¿ç”¨äº†Generatorï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬å»çœ‹çœ‹æ€ä¹ˆä½¿ç”¨çš„ã€‚ Koaä¸­å¦‚ä½•ä½¿ç”¨Generatorkoa æ˜¯ä¸€ä¸ª web æ¡†æ¶ï¼Œå¤„ç† http è¯·æ±‚ï¼Œä½†æ˜¯è¿™é‡Œæˆ‘ä»¬ä¸å»ç®¡å®ƒå¦‚ä½•å¤„ç† http è¯·æ±‚ï¼Œè€Œæ˜¯ç›´æ¥å…³æ³¨å®ƒä½¿ç”¨Genertorçš„éƒ¨åˆ†â€”â€”â€”â€”ä¸­é—´ä»¶ã€‚ä¾‹å¦‚ï¼Œæˆ‘ä»¬ç°åœ¨è¦ç”¨ 3 ä¸ªGeneratorè¾“å‡º12345ï¼Œæˆ‘ä»¬å¦‚ä¸‹ä»£ç è¿™ä¹ˆå†™ã€‚ let info = &apos;&apos; function* g1() { info += &apos;1&apos; // æ‹¼æ¥ 1 yield* g2() // æ‹¼æ¥ 234 info += &apos;5&apos; // æ‹¼æ¥ 5 } function* g2() { info += &apos;2&apos; // æ‹¼æ¥ 2 yield* g3() // æ‹¼æ¥ 3 info += &apos;4&apos; // æ‹¼æ¥ 4 } function* g3() { info += &apos;3&apos; // æ‹¼æ¥ 3 } var g = g1() g.next() console.log(info) // 12345 ä½†æ˜¯å¦‚æœç”¨ koa çš„ ä¸­é—´ä»¶ çš„æ€è·¯æ¥åšï¼Œå°±éœ€è¦å¦‚ä¸‹è¿™ä¹ˆå†™ã€‚ app.use(function *(next){ this.body = &apos;1&apos;; yield next; this.body += &apos;5&apos;; console.log(this.body); }); app.use(function *(next){ this.body += &apos;2&apos;; yield next; this.body += &apos;4&apos;; }); app.use(function *(next){ this.body += &apos;3&apos;; }); æˆ‘ä»¬éœ€è¦æ³¨æ„å‡ ç‚¹ï¼š app.use()ä¸­ä¼ å…¥çš„æ¯ä¸€ä¸ªGeneratorå°±æ˜¯ä¸€ä¸ª ä¸­é—´ä»¶ï¼Œä¸­é—´ä»¶æŒ‰ç…§ä¼ å…¥çš„é¡ºåºæ’åˆ—ï¼Œé¡ºåºä¸èƒ½ä¹± æ¯ä¸ªä¸­é—´ä»¶å†…éƒ¨ï¼Œnextè¡¨ç¤ºä¸‹ä¸€ä¸ªä¸­é—´ä»¶ã€‚yield nextå°±æ˜¯å…ˆå°†ç¨‹åºæš‚åœï¼Œå…ˆå»æ‰§è¡Œä¸‹ä¸€ä¸ªä¸­é—´ä»¶ï¼Œç­‰nextè¢«æ‰§è¡Œå®Œä¹‹åï¼Œå†å›è¿‡å¤´æ¥æ‰§è¡Œå½“å‰ä»£ç çš„ä¸‹ä¸€è¡Œã€‚å› æ­¤ï¼Œkoa çš„ä¸­é—´ä»¶æ‰§è¡Œé¡ºåºæ˜¯ä¸€ç§æ´‹è‘±åœˆæ¨¡å‹ï¼Œä¸è¿‡è¿™é‡Œçœ‹ä¸æ‡‚ä¹Ÿæ²¡é—®é¢˜ã€‚ æ¯ä¸ªä¸­é—´ä»¶å†…éƒ¨ï¼Œthiså¯ä»¥å…±äº«å˜é‡ã€‚å³ç¬¬ä¸€ä¸ªä¸­é—´ä»¶æ”¹å˜äº†thisçš„å±æ€§ï¼Œåœ¨ç¬¬äºŒä¸ªä¸­é—´ä»¶ä¸­å¯ä»¥çœ‹åˆ°æ•ˆæœã€‚ Koaçš„è¿™ç§æœºåˆ¶å¦‚ä½•å®ç°çš„æˆ‘ä»¬å°ä½ä¸ªç®€å•çš„Koaï¼š class MyKoa extends Object { constructor(props) { super(props); // å­˜å‚¨æ‰€æœ‰çš„ä¸­é—´ä»¶ this.middlewares = [] } // æ³¨å…¥ä¸­é—´ä»¶ use (generator) { this.middlewares.push(generator) } // æ‰§è¡Œä¸­é—´ä»¶ listen () { this._run() } _run () { const ctx = this const middlewares = ctx.middlewares co(function* () { let prev = null let i = middlewares.length //ä»æœ€åä¸€ä¸ªä¸­é—´ä»¶åˆ°ç¬¬ä¸€ä¸ªä¸­é—´ä»¶çš„é¡ºåºå¼€å§‹éå† while (i--) { // ctx ä½œä¸ºå‡½æ•°æ‰§è¡Œæ—¶çš„ this æ‰èƒ½ä¿è¯å¤šä¸ªä¸­é—´ä»¶ä¸­æ•°æ®çš„å…±äº« //prev å°†å‰é¢ä¸€ä¸ªä¸­é—´ä»¶ä¼ é€’ç»™å½“å‰ä¸­é—´ä»¶ï¼Œæ‰ä½¿å¾—ä¸­é—´ä»¶é‡Œé¢çš„ next æŒ‡å‘ä¸‹ä¸€ä¸ªä¸­é—´ä»¶ prev = middlewares[i].call(ctx, prev); } //æ‰§è¡Œç¬¬ä¸€ä¸ªä¸­é—´ä»¶ yield prev; }) } } å¦‚ä½•ä½¿ç”¨å‘¢ï¼š var app = new MyKoa(); app.use(function *(next){ this.body = &apos;1&apos;; yield next; this.body += &apos;5&apos;; console.log(this.body); // 12345 }); app.use(function *(next){ this.body += &apos;2&apos;; yield next; this.body += &apos;4&apos;; }); app.use(function *(next){ this.body += &apos;3&apos;; }); app.listen();","tags":[{"name":"JavaScript","slug":"JavaScript","permalink":"http://tanyibing.com/tags/JavaScript/"}]},{"title":"javascriptå¼‚æ­¥ï¼ˆäºŒï¼‰","date":"2018-09-17T06:40:16.000Z","path":"2018/09/17/javascriptå¼‚æ­¥ï¼ˆäºŒï¼‰/","text":"JavaScriptå¼‚æ­¥ï¼ˆäºŒï¼‰â€”â€”â€”â€”PromiseES6ä¸­çš„Promiseå†™ä¸€ä¸ªä¼ ç»Ÿçš„å¼‚æ­¥æ“ä½œæˆ‘ä»¬å…ˆå†™ä¸€æ®µå¼‚æ­¥çš„ä»£ç ï¼Œç„¶åç”¨promiseæ¥å°è£…ä¸€ä¸‹ï¼š var wait = function () { var task = function () { console.log(&apos;æ‰§è¡Œå®Œæˆ&apos;) } setTimeout(task, 2000) } wait() ç”¨Promiseè¿›è¡Œå°è£…const wait = function () { // å®šä¹‰ä¸€ä¸ª promise å¯¹è±¡ const promise = new Promise((resolve, reject) =&gt; { // å°†ä¹‹å‰çš„å¼‚æ­¥æ“ä½œï¼ŒåŒ…æ‹¬åˆ°è¿™ä¸ª new Promise å‡½æ•°ä¹‹å†… const task = function () { console.log(&apos;æ‰§è¡Œå®Œæˆ&apos;) resolve() // callback ä¸­å»æ‰§è¡Œ resolve æˆ–è€… reject } setTimeout(task, 2000) }) // è¿”å› promise å¯¹è±¡ return promise } æˆ‘ä»¬é¦–å…ˆå°†ä¹‹å‰ä¼ ç»Ÿçš„å¼‚æ­¥æ–¹æ³•ç”¨new Promise((resolve, reject) =&gt; {...})åŒ…è£…èµ·æ¥ï¼Œç„¶åreturnå°±è¡Œäº†ã€‚å¼‚æ­¥æ“ä½œçš„å†…éƒ¨ï¼Œåœ¨callbackä¸­æ‰§è¡Œresolve()ï¼ˆè¡¨æ˜æˆåŠŸäº†ï¼Œå¤±è´¥çš„è¯æ‰§è¡Œrejectï¼‰ã€‚ æˆ‘ä»¬æ¥ä¸‹æ¥æ€ä¹ˆå¤„ç†è¿”å›çš„æ•°æ®å‘¢ï¼š const w = wait() w.then(() =&gt; { console.log(&apos;ok 1&apos;) }, () =&gt; { console.log(&apos;err 1&apos;) }).then(() =&gt; { console.log(&apos;ok 2&apos;) }, () =&gt; { console.log(&apos;err 2&apos;) }) æˆ‘ä»¬è°ƒç”¨thenæ–¹æ³•ï¼Œè¿™ä¸ªæ–¹æ³•æ¥æ”¶ä¸¤ä¸ªå‚æ•°ï¼Œç¬¬ä¸€ä¸ªåœ¨æˆåŠŸæ—¶ï¼ˆè§¦å‘resolveï¼‰æ‰§è¡Œï¼Œç¬¬äºŒä¸ªåœ¨å¤±è´¥æ—¶(è§¦å‘reject)æ—¶æ‰§è¡Œã€‚è€Œä¸”ï¼Œthenè¿˜å¯ä»¥è¿›è¡Œé“¾å¼æ“ä½œã€‚ ä»¥ä¸Šå°±æ˜¯ES6ä¸­Promiseçš„åŸºæœ¬ä½¿ç”¨æ–¹æ³•ï¼Œæ¥ä¸‹æ¥çœ‹ä¸€äº›Promiseçš„å¸¸è§ç”¨æ³•å§ã€‚ Promiseåœ¨ES6ä¸­çš„å¸¸è§ç”¨æ³•ä¸ºäº†æ–¹ä¾¿ä½¿ç”¨ï¼Œæˆ‘ä»¬é¦–å…ˆå°è£…ä¸ªPromiseï¼Œä¸ºåé¢ä½¿ç”¨ï¼š const fs = require(&apos;fs&apos;) const path = require(&apos;path&apos;) // åé¢è·å–æ–‡ä»¶è·¯å¾„æ—¶å€™ä¼šç”¨åˆ° const readFilePromise = function (fileName) { return new Promise((resolve, reject) =&gt; { fs.readFile(fileName, (err, data) =&gt; { if (err) { reject(err) // æ³¨æ„ï¼Œè¿™é‡Œæ‰§è¡Œ reject æ˜¯ä¼ é€’äº†å‚æ•°ï¼Œåé¢ä¼šæœ‰åœ°æ–¹æ¥æ”¶åˆ°è¿™ä¸ªå‚æ•° } else { resolve(data.toString()) // æ³¨æ„ï¼Œè¿™é‡Œæ‰§è¡Œ resolve æ—¶ä¼ é€’äº†å‚æ•°ï¼Œåé¢ä¼šæœ‰åœ°æ–¹æ¥æ”¶åˆ°è¿™ä¸ªå‚æ•° } }) }) } å‚æ•°ä¼ é€’æˆ‘ä»¬è¦ä½¿ç”¨ä¸Šé¢å°è£…çš„readFilePromiseè¯»å–ä¸€ä¸ª json æ–‡ä»¶../data/data2.jsonï¼Œè¿™ä¸ªæ–‡ä»¶å†…å®¹éå¸¸ç®€å•ï¼š{â€œaâ€:100, â€œbâ€:200} å…ˆå°†æ–‡ä»¶å†…å®¹æ‰“å°å‡ºæ¥ï¼Œä»£ç å¦‚ä¸‹ã€‚å¤§å®¶éœ€è¦æ³¨æ„ï¼ŒreadFilePromiseå‡½æ•°ä¸­ï¼Œæ‰§è¡Œresolve(data.toString())ä¼ é€’çš„å‚æ•°å†…å®¹ï¼Œä¼šè¢«ä¸‹é¢ä»£ç ä¸­çš„dataå‚æ•°æ‰€æ¥æ”¶åˆ°ã€‚ const fullFileName = path.resolve(__dirname, &apos;../data/data2.json&apos;) const result = readFilePromise(fullFileName) result.then(data =&gt; { console.log(data) }) å‚æ•°ä¼ é€’å°±æ˜¯åœ¨å¼‚æ­¥é‡Œé¢é€šè¿‡resolveæ¥ä¼ é€’è‡³ï¼Œç„¶åå°±ä¼šè¢«ç¬¬ä¸€ä¸ªthenå¤„ç†æ—¶æ¥æ”¶åˆ°ï¼Œè€Œä¸”é€šè¿‡thençš„é“¾å¼æ“ä½œå¯ä»¥ç»§ç»­å°†å¤„ç†åçš„å€¼ä¼ é€’ä¸‹å»ã€‚ å¼‚å¸¸æ•è·æˆ‘ä»¬çŸ¥é“thenä¼šæ¥æ”¶ä¸¤ä¸ªå‚æ•°ï¼ˆå‡½æ•°ï¼‰ï¼Œç¬¬ä¸€ä¸ªå‚æ•°ä¼šåœ¨æ‰§è¡Œresolveä¹‹åè§¦å‘ï¼ˆè¿˜èƒ½ä¼ é€’å‚æ•°ï¼‰ï¼Œç¬¬äºŒä¸ªå‚æ•°ä¼šåœ¨æ‰§è¡Œrejectä¹‹åè§¦å‘ï¼ˆå…¶å®ä¹Ÿå¯ä»¥ä¼ é€’å‚æ•°ï¼Œå’Œresolveä¼ é€’å‚æ•°ä¸€æ ·ï¼‰ï¼Œä½†æ˜¯ä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œæˆ‘ä»¬æ²¡æœ‰ç”¨åˆ°thençš„ç¬¬äºŒä¸ªå‚æ•°ã€‚è¿™æ˜¯ä¸ºä½•å‘¢ â€”â€”â€”â€” å› ä¸ºä¸å»ºè®®è¿™ä¹ˆç”¨ã€‚ å¯¹äºPromiseä¸­çš„å¼‚å¸¸å¤„ç†ï¼Œæˆ‘ä»¬å»ºè®®ç”¨catchæ–¹æ³•ï¼Œè€Œä¸æ˜¯thençš„ç¬¬äºŒä¸ªå‚æ•°ã€‚è¯·çœ‹ä¸‹é¢çš„ä»£ç ï¼Œä»¥åŠæ³¨é‡Šã€‚ const fullFileName = path.resolve(__dirname, &apos;../data/data2.json&apos;) const result = readFilePromise(fullFileName) result.then(data =&gt; { console.log(data) return JSON.parse(data).a }).then(a =&gt; { console.log(a) ).catch(err =&gt; { console.log(err.stack) // è¿™é‡Œçš„ catch å°±èƒ½æ•è· readFilePromise ä¸­è§¦å‘çš„ reject ï¼Œè€Œä¸”èƒ½æ¥æ”¶ reject ä¼ é€’çš„å‚æ•° }) åœ¨è‹¥å¹²ä¸ªthenä¸²è”ä¹‹åï¼Œæˆ‘ä»¬ä¸€èˆ¬ä¼šåœ¨æœ€åè·Ÿä¸€ä¸ª.catchæ¥æ•è·å¼‚å¸¸ï¼Œè€Œä¸”æ‰§è¡Œrejectæ—¶ä¼ é€’çš„å‚æ•°ä¹Ÿä¼šåœ¨catchä¸­è·å–åˆ°ã€‚è¿™æ ·åšçš„å¥½å¤„æ˜¯ï¼š è®©ç¨‹åºçœ‹èµ·æ¥æ›´åŠ ç®€æ´ï¼Œæ˜¯ä¸€ä¸ªä¸²è”çš„å…³ç³»ï¼Œæ²¡æœ‰åˆ†æ”¯ï¼ˆå¦‚æœç”¨thençš„ä¸¤ä¸ªå‚æ•°ï¼Œå°±ä¼šå‡ºç°åˆ†æ”¯ï¼Œå½±å“é˜…è¯»ï¼‰ æ›´åƒæ˜¯try - catchçš„æ ·å­ï¼Œæ›´æ˜“ç†è§£ ä¸²è”å¤šä¸ªå¼‚æ­¥æ“ä½œå¦‚æœç°åœ¨æœ‰ä¸€ä¸ªéœ€æ±‚ï¼šå…ˆè¯»å–data2.jsonçš„å†…å®¹ï¼Œå½“æˆåŠŸä¹‹åï¼Œå†å»è¯»å–data1.jsonã€‚è¿™æ ·çš„éœ€æ±‚ï¼Œå¦‚æœç”¨ä¼ ç»Ÿçš„callbackå»å®ç°ï¼Œä¼šå˜å¾—å¾ˆéº»çƒ¦ã€‚è€Œä¸”ï¼Œç°åœ¨åªæ˜¯ä¸¤ä¸ªæ–‡ä»¶ï¼Œå¦‚æœæ˜¯åå‡ ä¸ªæ–‡ä»¶è¿™æ ·åšï¼Œå†™å‡ºæ¥çš„ä»£ç å°±æ²¡æ³•çœ‹äº†ï¼ˆè‡­åæ˜­è‘—çš„callback-hellï¼‰ã€‚ä½†æ˜¯ç”¨åˆšåˆšå­¦åˆ°çš„Promiseå°±å¯ä»¥è½»æ¾èƒœä»»è¿™é¡¹å·¥ä½œï¼š const fullFileName2 = path.resolve(__dirname, &apos;../data/data2.json&apos;) const result2 = readFilePromise(fullFileName2) const fullFileName1 = path.resolve(__dirname, &apos;../data/data1.json&apos;) const result1 = readFilePromise(fullFileName1) result2.then(data =&gt; { console.log(&apos;data2.json&apos;, data) return result1 // æ­¤å¤„åªéœ€è¿”å›è¯»å– data1.json çš„ Promise å³å¯ }).then(data =&gt; { console.log(&apos;data1.json&apos;, data) // data å³å¯æ¥æ”¶åˆ° data1.json çš„å†…å®¹ }) ä¸Šæ–‡â€œå‚æ•°ä¼ é€’â€æåˆ°è¿‡ï¼Œå¦‚æœthenæœ‰é“¾å¼æ“ä½œï¼Œå‰é¢æ­¥éª¤è¿”å›çš„å€¼ï¼Œä¼šè¢«åé¢çš„æ­¥éª¤è·å–åˆ°ã€‚ä½†æ˜¯ï¼Œå¦‚æœå‰é¢æ­¥éª¤è¿”å›å€¼æ˜¯ä¸€ä¸ªPromiseçš„è¯ï¼Œæƒ…å†µå°±ä¸ä¸€æ ·äº†ã€‚å¦‚æœå‰é¢è¿”å›çš„æ˜¯Promiseå¯¹è±¡ï¼Œåé¢çš„thenå°†ä¼šè¢«å½“åšè¿™ä¸ªè¿”å›çš„Promiseçš„ç¬¬ä¸€ä¸ªthenæ¥å¯¹å¾…ã€‚ Promise.all &amp; Promise.raceç°åœ¨æˆ‘éœ€è¦ä¸€èµ·è¯»å–data1.jsonå’Œdata2.jsonè¿™ä¸¤ä¸ªæ–‡ä»¶ï¼Œç­‰å¾…å®ƒä»¬å…¨éƒ¨éƒ½è¢«è¯»å–å®Œï¼Œå†åšä¸‹ä¸€æ­¥çš„æ“ä½œã€‚æ­¤æ—¶éœ€è¦ç”¨åˆ°Promise.allï¼š // Promise.all æ¥æ”¶ä¸€ä¸ªåŒ…å«å¤šä¸ª promise å¯¹è±¡çš„æ•°ç»„ Promise.all([result1, result2]).then(datas =&gt; { // æ¥æ”¶åˆ°çš„ datas æ˜¯ä¸€ä¸ªæ•°ç»„ï¼Œä¾æ¬¡åŒ…å«äº†å¤šä¸ª promise è¿”å›çš„å†…å®¹ console.log(datas[0]) console.log(datas[1]) }) è¯»å–ä¸¤ä¸ªæ–‡ä»¶data1.jsonå’Œdata2.jsonï¼Œç°åœ¨æˆ‘éœ€è¦ä¸€èµ·è¯»å–è¿™ä¸¤ä¸ªæ–‡ä»¶ï¼Œä½†æ˜¯åªè¦æœ‰ä¸€ä¸ªå·²ç»è¯»å–äº†ï¼Œå°±å¯ä»¥è¿›è¡Œä¸‹ä¸€æ­¥çš„æ“ä½œã€‚æ­¤æ—¶éœ€è¦ç”¨åˆ°Promise.raceï¼š // Promise.race æ¥æ”¶ä¸€ä¸ªåŒ…å«å¤šä¸ª promise å¯¹è±¡çš„æ•°ç»„ Promise.race([result1, result2]).then(data =&gt; { // data å³æœ€å…ˆæ‰§è¡Œå®Œæˆçš„ promise çš„è¿”å›å€¼ console.log(data) })","tags":[{"name":"JavaScript","slug":"JavaScript","permalink":"http://tanyibing.com/tags/JavaScript/"}]},{"title":"nodeä¸­è¸©çš„å‘ï¼ˆä¸å®šæ—¶æ›´æ–°ï¼‰","date":"2018-09-14T09:02:35.000Z","path":"2018/09/14/nodeä¸­è¸©çš„å‘ï¼ˆä¸å®šæ—¶æ›´æ–°ï¼‰/","text":"2018-9-14é—®é¢˜åœ¨Koaä¸­æƒ³è¦ä½¿ç”¨art-templateè¿™ä¸ªæ¨¡æ¿å¼•æ“ï¼Œä½†æ˜¯ä½¿ç”¨ä¹‹ååœ¨æ¸²æŸ“æ¨¡æ¿çš„æ—¶å€™ä¸€ç›´æŠ¥ä¸‹é¢çš„é”™ï¼š åˆ†ææŠ¥çš„é”™è¯´æˆ‘çš„è·¯å¾„å¿…é¡»ä¸ºä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œæˆ‘é‡æ–°æ£€æŸ¥åï¼Œå‘ç°å¹¶ä¸å­˜åœ¨è¯­æ³•é”™è¯¯å‘€ï¼Œæœæ–­å»åº¦å¨˜çœ‹çœ‹ï¼Œè¯•äº†å‡ ä¸ªæ–¹æ³•è§£å†³ä¸äº†æˆ‘çš„é—®é¢˜ï¼Œä½†æ˜¯åé¦ˆæœ€å¤šçš„ä¸€ä¸ªæ–¹æ³•å°±æ˜¯nodeç‰ˆæœ¬å’Œå…¶ä»–çš„ä¸å…¼å®¹ã€‚æˆ‘é ï¼è¿™è¦é‡æå·¥ä½œé‡æœ‰ç‚¹å¤§ï¼Œæœæ–­æ¢ä¸ªæ¨¡æ¿å¼•æ“å§ã€‚ è§£å†³æ–¹æ³•æœ€åå›å»å®˜ç½‘çœ‹ä¸€çœ‹ï¼Œå‘ç°æœ‰art-templateå’Œkoa-art-templateä¹‹åˆ†ï¼Œä½†æ˜¯é…ç½®å¥½åƒæ²¡å•¥åŒºåˆ«å•Šã€‚æŠŠå¼•å…¥çš„æ¨¡å—æ”¹æˆkoa-art-templateï¼Œå†è¯•è¯•ï¼Œæˆäº†ï¼ä»€ä¹ˆé¬¼ï¼ä¸ç®¡äº†ï¼Œé—®é¢˜æš‚æ—¶æ˜¯è§£å†³äº†ã€‚ å¦å¤–é™„ä¸Šé¡¹ç›®çš„åœ°å€ï¼šhttps://github.com/TanYiBing/cms_demo","tags":[{"name":"Node","slug":"Node","permalink":"http://tanyibing.com/tags/Node/"},{"name":"Koa","slug":"Koa","permalink":"http://tanyibing.com/tags/Koa/"}]},{"title":"javascriptå¼‚æ­¥ï¼ˆä¸€ï¼‰","date":"2018-09-14T08:06:01.000Z","path":"2018/09/14/javascriptå¼‚æ­¥ï¼ˆä¸€ï¼‰/","text":"JavaScriptå¼‚æ­¥ï¼ˆä¸€ï¼‰å‰è¨€æ˜¨å¤©åˆšç«‹äº†ä¸ªflagï¼Œè€Œæˆ‘è¿™ä¸ªäººå‘æ¥éƒ½æ˜¯è¯´è¯ä¸ç®—è¯çš„ï¼ˆæ‰‹åŠ¨æ»‘ç¨½ï¼‰ï¼Œä¸ºäº†é˜²æ­¢è‡ªå·±åŠé€”è€ŒåºŸï¼Œæ‰€ä»¥ä»Šå¤©å…ˆæ¥å¼€ä¸ªå¤´ï¼Œå¼€äº†å¤´å°±ä¸å¥½å›å¤´äº†ã€‚ å¼‚æ­¥å’Œå•çº¿ç¨‹æœ‰ä»€ä¹ˆå…³ç³»ï¼Ÿ1.ä¸ºå•¥æ˜¯å•çº¿ç¨‹JavaScript è¯­è¨€çš„ä¸€å¤§ç‰¹ç‚¹å°±æ˜¯å•çº¿ç¨‹ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼ŒåŒä¸€ä¸ªæ—¶é—´åªèƒ½åšä¸€ä»¶äº‹ã€‚é‚£ä¹ˆï¼Œä¸ºä»€ä¹ˆJavaScriptä¸èƒ½æœ‰å¤šä¸ªçº¿ç¨‹å‘¢ï¼Ÿè¿™æ ·èƒ½æé«˜æ•ˆç‡å•Šã€‚ JavaScript çš„å•çº¿ç¨‹ï¼Œä¸å®ƒçš„ç”¨é€”æœ‰å…³ã€‚ä½œä¸ºæµè§ˆå™¨è„šæœ¬è¯­è¨€ï¼ŒJavaScript çš„ä¸»è¦ç”¨é€”æ˜¯ä¸ç”¨æˆ·äº’åŠ¨ï¼Œä»¥åŠæ“ä½œDOMã€‚è¿™å†³å®šäº†å®ƒåªèƒ½æ˜¯å•çº¿ç¨‹ï¼Œå¦åˆ™ä¼šå¸¦æ¥å¾ˆå¤æ‚çš„åŒæ­¥é—®é¢˜ã€‚æ¯”å¦‚ï¼Œå‡å®šJavaScriptåŒæ—¶æœ‰ä¸¤ä¸ªçº¿ç¨‹ï¼Œä¸€ä¸ªçº¿ç¨‹åœ¨æŸä¸ªDOMèŠ‚ç‚¹ä¸Šæ·»åŠ å†…å®¹ï¼Œå¦ä¸€ä¸ªçº¿ç¨‹åˆ é™¤äº†è¿™ä¸ªèŠ‚ç‚¹ï¼Œè¿™æ—¶æµè§ˆå™¨åº”è¯¥ä»¥å“ªä¸ªçº¿ç¨‹ä¸ºå‡†ï¼Ÿ æ‰€ä»¥ï¼Œä¸ºäº†é¿å…å¤æ‚æ€§ï¼Œä»ä¸€è¯ç”Ÿï¼ŒJavaScript å°±æ˜¯å•çº¿ç¨‹ï¼Œè¿™å·²ç»æˆäº†è¿™é—¨è¯­è¨€çš„æ ¸å¿ƒç‰¹å¾ï¼Œå°†æ¥ä¹Ÿä¸ä¼šæ”¹å˜ã€‚ ä¸ºäº†åˆ©ç”¨å¤šæ ¸CPUçš„è®¡ç®—èƒ½åŠ›ï¼ŒHTML5æå‡º Web Worker æ ‡å‡†ï¼Œå…è®¸ JavaScript è„šæœ¬åˆ›å»ºå¤šä¸ªçº¿ç¨‹ï¼Œä½†æ˜¯å­çº¿ç¨‹å®Œå…¨å—ä¸»çº¿ç¨‹æ§åˆ¶ï¼Œä¸”ä¸å¾—æ“ä½œDOMã€‚æ‰€ä»¥ï¼Œè¿™ä¸ªæ–°æ ‡å‡†å¹¶æ²¡æœ‰æ”¹å˜JavaScriptå•çº¿ç¨‹çš„æœ¬è´¨ã€‚ 2.å•¥æ˜¯å¼‚æ­¥æˆ‘ä»¬å…ˆçœ‹ä¸€æ®µä»£ç ï¼š var i, t = Date.now(); for (i = 0; i &lt; 100000000; i++) {} console.log(Date.now() - t) // 250 ä¸Šé¢çš„ç¨‹åºèŠ±è´¹ 250ms çš„æ—¶é—´æ‰§è¡Œå®Œæˆï¼Œæ‰§è¡Œè¿‡ç¨‹ä¸­å°±ä¼šæœ‰å¡é¡¿ï¼Œå…¶ä»–çš„äº‹å„¿å°±å…ˆæ’‚ä¸€è¾¹ä¸ç®¡äº†ã€‚ æ‰§è¡Œç¨‹åºè¿™æ ·æ²¡æœ‰é—®é¢˜ï¼Œä½†æ˜¯å¯¹äº JS æœ€åˆä½¿ç”¨çš„ç¯å¢ƒ â€”â€”â€”â€” æµè§ˆå™¨å®¢æˆ·ç«¯ â€”â€”â€”â€” å°±ä¸ä¸€æ ·äº†ã€‚å› æ­¤åœ¨æµè§ˆå™¨ç«¯è¿è¡Œçš„jsï¼Œå¯èƒ½ä¼šæœ‰å¤§é‡çš„ç½‘ç»œè¯·æ±‚ï¼Œè€Œä¸€ä¸ªç½‘ç»œèµ„æºå•¥æ—¶å€™è¿”å›ï¼Œè¿™ä¸ªæ—¶é—´æ˜¯ä¸å¯é¢„ä¼°çš„ã€‚è¿™ç§æƒ…å†µä¹Ÿè¦å‚»å‚»çš„ç­‰ç€ã€å¡é¡¿ç€ã€å•¥éƒ½ä¸åšå—ï¼Ÿâ€”â€”â€”â€” é‚£è‚¯å®šä¸è¡Œã€‚ å› æ­¤ï¼ŒJS å¯¹äºè¿™ç§åœºæ™¯å°±è®¾è®¡äº†å¼‚æ­¥ â€”â€”â€”â€” å³ï¼Œå‘èµ·ä¸€ä¸ªç½‘ç»œè¯·æ±‚ï¼Œå°±å…ˆä¸ç®¡è¿™è¾¹äº†ï¼Œå…ˆå¹²å…¶ä»–äº‹å„¿ï¼Œç½‘ç»œè¯·æ±‚å•¥æ—¶å€™è¿”å›ç»“æœï¼Œåˆ°æ—¶å€™å†è¯´ã€‚è¿™æ ·å°±èƒ½ä¿è¯ä¸€ä¸ªç½‘é¡µçš„æµç¨‹è¿è¡Œã€‚ 3.äº‹ä»¶å’Œå›è°ƒå‡½æ•°â€œä»»åŠ¡é˜Ÿåˆ—â€æ˜¯ä¸€ä¸ªäº‹ä»¶çš„é˜Ÿåˆ—ï¼ˆä¹Ÿå¯ä»¥ç†è§£æˆæ¶ˆæ¯çš„é˜Ÿåˆ—ï¼‰ï¼ŒIOè®¾å¤‡å®Œæˆä¸€é¡¹ä»»åŠ¡ï¼Œå°±åœ¨â€ä»»åŠ¡é˜Ÿåˆ—â€ä¸­æ·»åŠ ä¸€ä¸ªäº‹ä»¶ï¼Œè¡¨ç¤ºç›¸å…³çš„å¼‚æ­¥ä»»åŠ¡å¯ä»¥è¿›å…¥â€æ‰§è¡Œæ ˆâ€äº†ã€‚ä¸»çº¿ç¨‹è¯»å–â€ä»»åŠ¡é˜Ÿåˆ—â€ï¼Œå°±æ˜¯è¯»å–é‡Œé¢æœ‰å“ªäº›äº‹ä»¶ã€‚ â€œä»»åŠ¡é˜Ÿåˆ—â€ä¸­çš„äº‹ä»¶ï¼Œé™¤äº†IOè®¾å¤‡çš„äº‹ä»¶ä»¥å¤–ï¼Œè¿˜åŒ…æ‹¬ä¸€äº›ç”¨æˆ·äº§ç”Ÿçš„äº‹ä»¶ï¼ˆæ¯”å¦‚é¼ æ ‡ç‚¹å‡»ã€é¡µé¢æ»šåŠ¨ç­‰ç­‰ï¼‰ã€‚åªè¦æŒ‡å®šè¿‡å›è°ƒå‡½æ•°ï¼Œè¿™äº›äº‹ä»¶å‘ç”Ÿæ—¶å°±ä¼šè¿›å…¥â€ä»»åŠ¡é˜Ÿåˆ—â€ï¼Œç­‰å¾…ä¸»çº¿ç¨‹è¯»å–ã€‚ æ‰€è°“â€å›è°ƒå‡½æ•°â€ï¼ˆcallbackï¼‰ï¼Œå°±æ˜¯é‚£äº›ä¼šè¢«ä¸»çº¿ç¨‹æŒ‚èµ·æ¥çš„ä»£ç ã€‚å¼‚æ­¥ä»»åŠ¡å¿…é¡»æŒ‡å®šå›è°ƒå‡½æ•°ï¼Œå½“ä¸»çº¿ç¨‹å¼€å§‹æ‰§è¡Œå¼‚æ­¥ä»»åŠ¡ï¼Œå°±æ˜¯æ‰§è¡Œå¯¹åº”çš„å›è°ƒå‡½æ•°ã€‚ â€œä»»åŠ¡é˜Ÿåˆ—â€æ˜¯ä¸€ä¸ªå…ˆè¿›å…ˆå‡ºçš„æ•°æ®ç»“æ„ï¼Œæ’åœ¨å‰é¢çš„äº‹ä»¶ï¼Œä¼˜å…ˆè¢«ä¸»çº¿ç¨‹è¯»å–ã€‚ä¸»çº¿ç¨‹çš„è¯»å–è¿‡ç¨‹åŸºæœ¬ä¸Šæ˜¯è‡ªåŠ¨çš„ï¼Œåªè¦æ‰§è¡Œæ ˆä¸€æ¸…ç©ºï¼Œâ€ä»»åŠ¡é˜Ÿåˆ—â€ä¸Šç¬¬ä¸€ä½çš„äº‹ä»¶å°±è‡ªåŠ¨è¿›å…¥ä¸»çº¿ç¨‹ã€‚ä½†æ˜¯ï¼Œç”±äºå­˜åœ¨åæ–‡æåˆ°çš„â€å®šæ—¶å™¨â€åŠŸèƒ½ï¼Œä¸»çº¿ç¨‹é¦–å…ˆè¦æ£€æŸ¥ä¸€ä¸‹æ‰§è¡Œæ—¶é—´ï¼ŒæŸäº›äº‹ä»¶åªæœ‰åˆ°äº†è§„å®šçš„æ—¶é—´ï¼Œæ‰èƒ½è¿”å›ä¸»çº¿ç¨‹ã€‚ 4.ä½¿ç”¨å›è°ƒå‡½æ•°æ¥è¿›è¡Œå¼‚æ­¥æ“ä½œä¸¾ä¸ªæ —å­ï¼š var ajax = $.ajax({ url: &apos;/data/data1.json&apos;, success: function () { console.log(&apos;success&apos;) } }) ä¸Šé¢è¿™ä¸ªajaxæ“ä½œå°±æ˜¯ä¸€ä¸ªå¼‚æ­¥æ“ä½œï¼Œç¬¬äºŒä¸ªå‚æ•°å°±æ˜¯ä¸€ä¸ªcallbackï¼Œæˆ‘ä»¬å…ˆå‘ä¸ªæ¶ˆæ¯å‡ºå»å–ä¸€äº›æ•°æ®ï¼Œå½“ç„¶ä¸ä¼šç«‹å³å°±èƒ½å–åˆ°ï¼Œé‚£æˆ‘ä»¬ä¹Ÿä¸é—²ç€ï¼Œå…ˆå»å¹²åˆ«çš„ï¼Œç­‰æ‹¿åˆ°äº†é€šçŸ¥æˆ‘ä»¬ï¼Œæˆ‘ä»¬å†æ‰§è¡Œcallbackè¿›è¡Œæ•°æ®æ“ä½œã€‚å®ç°å¼‚æ­¥çš„æœ€æ ¸å¿ƒåŸç†ï¼Œå°±æ˜¯å°†callbackä½œä¸ºå‚æ•°ä¼ é€’ç»™å¼‚æ­¥æ‰§è¡Œå‡½æ•°ï¼Œå½“æœ‰ç»“æœè¿”å›ä¹‹åå†è§¦å‘ callbackæ‰§è¡Œï¼Œå°±æ˜¯å¦‚æ­¤ç®€å•ï¼ 5.å¸¸ç”¨çš„å¼‚æ­¥æ“ä½œå¼€å‘ä¸­æˆ‘ä»¬æ¯”è¾ƒå¸¸ç”¨çš„å¼‚æ­¥æ“ä½œæœ‰; ç½‘ç»œè¯·æ±‚ï¼Œå¦‚ ajaxã€http IOæ“ä½œï¼Œå¦‚ readFileã€readDir å®šæ—¶å‡½æ•°ï¼šå¦‚ setTimeoutã€setInterval Event Loopè¿™ä¸€éƒ¨åˆ†è®©æˆ‘å†™è‚¯å®šæ˜¾å¾—ä¸šä½™ï¼Œè¿˜æ˜¯å»çœ‹çœ‹é˜®ä¸€å³°è€å¸ˆæ€ä¹ˆè¯´å§ï¼šJavaScript è¿è¡Œæœºåˆ¶è¯¦è§£ï¼šå†è°ˆEvent Loop äº‹ä»¶ç»‘å®šç®—ä¸ç®—å¼‚æ­¥å‘¢ï¼Ÿæˆ‘ä»¬çœ‹ä¸€ä¸ªäº‹ä»¶ç»‘å®šçš„æ“ä½œï¼š $btn.on(&apos;click&apos;, function (e) { console.log(&apos;ä½ ç‚¹å‡»äº†æŒ‰é’®&apos;) }) è¿™ä¸ªå†™æ³•å’Œæˆ‘ä»¬ä¸Šé¢çš„å¼‚æ­¥æ“ä½œæ˜¯ä¸æ˜¯ä¸€æ ·ï¼Œéƒ½å®šä¹‰äº†callbackï¼Œé‚£äº‹ä»¶ç»‘å®šç®—ä¸ç®—å¼‚æ­¥æ“ä½œå‘¢ï¼Ÿå¦‚æœä½ è®¤çœŸçœ‹äº†é˜®ä¸€å³°è€å¸ˆçš„é‚£ç¯‡æ–‡ç« ï¼Œä½ å°±ä¼šå‘ç°ï¼Œå…¶å®è¿™ä¹Ÿæ˜¯å¼‚æ­¥æ“ä½œã€‚ä¸ºä»€ä¹ˆæˆ‘ä¼šè¿™ä¹ˆé—®å‘¢ï¼Ÿ å› ä¸ºå®ƒä»¬ä¹‹é—´è¿˜æœ‰æœ‰äº›ä¸åŒä¹‹å¤„çš„ï¼š event-loop æ‰§è¡Œæ—¶ï¼Œè°ƒç”¨çš„æºä¸ä¸€æ ·ã€‚å¼‚æ­¥æ“ä½œæ˜¯ç³»ç»Ÿè‡ªåŠ¨è°ƒç”¨ï¼Œæ— è®ºæ˜¯setTimeoutæ—¶é—´åˆ°äº†è¿˜æ˜¯$.ajaxè¯·æ±‚è¿”å›äº†ï¼Œç³»ç»Ÿä¼šè‡ªåŠ¨è°ƒç”¨ã€‚è€Œäº‹ä»¶ç»‘å®šå°±éœ€è¦ç”¨æˆ·æ‰‹åŠ¨è§¦å‘ã€‚ ä»è®¾è®¡ä¸Šæ¥å°†ï¼Œäº‹ä»¶ç»‘å®šæœ‰ç€æ˜æ˜¾çš„â€œè®¢é˜…-å‘å¸ƒâ€çš„è®¾è®¡æ¨¡å¼ï¼Œè€Œå¼‚æ­¥æ“ä½œå´æ²¡æœ‰ã€‚ ä½†æ˜¯æˆ‘ä»¬ä»è¿™å¼ å›¾ä¸Šåˆå¯ä»¥å‘ç°,æˆ‘ä»¬çš„äº‹ä»¶åŒ…æ‹¬äº†Networkå’Œæˆ‘ä»¬çš„ä¸€äº›é¼ æ ‡æ“ä½œï¼Œè¿™äº›éƒ½è¢«è®¤ä¸ºæ˜¯å¼‚æ­¥çš„ã€‚å…¶å®ä»”ç»†æƒ³æƒ³ä¹Ÿå¯¹ï¼Œç½‘ç»œè¯·æ±‚å…¶å®ä¹Ÿç›¸å½“äºè®¢é˜…å’Œå‘å¸ƒå•Šï¼ ä»Šå¤©çš„å°±åˆ°è¿™å§ï¼","tags":[{"name":"JavaScript","slug":"JavaScript","permalink":"http://tanyibing.com/tags/JavaScript/"}]},{"title":"å°è£…ä¸ªKoa","date":"2018-09-13T08:39:37.000Z","path":"2018/09/13/å°è£…ä¸ªKoa/","text":"æƒ³äº†è§£ä¸‹Koaæ˜¯æ€ä¹ˆä¸ªéªšæ“ä½œï¼Œä¹‹å‰ä½¿ç”¨çš„æ˜¯Koa2ï¼Œé‡Œé¢æ˜¯asyncå’Œawaitï¼Œç”¨èµ·æ¥çˆ½æ­ªæ­ªã€‚ä¸è¿‡ï¼Œasyncå’Œawaitæ˜¯ES7é‡Œé¢çš„ä¸œä¸œï¼Œè¿˜æ˜¯æœ‰å¿…è¦çœ‹ä¸€ä¸‹koaçš„ç¬¬ä¸€ä»£çš„ï¼Œå‘ç°é‡Œé¢çš„ä¸­é—´ä»¶æ˜¯Generatorï¼Œå…¶å®æˆ‘å¯¹è¿™ä¸ªä¹Ÿä¸æ˜¯å¾ˆç†è§£ï¼ŒES6é‡Œé¢æ–°å¢åŠ çš„ï¼Œä¸€ä¸‹å­æœ‰ç‚¹éš¾æ¥å—ï¼Œä»Šå¤©å°±æä¸Šæ—¥ç¨‹ï¼Œçœ‹ä¸€çœ‹æ€ä¹ˆæï¼Œè‡ªå·±å°è£…ä¸ªKoaè¯•è¯•ï¼ æƒ³è¦çœŸæ­£ææ‡‚è¿™ä¸ªGeneratorè¿˜æ˜¯æ¯”è¾ƒçƒ¦ï¼Œæˆ‘è‡ªå·±æ„Ÿè§‰æ•´ä¸ªES6çš„ä¸»è¦éƒ¨åˆ†åº”è¯¥å°±æ˜¯è¿™ä¸ªGeneratoräº†ï¼Œç›¸çŸ¥å¸¦å®ƒæ€ä¹ˆå›äº‹å…ˆè¦çŸ¥é“Iteratorã€ç„¶åå†çœ‹Generatorï¼Œä½†æ˜¯æƒ³å’Œå¼‚æ­¥æ‰¯ä¸Šå…³ç³»ä½ è¿˜è¦çœ‹Chunkå‡½æ•°ï¼Œè¿˜è¦çœ‹çœ‹coåº“ï¼Œå½“ç„¶å•¦ï¼ŒPromiseè‚¯å®šè¦çŸ¥é“ï¼Œæ‰€ä»¥æ„Ÿè§‰è¿™ä¹Ÿä¸æ˜¯ä¸ªç®€å•çš„ä¸œè¥¿ï¼Œé—¨é“å¤šç€å‘¢ã€‚ ä¸è¯´åºŸè¯äº†ï¼Œä¸Šä»£ç å§ï¼Œå°è£…ä¸ªMyKoaï¼š class MyKoa extends Object { constructor(props) { super(props); // å­˜å‚¨æ‰€æœ‰çš„ä¸­é—´ä»¶ this.middlewares = [] } // æ³¨å…¥ä¸­é—´ä»¶ use (generator) { this.middlewares.push(generator) } // æ‰§è¡Œä¸­é—´ä»¶ listen () { this._run() } _run () { const ctx = this; const middlewares = ctx.middlewares; co(function* () { let prev = null let i = middlewares.length //ä»æœ€åä¸€ä¸ªä¸­é—´ä»¶åˆ°ç¬¬ä¸€ä¸ªä¸­é—´ä»¶çš„é¡ºåºå¼€å§‹éå† while (i--) { // ctx ä½œä¸ºå‡½æ•°æ‰§è¡Œæ—¶çš„ this æ‰èƒ½ä¿è¯å¤šä¸ªä¸­é—´ä»¶ä¸­æ•°æ®çš„å…±äº« //prev å°†å‰é¢ä¸€ä¸ªä¸­é—´ä»¶ä¼ é€’ç»™å½“å‰ä¸­é—´ä»¶ï¼Œæ‰ä½¿å¾—ä¸­é—´ä»¶é‡Œé¢çš„ next æŒ‡å‘ä¸‹ä¸€ä¸ªä¸­é—´ä»¶ prev = middlewares[i].call(ctx, prev); } //æ‰§è¡Œç¬¬ä¸€ä¸ªä¸­é—´ä»¶ yield prev; }) } } ç„¶åå¯ä»¥è¯•éªŒä¸‹æ•ˆæœï¼š var app = new MyKoa(); app.use(function *(next){ this.body = &apos;1&apos;; yield next; this.body += &apos;5&apos;; console.log(this.body); // 12345 }); app.use(function *(next){ this.body += &apos;2&apos;; yield next; this.body += &apos;4&apos;; }); app.use(function *(next){ this.body += &apos;3&apos;; }); app.listen(); å…¶å®Generatorå’Œæˆ‘ä»¬çš„å›è°ƒå¤„ç†å¼‚æ­¥çš„callbackæ ¹æœ¬æ²¡æœ‰ä¸€ç‚¹å…³ç³»ï¼Œå®ƒçš„æœ¬è´¨æ˜¯â€˜æš‚åœâ€™ï¼Œå¹¶å°†æ‰§è¡Œæƒè½¬ç§»ï¼Œæˆ‘ä»¬åªæ˜¯ç»™å®ƒç©¿ä¸Šäº†ä¸€å±‚åˆä¸€å±‚çš„å¤–å¥—ï¼Œå¼ºè¡Œè®©å®ƒå’Œå¼‚æ­¥â€˜å‘ç”Ÿå…³ç³»â€™ã€‚ PSï¼šç«‹ä¸ªflagï¼Œ2018å¹´è¿‡å¹´ä¹‹å‰æ‰¾ä¸ªæœºä¼šï¼Œæˆ‘ä¸€å®šå½»å½»åº•åº•ç ”ç©¶æ¬¡jsä¸­çš„å¼‚æ­¥ï¼ï¼ï¼","tags":[{"name":"Node","slug":"Node","permalink":"http://tanyibing.com/tags/Node/"},{"name":"Koa","slug":"Koa","permalink":"http://tanyibing.com/tags/Koa/"}]},{"title":"Jadeæ€ä¹ˆç©","date":"2018-09-13T02:24:18.000Z","path":"2018/09/13/Jadeæ€ä¹ˆç©/","text":"å‰ç«¯æƒ³è¦ç”¨æ¨¡æ¿ï¼Œé‚£å°±çœ‹çœ‹Jadeå§ï¼Œæ‰“å¼€æˆ‘ä»¬çš„Jadeå®˜ç½‘ï¼Œä¸Šå»çœ‹çœ‹å‘¢ï¼Œç»“æœå‘ç°å®˜ç½‘çœŸçš„å¾ˆæ°´ï¼Œæ°´åœ¨å“ªå‘¢ï¼Ÿç‰¹å–µçš„ï¼Œç»™çš„ä»£ç æ²¡æœ‰ä¸€ä¸ªæ³¨æ„ç¼©è¿›çš„ï¼Œè¿™ä¹Ÿå°±å¯¼è‡´åé¢å¾ˆå¤šæ¨¡æ¿ä½¿ç”¨jadeå‘½ä»¤æ—¶æŠ¥é”™ï¼Œæœ‰å¤±æ°´å‡†å•Šï¼ å¥½åœ¨å’‹ä»¬å›½äººæçš„è¿˜æ˜¯æ¯”è¾ƒé è°±ï¼šç‚¹è¿™å¯ä»¥å­¦ä¹ Jade ä½ ä¸ä¼šçœŸä»¥ä¸ºæˆ‘è¦å†™ä¸ªæŠ€æœ¯åšå®¢å§ï¼Œæˆ‘åªæ˜¯æ¥åæ§½ä¸‹ï¼ŒJadeå¾ˆç®€å•ï¼Œè‡ªå·±å»å­¦å§ï¼Œå‡ åˆ†é’Ÿå°±ä¼šäº†ã€‚","tags":[{"name":"Jade","slug":"Jade","permalink":"http://tanyibing.com/tags/Jade/"}]},{"title":"Generatorå‡½æ•°","date":"2018-09-12T08:09:54.000Z","path":"2018/09/12/Generatorå‡½æ•°/","text":"Generatorå‡½æ•°æ˜¨å¤©çš„Promiseå¯¹è±¡å°±æ˜¯ä¸€ç§å¼‚æ­¥ç¼–ç¨‹è§£å†³æ–¹æ¡ˆï¼Œä»Šå¤©å†çœ‹ä¸€ç§æ–¹æ¡ˆï¼Œè¿™å°±æ˜¯Generatorå‡½æ•°ã€‚ç½‘ä¸Šæœ‰å¾ˆå¤šå…³äºGeneratorçš„ä»‹ç»ï¼Œä¾‹å¦‚ï¼š Generator å‡½æ•°æœ‰å¤šç§ç†è§£è§’åº¦ã€‚è¯­æ³•ä¸Šï¼Œé¦–å…ˆå¯ä»¥æŠŠå®ƒç†è§£æˆï¼ŒGenerator å‡½æ•°æ˜¯ä¸€ä¸ªçŠ¶æ€æœºï¼Œå°è£…äº†å¤šä¸ªå†…éƒ¨çŠ¶æ€ã€‚æ‰§è¡Œ Generator å‡½æ•°ä¼šè¿”å›ä¸€ä¸ªéå†å™¨å¯¹è±¡ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼ŒGenerator å‡½æ•°é™¤äº†çŠ¶æ€æœºï¼Œè¿˜æ˜¯ä¸€ä¸ªéå†å™¨å¯¹è±¡ç”Ÿæˆå‡½æ•°ã€‚è¿”å›çš„éå†å™¨å¯¹è±¡ï¼Œå¯ä»¥ä¾æ¬¡éå† Generator å‡½æ•°å†…éƒ¨çš„æ¯ä¸€ä¸ªçŠ¶æ€ã€‚ Generatorçš„åˆ›å»ºæ¥ä¸‹æ¥æˆ‘ä»¬çœ‹ä¸€ä¸‹æ€ä¹ˆå®šä¹‰ä¸€ä¸ªGeneratorå‡½æ•°ï¼š function* helloWorldGenerator() { yield &apos;hello&apos;; yield &apos;world&apos;; return &apos;ending&apos;; } var hw = helloWorldGenerator(); æˆ‘ä»¬å‘ç°åœ¨functionå…³é”®å­—å’Œå‡½æ•°åç§°ä¹‹é—´æœ‰ä¸ªæ˜Ÿå·ï¼Œè¿™è¡¨ç¤ºè¿™æ˜¯ä¸€ä¸ªGeneratorå‡½æ•°ã€‚ä½†è¿™æ ·è¿˜ä¸è¡Œï¼Œè¿›å…¥å‡½æ•°æˆ‘ä»¬å‘ç°ä½¿ç”¨äº†yieldè¡¨è¾¾å¼ï¼Œå®šä¹‰äº†ä¸åŒçš„å†…éƒ¨çŠ¶æ€(yieldåœ¨è‹±è¯­ä¸­å°±æ˜¯â€œäº§ç”Ÿâ€çš„æ„æ€)ã€‚è¿™æ ·æˆ‘ä»¬ä¸€å…±å®šä¹‰äº†ä¸‰ä¸ªçŠ¶æ€ï¼šhelloã€wordå’Œä¸€ä¸ªreturnè¯­å¥ã€‚ Generatorçš„è°ƒç”¨Generatorå‡½æ•°è¿”å›çš„æ˜¯ä¸€ä¸ªéå†å™¨å¯¹è±¡ï¼Œä¹Ÿå°±æ˜¯è¯´æˆ‘ä»¬éœ€è¦è°ƒç”¨nextæ–¹æ³•æ¥éå†å‡½æ•°ä¸­çš„çŠ¶æ€ï¼š hw.next() // { value: &apos;hello&apos;, done: false } hw.next() / { value: &apos;world&apos;, done: false } hw.next() // { value: &apos;ending&apos;, done: true } hw.next() / { value: undefined, done: true } ä¸Šé¢ä¸€å…±è¿è¡Œäº†å››æ¬¡nextæ–¹æ³•ã€‚ ç¬¬ä¸€æ¬¡è°ƒç”¨ï¼ŒGenerator å‡½æ•°å¼€å§‹æ‰§è¡Œï¼Œç›´åˆ°é‡åˆ°ç¬¬ä¸€ä¸ªyieldè¡¨è¾¾å¼ä¸ºæ­¢ã€‚nextæ–¹æ³•è¿”å›ä¸€ä¸ªå¯¹è±¡ï¼Œå®ƒçš„valueå±æ€§å°±æ˜¯å½“å‰yieldè¡¨è¾¾å¼çš„å€¼helloï¼Œdoneå±æ€§çš„å€¼falseï¼Œè¡¨ç¤ºéå†è¿˜æ²¡æœ‰ç»“æŸã€‚ ç¬¬äºŒæ¬¡è°ƒç”¨ï¼ŒGenerator å‡½æ•°ä»ä¸Šæ¬¡yieldè¡¨è¾¾å¼åœä¸‹çš„åœ°æ–¹ï¼Œä¸€ç›´æ‰§è¡Œåˆ°ä¸‹ä¸€ä¸ªyieldè¡¨è¾¾å¼ã€‚nextæ–¹æ³•è¿”å›çš„å¯¹è±¡çš„valueå±æ€§å°±æ˜¯å½“å‰yieldè¡¨è¾¾å¼çš„å€¼worldï¼Œdoneå±æ€§çš„å€¼falseï¼Œè¡¨ç¤ºéå†è¿˜æ²¡æœ‰ç»“æŸã€‚ ç¬¬ä¸‰æ¬¡è°ƒç”¨ï¼ŒGenerator å‡½æ•°ä»ä¸Šæ¬¡yieldè¡¨è¾¾å¼åœä¸‹çš„åœ°æ–¹ï¼Œä¸€ç›´æ‰§è¡Œåˆ°returnè¯­å¥ï¼ˆå¦‚æœæ²¡æœ‰returnè¯­å¥ï¼Œå°±æ‰§è¡Œåˆ°å‡½æ•°ç»“æŸï¼‰ã€‚nextæ–¹æ³•è¿”å›çš„å¯¹è±¡çš„valueå±æ€§ï¼Œå°±æ˜¯ç´§è·Ÿåœ¨returnè¯­å¥åé¢çš„è¡¨è¾¾å¼çš„å€¼ï¼ˆå¦‚æœæ²¡æœ‰returnè¯­å¥ï¼Œåˆ™valueå±æ€§çš„å€¼ä¸ºundefinedï¼‰ï¼Œdoneå±æ€§çš„å€¼trueï¼Œè¡¨ç¤ºéå†å·²ç»ç»“æŸã€‚ ç¬¬å››æ¬¡è°ƒç”¨ï¼Œæ­¤æ—¶ Generator å‡½æ•°å·²ç»è¿è¡Œå®Œæ¯•ï¼Œnextæ–¹æ³•è¿”å›å¯¹è±¡çš„valueå±æ€§ä¸ºundefinedï¼Œdoneå±æ€§ä¸ºtrueã€‚ä»¥åå†è°ƒç”¨nextæ–¹æ³•ï¼Œè¿”å›çš„éƒ½æ˜¯è¿™ä¸ªå€¼ã€‚ Generatorå‡½æ•°çš„ä½œç”¨è¿™ä¸ªä¸œè¥¿çœ‹ä¸Šå»å¥½åƒæ²¡å•¥ç”¨ï¼Œé‚£ä¹ˆå®ƒåˆ°åº•èƒ½å¹²ç‚¹å•¥å‘¢ï¼Ÿ æŠŠå¼‚æ­¥å›è°ƒå˜æˆâ€˜åŒæ­¥â€™ä»£ç ä¾‹å¦‚æˆ‘ä»¬å†™ä¸ªajaxä»£ç ï¼š ajax(&apos;http://url-1&apos;, data1, function (err, result) { if (err) { return handle(err); } ajax(&apos;http://url-2&apos;, data2, function (err, result) { if (err) { return handle(err); } ajax(&apos;http://url-3&apos;, data3, function (err, result) { if (err) { return handle(err); } return success(result); }); }); }); è¿™ä¸ªä»£ç ç®€ç›´ä¸æƒ³çœ‹ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥ç”¨Generatoræ¥æ”¹é€ ä¸‹ï¼š try { r1 = yield ajax(&apos;http://url-1&apos;, data1); r2 = yield ajax(&apos;http://url-2&apos;, data2); r3 = yield ajax(&apos;http://url-3&apos;, data3); success(r3); } catch (err) { handle(err); } è¿™æ ·çœ‹ä¸Šå»å¥½å¤šäº†ï¼Œä½†ä¸æ˜¯çœŸæ­£çš„åŒæ­¥ä»£ç ï¼Œè‡³å°‘çœ‹ä¸Šå»å¾ˆåƒã€‚","tags":[{"name":"JavaScript","slug":"JavaScript","permalink":"http://tanyibing.com/tags/JavaScript/"},{"name":"ECMAScript6","slug":"ECMAScript6","permalink":"http://tanyibing.com/tags/ECMAScript6/"}]},{"title":"Promiseå¯¹è±¡","date":"2018-09-11T08:07:08.000Z","path":"2018/09/11/Promiseå¯¹è±¡/","text":"Promiseå¯¹è±¡Promiseçš„ä»‹ç»Promiseåœ¨ECMAScript6ä¸­è¢«æ­£å¼å†™è¿›äº†è¯­è¨€æ ‡å‡†ï¼Œè¿™æ˜¯å¼‚æ­¥ç¼–ç¨‹çš„ä¸€ç§è§£å†³æ–¹æ¡ˆï¼Œè¾ƒä¹‹ä¼ ç»Ÿçš„å‡½æ•°å›è°ƒå’Œäº‹ä»¶ï¼ŒPromiseæ¥å¾—æ›´åŠ å¼ºå¤§ã€‚Promiseè¢«ç†è§£æˆä¸€ä¸ªå®¹å™¨ï¼Œé‡Œé¢ä¿å­˜ç€æŸä¸ªæœªæ¥æ‰ä¼šç»“æŸçš„äº‹ä»¶ï¼ˆé€šå¸¸æ˜¯ä¸€ä¸ªå¼‚æ­¥æ“ä½œï¼‰çš„ç»“æœã€‚Promiseæœ‰ä¸‰ä¸ªçŠ¶æ€ï¼Œåˆ†åˆ«æ˜¯ï¼š pendingï¼šè¿›è¡Œä¸­ fulfilledï¼šå·²æˆåŠŸ rejectedï¼šå·²å¤±è´¥ è¿™ä¸‰ä¸ªçŠ¶æ€æ˜¯æ ¹æ®å¼‚æ­¥æ“ä½œçš„ç»“æœæ¥å†³å®šçš„ï¼Œä»»ä½•å…¶ä»–æ“ä½œéƒ½æ— æ³•æ”¹å˜è¿™ä¸ªçŠ¶æ€ã€‚è¿™ä¹Ÿæ˜¯Promiseè¿™ä¸ªåå­—çš„ç”±æ¥ï¼Œå®ƒçš„è‹±è¯­æ„æ€å°±æ˜¯â€œæ‰¿è¯ºâ€ï¼Œè¡¨ç¤ºå…¶ä»–æ‰‹æ®µæ— æ³•æ”¹å˜ã€‚è¿™ä¸‰ä¸ªçŠ¶æ€ä¸€æ—¦ç¡®å®šå°±ä¸ä¼šåœ¨æ”¹å˜äº†ã€‚ Promiseçš„ä½¿ç”¨åˆ›å»ºæ€ä¹ˆåˆ›å»ºä¸€ä¸ªPromiseå®ä¾‹å‘¢ï¼š const promise = new Promise(function(resolve, reject) { // ... some code if (/* å¼‚æ­¥æ“ä½œæˆåŠŸ */){ resolve(value); } else { reject(error); } }); å…¶ä¸­ä¸¤ä¸ªæ–¹æ³•ï¼Œresolveç”¨æ¥å¤„ç†å¼‚æ­¥æ“ä½œæˆåŠŸçš„ç»“æœï¼Œå°†å…¶ç»“æœä¼ é€’å‡ºå»ï¼Œåœ¨åé¢çš„thenæ–¹æ³•ä¸­å»æ¥å—ï¼Œrejectç”¨æ¥å¤„ç†æ“ä½œå¤±è´¥çš„ç»“æœå¹¶ä¼ é€’å‡ºå»ï¼Œä¹Ÿå¯ç”¨thenæ–¹æ³•æ¥æ”¶ã€‚ thenæ–¹æ³•çš„ä½¿ç”¨Promiseå®ä¾‹ç”Ÿæˆä»¥åï¼Œå¯ä»¥ç”¨thenæ–¹æ³•åˆ†åˆ«æŒ‡å®šresolvedçŠ¶æ€å’ŒrejectedçŠ¶æ€çš„å›è°ƒå‡½æ•°ï¼š promise.then(function(value) { // success }, function(error) { // failure }); å…¶ä¸­ç¬¬äºŒä¸ªå‡½æ•°æ˜¯å¯é€‰çš„ã€‚è¿™ä¸¤ä¸ªå‡½æ•°å°±æ˜¯ç”¨æ¥æ¥æ”¶ä¸Šé¢ä¼ å‡ºæ¥çš„ç»“æœçš„ã€‚è€Œä¸”éœ€è¦æ³¨æ„çš„æ˜¯thenæ–¹æ³•è¿”å›æ˜¯ä¸€ä¸ªæ–°çš„Promiseï¼Œä¹Ÿå°±æ˜¯è¯´æˆ‘ä»¬å¯ä»¥è¿›è¡Œé“¾å¼ç¼–ç¨‹ã€‚ Promiseæ‰§è¡Œé¡ºåºPromiseåœ¨æ–°å»ºä¹‹åå°±ä¼šç«‹å³æ‰§è¡Œï¼Œä¸¾ä¸ªä¾‹å­ï¼š let promise = new Promise(function(resolve, reject) { console.log(&apos;a&apos;); resolve(); }); promise.then(function() { console.log(&apos;b&apos;); }); console.log(&apos;c&apos;); // a // c // b ä¸Šé¢çš„ä»£ç å…ˆè¾“å‡ºaï¼Œå› ä¸ºPromiseæ–°å»ºä¹‹åå°±ç«‹å³æ‰§è¡Œï¼Œthenæ–¹æ³•åœ¨å½“å‰è„šæœ¬æ‰€æœ‰åŒæ­¥ä»»åŠ¡æ‰§è¡Œå®Œæ‰æ‰§è¡Œï¼Œæœ€åæ‰ä¼šè¾“å‡ºbã€‚ Promiseå’Œå…¶ä»–æŠ€æœ¯æ˜¨å¤©æˆ‘çœ‹äº†RxJSï¼Œå‘ç°è¿™ä¸¤è´§å¥½åƒæœ‰ç‚¹åƒï¼Œä¸€ä¸ªæ˜¯æŠŠæ‰€æœ‰æ•°æ®éƒ½å˜æˆæµè¿›è¡Œæ“ä½œã€‚ä¸€ä¸ªæ˜¯ä¸€ç›´è¿”å›Promiseï¼Œé€šè¿‡thenæ–¹æ³•ä¸€ç›´é“¾å¼æ“ä½œï¼Œé‚£å°±æ¯”è¾ƒä¸€ä¸‹å§ã€‚ æ“ä½œ å¯è§‚å¯Ÿå¯¹è±¡ æ‰¿è¯º åˆ›å»º new Observable((observer) =&gt; {observer.next(123);}); new Promise((resolve, reject) =&gt; {resolve(123);}); è½¬æ¢ obs.map((value) =&gt; value * 2 ); promise.then((value) =&gt; value * 2); è®¢é˜… sub = obs.subscribe((value) =&gt; {console.log(value)}); promise.then((value) =&gt; {console.log(value);}); å–æ¶ˆè®¢é˜… sub.unsubscribe(); æ‰¿è¯ºè¢«è§£ææ—¶éšå¼å®Œæˆã€‚ Promiseçš„åº”ç”¨åŠ è½½å›¾ç‰‡æˆ‘ä»¬å¯ä»¥å°†å›¾ç‰‡çš„åŠ è½½å†™æˆä¸€ä¸ªPromiseï¼Œä¸€æ—¦åŠ è½½å®Œæˆï¼ŒPromiseçš„çŠ¶æ€å°±å‘ç”Ÿå˜åŒ–ã€‚ const preloadImage = function (path) { return new Promise(function (resolve, reject) { const image = new Image(); image.onload = resolve; image.onerror = reject; image.src = path; }); };","tags":[{"name":"JavaScript","slug":"JavaScript","permalink":"http://tanyibing.com/tags/JavaScript/"},{"name":"ECMAScript6","slug":"ECMAScript6","permalink":"http://tanyibing.com/tags/ECMAScript6/"}]},{"title":"åˆå…¥RxJS","date":"2018-09-10T03:21:19.000Z","path":"2018/09/10/åˆå…¥RxJS/","text":"RxJSç®€ä»‹åˆšå¼€å§‹æ¥è§¦angularçš„æ—¶å€™å°±å‘ç°ï¼ŒRxJSåœ¨angularä¸­æ˜¯ä½¿ç”¨çš„æœ€å¤šçš„æ¡†æ¶ã€‚å®ƒçš„å…¨ç§°æ˜¯ï¼šReactive Extensionã€‚è¿™å¥—æ¡†æ¶å…¶å®æ˜¯æºè‡ªäºå¾®è½¯ï¼Œå¾®è½¯åœ¨2011å¹´å°±å·²ç»å¼€å‘å‡ºè¿™å¥—æ¡†æ¶äº†ï¼Œä½†çœŸæ­£ç«èµ·æ¥æ˜¯åœ¨NetFlixï¼Œæ”¯æŒå¾ˆå¤šè¯­è¨€çš„ä¸€å¥—å“åº”å¼ç¼–ç¨‹çš„æ¡†æ¶ï¼Œæ„Ÿå…´è¶£å¯ä»¥å»å®ƒçš„å®˜ç½‘çœ‹çœ‹ï¼šreactivex.ioï¼Œæ”¯æŒäº†è¿™ä¹ˆå¤šè¯­è¨€ï¼ï¼ï¼ å®ƒçš„ä¼˜åŠ¿åœ¨äºï¼šåœ¨æ€è€ƒçš„ç»´åº¦ä¸ŠåŠ ä¸Šæ—¶é—´è€ƒé‡ã€‚ï¼Œè¿™ä¹Ÿæ˜¯ä¸€ä¸ªé—®é¢˜ï¼Œå¯¼è‡´æ›´éš¾ç†è§£ï¼ ObservableObservableçš„æ€§è´¨Observableæœ‰ä¸‰ç§çŠ¶æ€ï¼Œåˆ†åˆ«æ˜¯ï¼š nextï¼šå¿…è¦ã€‚ç”¨æ¥å¤„ç†æ¯ä¸ªé€è¾¾å€¼ã€‚åœ¨å¼€å§‹æ‰§è¡Œåå¯èƒ½æ‰§è¡Œé›¶æ¬¡æˆ–å¤šæ¬¡ã€‚ errorï¼šå¯é€‰ã€‚ç”¨æ¥å¤„ç†é”™è¯¯é€šçŸ¥ã€‚é”™è¯¯ä¼šä¸­æ–­è¿™ä¸ªå¯è§‚å¯Ÿå¯¹è±¡å®ä¾‹çš„æ‰§è¡Œè¿‡ç¨‹ã€‚ completeï¼šå¯é€‰ã€‚ç”¨æ¥å¤„ç†æ‰§è¡Œå®Œæ¯•ï¼ˆcompleteï¼‰é€šçŸ¥ã€‚å½“æ‰§è¡Œå®Œæ¯•åï¼Œè¿™äº›å€¼å°±ä¼šç»§ç»­ä¼ ç»™ä¸‹ä¸€ä¸ªå¤„ç†å™¨ã€‚ è¿˜æœ‰ç‰¹æ®Šçš„Observableï¼šæ°¸ä¸ç»“æŸçš„ã€Neverã€Emptyï¼ˆç»“æŸä½†ä¸å‘å°„ï¼‰ã€Throw æœ¬æ¥æ˜¯æƒ³å†™ä»‹ç»ç‚¹æ“ä½œç¬¦çš„ï¼Œä½†æ˜¯æˆ‘å‘ç°æ²¡å•¥æ„æ€ï¼Œåæ­£æ–‡æ¡£éƒ½èƒ½æŸ¥åˆ°ï¼Œé‚£å°±è®°å½•ç‚¹è‡ªå·±å¯¹Observableçš„ç†è§£å§ï¼Œå…·ä½“æ“ä½œç¬¦åˆ°æ—¶å€™æŸ¥apiã€‚å…¶å®Observableå°±æ˜¯å°†æ•°æ®ä»¥æµçš„å½¢å¼æ¥è¿›è¡Œå¤„ç†ï¼Œå¯ä»¥ç†è§£æˆnodeä¸­çš„æµï¼Œæˆ‘ä»¬å¯ä»¥å¯¹æµè¿›è¡Œä¸€ç³»åˆ—çš„æ“ä½œï¼Œæœ€åæˆ‘ä»¬å†è®¢é˜…è¿™ä¸ªæµï¼Œå¯¹æµé‡Œé¢çš„æ•°æ®è¿›è¡Œä½¿ç”¨ã€‚ ä¸¾ä¸ªä¾‹å­å§: const a: Array&lt;number&gt; = [1, 2, 3, 4]; const a$ = Rx.Observable.from(a).pipe(map( val =&gt; val * val)); const observer = { next: (val) =&gt; console.log(val); errorï¼š (err) =&gt; console.log(err); complete: () =&gt; console.log(`everything is completed`); } a$.subscribe(observer); ä¸Šé¢çš„ä¾‹å­ä¼šæ‰“å°å‡ºï¼š 1 4 9 16 å› ä¸ºæˆ‘ä»¬å¯¹æµä¸­çš„æ•°æ®è¿›è¡Œäº†mapæ“ä½œï¼Œä½¿å®ƒä»¬è‡ªå·±ä¹˜ä»¥è‡ªå·±ã€‚è¿™å°±æ˜¯å¯¹æµçš„ä¸€ä¸ªç®€å•å¤„ç†ï¼Œè¿pipeæ–¹æ³•éƒ½å’Œnodeä¸­çš„æµä¸€æ ·ã€‚ Observableçš„å†·å’Œçƒ­Observableæœ‰ä¸¤ç§ï¼Œä¸€ç§æ˜¯å†·çš„ï¼Œä¸€ç§æ˜¯çƒ­çš„ã€‚æ€ä¹ˆå»ç†è§£å‘¢ï¼Ÿä¸‹é¢çš„å†…å®¹åœ¨angularçš„å®˜ç½‘ä¸Šå¹¶æ²¡æœ‰è¯´æ˜ å†·çš„å°±æ˜¯è¡¨ç¤ºï¼Œæ¯æ¬¡ä½ è®¢é˜…ä¹‹åæˆ‘ä»¬éƒ½ä¼šä»å¤´æ‰§è¡Œä¸€éï¼Œå°±åƒçœ‹é‡æ’­ä¸€æ ·ï¼Œç‚¹å‡»ä¹‹åéƒ½æ˜¯é‡å¤´å¼€å§‹æ’­æ”¾ï¼› çƒ­ä»£è¡¨æ¯æ¬¡è®¢é˜…ä¹‹åå¤§å®¶ä¹‹é—´çš„è¿›åº¦æ˜¯ä¸€æ ·çš„ï¼Œå°±åƒçœ‹ç›´æ’­ä¸€æ ·ï¼Œæ‰“å¼€ä¹‹åéƒ½æ˜¯æœ€æ–°æ—¶åˆ»çš„é€šçŸ¥ã€‚ æœªå®Œå¾…ç»­ã€‚","tags":[{"name":"Angular","slug":"Angular","permalink":"http://tanyibing.com/tags/Angular/"},{"name":"Typescript","slug":"Typescript","permalink":"http://tanyibing.com/tags/Typescript/"}]},{"title":"angularåŠ¨ç”»","date":"2018-09-07T06:48:12.000Z","path":"2018/09/07/angularåŠ¨ç”»/","text":"AngularåŠ¨ç”»åœ¨angular2çš„æ—¶å€™ï¼ŒangularåŠ¨ç”»è¿˜æ˜¯ä¸ªæ ¸å¿ƒçš„ç»„ä»¶åº“ï¼Œä½†æ˜¯åˆ°äº†angular4çš„æ—¶å€™ï¼Œä¸ºäº†å‡å°æ ¸å¿ƒåº“çš„ä½“ç§¯ï¼Œæ‰€ä»¥ç§»é™¤å‡ºæ ¸å¿ƒç»„ä»¶ã€‚ä½†å¹¶ä¸æ˜¯ä¸é‡è¦ï¼Œå®ƒä¾ç„¶æ˜¯angularä¸­å¾ˆé‡è¦çš„ç»„æˆéƒ¨åˆ†ï¼Œè€Œä¸”ä¹Ÿæ˜¯å®˜æ–¹æä¾›çš„æ”¯æŒã€‚ angularåŠ¨ç”»æ¶æ„å…¶å®å¾ˆç®€å•ï¼Œå°±æ˜¯åœ¨ç»„ä»¶é‡Œé¢å®šä¹‰æ•°ä¸ªè§¦å‘å™¨ï¼Œæ¯ä¸ªè§¦å‘å™¨ä¼šæœ‰ä¸€ç³»åˆ—çš„çŠ¶æ€å’Œè¿‡æ¸¡æ•ˆæœï¼Œå…¶å®è¿™å°±æ˜¯åŠ¨ç”»ã€‚ State &amp; Transitonï¼ˆè¿™ä¸¤ä¸ªæ˜¯æ ¸å¿ƒï¼‰ åŠ¨ç”»å…¶å®å°±æ˜¯ä»ä¸€ä¸ªçŠ¶æ€è¿‡æ¸¡åˆ°å¦ä¸€ä¸ªçŠ¶æ€ çŠ¶æ€æœ¬èº«åŒ…å«å½¢çŠ¶ã€é¢œè‰²ã€å¤§å°ç­‰ç­‰ Stateå°±æ˜¯å®šä¹‰çŠ¶æ€è€ŒTransitionæ˜¯å®šä¹‰å¦‚ä½•è¿‡æ¸¡ Animateå‡½æ•°å…¶å®åœ¨Transitionå‡½æ•°ä¸­ï¼Œè¿˜ä¼šè°ƒç”¨å¦ä¸€ä¸ªå‡½æ•°ï¼Œé‚£å°±æ˜¯Animate Animateè§„å®šäº†å…·ä½“æ€ä¹ˆæ ·è¿‡æ¸¡ï¼Œæ¯”å¦‚æ—¶é—´ã€è¿‡æ¸¡çš„é€Ÿåº¦ç­‰ Animateæœ‰å¤šä¸ªé‡è½½å½¢å¼ ä½¿ç”¨æµç¨‹å¼•å…¥å…³é”®æ¨¡å—å¹¶å£°æ˜import { BrowserModule } from &apos;@angular/platform-browser&apos;; import { BrowserAnimationsModule } from &apos;@angular/platform-browser/animations&apos;; @NgModule({ imports: [ BrowserModule, BrowserAnimationsModule ], }) export class AppModule { } å»ºè®®åœ¨importsä¸­æœ€åå¼•å…¥BrowserAnimationsModuleæ¨¡å—ï¼Œæ”¾åœ¨å‰é¢å¯èƒ½ä¼šè¸©å‘ã€‚ å®šä¹‰å„ç§çŠ¶æ€æ‹¿ä¸ªå®˜ç½‘çš„ä¾‹å­æ¥çœ‹çœ‹ï¼š @Component({ ... //è¿™é‡Œæ˜¯ä¸€äº›æ­£å¸¸çš„å®šä¹‰ animations: [ trigger(&apos;heroState&apos;, [ state(&apos;inactive&apos;, style({ backgroundColor: &apos;#eee&apos;, transform: &apos;scale(1)&apos; })), state(&apos;active&apos;, style({ backgroundColor: &apos;#cfd8dc&apos;, transform: &apos;scale(1.1)&apos; })), transition(&apos;inactive =&gt; active&apos;, animate(&apos;100ms ease-in&apos;)), transition(&apos;active =&gt; inactive&apos;, animate(&apos;100ms ease-out&apos;)) ]) ] }) è¿™é‡Œå®šä¹‰äº†ä¸¤ä¸ªçŠ¶æ€ï¼Œä¸€ä¸ªæ˜¯activeè¿˜æœ‰ä¸ªæ˜¯incativeï¼Œè¿™ä¸¤ä¸ªçŠ¶æ€åˆ†åˆ«æœ‰ä¸åŒçš„styleæ ·å¼ï¼Œtransitionå®šä¹‰äº†ä»ä¸åŒçŠ¶æ€è¿‡æ¸¡åˆ°å¦ä¸€ä¸ªçŠ¶æ€çš„è¿‡ç¨‹ã€‚ é™„åŠ åˆ°æ¨¡æ¿ä¸Štemplate: ` &lt;ul&gt; &lt;li *ngFor=&quot;let hero of heroes&quot; [@heroState]=&quot;hero.state&quot; (click)=&quot;hero.toggleState()&quot;&gt; {{hero.name}} &lt;/li&gt; &lt;/ul&gt; ` åªè¦ä½¿ç”¨[@triggerName]è¯­æ³•åŠ åˆ°æ¨¡æ¿ä¸Šå°±è¡Œäº†ã€‚è¿™å°±æ˜¯ä¸€ä¸ªç®€å•çš„åŠ¨ç”»æ•ˆæœã€‚ æ›´å¤šçš„æ·±å…¥çŸ¥è¯†ï¼Œä¾‹å¦‚ç¼“åŠ¨å‡½æ•°ã€å…³é”®å¸§éœ€è¦çš„è¯å¯ä»¥å»å®˜ç½‘çœ‹çœ‹ï¼Œåœ¨è¿™è´´ä¸¤ä¸ªå¥½ç©çš„ç½‘å€å‡ºæ¥ï¼š https://easings.net/zh-cnhttp://cubic-bezier.com/#.17,.67,.83,-0.63","tags":[{"name":"Angular","slug":"Angular","permalink":"http://tanyibing.com/tags/Angular/"},{"name":"Typescript","slug":"Typescript","permalink":"http://tanyibing.com/tags/Typescript/"}]},{"title":"angularå®æˆ˜ä¸­è¸©è¿‡çš„å‘ï¼ˆä¸å®šæ—¶æ›´æ–°ï¼‰","date":"2018-09-07T04:08:48.000Z","path":"2018/09/07/angularå®æˆ˜ä¸­è¸©è¿‡çš„å‘ï¼ˆä¸å®šæ—¶æ›´æ–°ï¼‰/","text":"åŠ¨æ€è¡¨å•ä¸­è¸©è¿‡çš„å‘2018-9-7é—®é¢˜ï¼šä»Šå¤©åœ¨å†™åŠ¨æ€è¡¨å•æ—¶é‡åˆ°ä¸ªé—®é¢˜ï¼Œæˆ‘åœ¨æ§åˆ¶å™¨ä¸­ç”Ÿæˆçš„formControlæ­»æ´»å°±æ˜¯æ‹¿ä¸åˆ°æˆ‘è¾“å…¥çš„å€¼ã€‚ åˆ†æï¼šç”ŸæˆformControlçš„ä»£ç è‚¯å®šæ²¡æœ‰é—®é¢˜ï¼š let fb = new FormBuilder(); this.formModel = fb.group({ title: [&apos;&apos;, Validators.minLength(3)], price: [null, this.positiveNumberValidator], category: [&apos;-1&apos;] }); å¯¹å§ï¼Œæ˜¯æ²¡æœ‰é—®é¢˜ï¼Œé‚£è‚¯å®šå°±æ˜¯å‡ºåœ¨ç»‘å®šæ¨¡æ¿çš„æ—¶å€™ï¼Œäºæ˜¯æˆ‘ä»¬è®¤çœŸçœ‹çœ‹å§ã€‚ é—®é¢˜æ ¹æºï¼š å‘ç°äº†å§ï¼Œè¿™ä¸ªNameç”±äºæ‰“å¿«äº†ï¼Œæ‰“æˆäº†å°å†™ï¼ä½çº§é”™è¯¯ï¼ä»¥åæ‹¼å†™ç»†å¿ƒç‚¹ï¼ ç‰ˆæœ¬æ›´æ–°é—®é¢˜é—®é¢˜ï¼šæˆ‘æƒ³è¦åšä¸ªå•†å“ç­›é€‰çš„åŠŸèƒ½ï¼Œå…¶ä¸­æˆ‘éœ€è¦ä½¿ç”¨debounceTimeæ–¹æ³•æ¥å¯¹æˆ‘çš„è¾“å…¥è¡Œä¸ºäº§ç”Ÿä¸€ä¸ªå»¶æ—¶çš„å¤„ç†ï¼Œæˆ‘çš„è°ƒç”¨æ–¹æ³•å¦‚ä¸‹ï¼š å¼•å…¥çš„æ˜¯ï¼š import â€˜rxjs/RWâ€™; ç»“æœå¼•å…¥æŠ¥é”™ã€‚ åˆ†æï¼šæ—¢ç„¶å¼•å…¥æŠ¥é”™è‚¯å®šæ˜¯æ›´æ–°è¿‡äº†ï¼Œç›®å½•ç»“æ„å‘ç”Ÿå˜åŒ–äº†ï¼Œç”šè‡³è¿æ–¹æ³•çš„ä½¿ç”¨ä¹Ÿæœ‰å¯èƒ½æ”¹å˜äº†ï¼Œè¿˜æ˜¯å»å®˜æ–¹æ‰¾æ‰¾å§ã€‚ é—®é¢˜æ ¹æºï¼šä¸€æŸ¥æœç„¶æ˜¯æ›´æ–°çš„é—®é¢˜ï¼Œè€Œä¸”ä¸å‡ºæ„æ–™ï¼Œæ–¹æ³•ä¹Ÿéœ€è¦ä¿®æ”¹ä¸‹ï¼Œç»è¿‡ä¿®æ”¹åå¼•å…¥çš„æ–¹å¼å¦‚ä¸‹ï¼š import { debounceTime } from â€˜rxjs/operatorsâ€™; æ–¹æ³•ä¹Ÿéœ€è¦æ”¹è¿›æˆä¸‹é¢è¿™ç§:","tags":[{"name":"Angular","slug":"Angular","permalink":"http://tanyibing.com/tags/Angular/"},{"name":"Typescript","slug":"Typescript","permalink":"http://tanyibing.com/tags/Typescript/"}]},{"title":"Koaä¸­ä½¿ç”¨Cookie & Session","date":"2018-09-06T02:43:21.000Z","path":"2018/09/06/Koaä¸­ä½¿ç”¨Cookie-Session/","text":"koaä¸­cookieå’Œsessionä½¿ç”¨ cookieä»‹ç»cookie æ˜¯å­˜å‚¨äºè®¿é—®è€…çš„è®¡ç®—æœºä¸­çš„å˜é‡ï¼ˆå®¢æˆ·ç«¯ï¼‰ã€‚å¯ä»¥è®©æˆ‘ä»¬ç”¨åŒä¸€ä¸ªæµè§ˆå™¨è®¿é—®åŒä¸€ä¸ªåŸŸåçš„æ—¶å€™å…±äº«æ•°æ®ã€‚é‚£ä¸ºä»€ä¹ˆä¸ä½¿ç”¨httpå‘¢ï¼Ÿå¾ˆç®€å•ï¼Œå› ä¸ºHTTP æ˜¯æ— çŠ¶æ€åè®®ã€‚ç®€å•åœ°è¯´ï¼Œå½“ä½ æµè§ˆäº†ä¸€ä¸ªé¡µé¢ï¼Œç„¶åè½¬åˆ°åŒä¸€ä¸ªç½‘ç«™çš„å¦ä¸€ä¸ªé¡µé¢ï¼ŒæœåŠ¡å™¨æ— æ³•è®¤è¯†åˆ°è¿™æ˜¯åŒä¸€ä¸ªæµè§ˆå™¨åœ¨è®¿é—®åŒä¸€ä¸ªç½‘ç«™ã€‚æ¯ä¸€æ¬¡çš„è®¿é—®ï¼Œéƒ½æ˜¯æ²¡æœ‰ä»»ä½•å…³ç³»çš„ã€‚ cookieç”¨å¤„éšä¾¿ä¸¾å‡ ä¸ªä¾‹å­ï¼š å­˜å‚¨ç”¨æˆ·ä¿¡æ¯ï¼Œä¾‹å¦‚ç™»é™†ä¿¡æ¯ã€‚ æµè§ˆå†å²è®°å½•ã€‚ çŒœä½ å–œæ¬¢çš„åŠŸèƒ½ã€‚ 10å¤©å…ç™»é™†ã€‚ å¤šä¸ªé¡µé¢ä¹‹é—´çš„æ•°æ®ä¼ é€’ã€‚ å®ç°è´­ç‰©è½¦åŠŸèƒ½ã€‚ Koa Cookieçš„ä½¿ç”¨Koaä¸­è®¾ç½®Cookieçš„å€¼ctx.cookies.set(name, value, [options]) é€šè¿‡optionsè®¾ç½®cookie nameçš„value: optionsåç§° optionså€¼ maxAge ä¸€ä¸ªæ•°å­—è¡¨ç¤ºä» Date.now() å¾—åˆ°çš„æ¯«ç§’æ•°ã€‚ expires cookie è¿‡æœŸçš„ Date path cookie è·¯å¾„, é»˜è®¤æ˜¯â€™/â€˜ã€‚ secure å®‰å…¨ cookie é»˜è®¤ falseï¼Œè®¾ç½®æˆ true è¡¨ç¤ºåªæœ‰ https å¯ä»¥è®¿é—®ã€‚ httpOnly æ˜¯å¦åªæ˜¯æœåŠ¡å™¨å¯è®¿é—® cookie, é»˜è®¤æ˜¯ true overwrite ä¸€ä¸ªå¸ƒå°”å€¼ï¼Œè¡¨ç¤ºæ˜¯å¦è¦†ç›–ä»¥å‰è®¾ç½®çš„åŒåçš„ cookie (é»˜è®¤æ˜¯ false). å¦‚æœæ˜¯ true, åœ¨åŒä¸€ä¸ªè¯·æ±‚ä¸­è®¾ç½®ç›¸åŒåç§°çš„æ‰€æœ‰ Cookieï¼ˆä¸ç®¡è·¯å¾„æˆ–åŸŸï¼‰æ˜¯å¦åœ¨è®¾ç½®æ­¤ Cookie æ—¶ä»Set-Cookie æ ‡å¤´ä¸­è¿‡æ»¤æ‰ã€‚ Koaä¸­è®¾ç½®ä¸­æ–‡Cookieconsole.log(new Buffer(&apos;hello, world!&apos;).toString(&apos;base64&apos;));// è½¬æ¢æˆ base64 å­—ç¬¦ä¸²ï¼šaGVsbG8sIHdvcmxkIQ== console.log(new Buffer(&apos;aGVsbG8sIHdvcmxkIQ==&apos;, &apos;base64&apos;).toString());// è¿˜åŸ base64 å­—ç¬¦ä¸²ï¼šhello, world! Sessionä»‹ç»session æ˜¯å¦ä¸€ç§è®°å½•å®¢æˆ·çŠ¶æ€çš„æœºåˆ¶ï¼Œä¸åŒçš„æ˜¯Cookieä¿å­˜åœ¨å®¢æˆ·ç«¯æµè§ˆå™¨ä¸­ï¼Œè€ŒSessionä¿å­˜åœ¨æœåŠ¡å™¨ä¸Šã€‚ Session çš„å·¥ä½œæµç¨‹å½“æµè§ˆå™¨è®¿é—®æœåŠ¡å™¨å¹¶å‘é€ç¬¬ä¸€æ¬¡è¯·æ±‚æ—¶ï¼ŒæœåŠ¡å™¨ç«¯ä¼šåˆ›å»ºä¸€ä¸ªsession å¯¹è±¡ï¼Œç”Ÿæˆä¸€ä¸ªç±»ä¼¼äº key,valueçš„é”®å€¼å¯¹ï¼Œç„¶åå°†key(cookie)è¿”å›åˆ°æµè§ˆå™¨(å®¢æˆ·)ç«¯ï¼Œæµè§ˆå™¨ä¸‹æ¬¡å†è®¿é—®æ—¶ï¼Œæºå¸¦key(cookie)ï¼Œæ‰¾åˆ°å¯¹åº”çš„Session(value)ã€‚ å®¢æˆ·çš„ä¿¡æ¯éƒ½ä¿å­˜åœ¨Sessionä¸­ã€‚ koa-session çš„ä½¿ç”¨npm install koa-session --save å¼•å…¥ express-sessionconst session = require(&apos;koa-session&apos;); è®¾ç½®å®˜æ–¹æ–‡æ¡£æä¾›çš„ä¸­é—´ä»¶app.keys = [&apos;some secret hurr&apos;]; const CONFIG = { key: &apos;koa:sess&apos;, //cookie key (default is koa:sess) maxAge: 86400000, // cookie çš„è¿‡æœŸæ—¶é—´ maxAge in ms (default is 1 days) overwrite: true, //æ˜¯å¦å¯ä»¥ overwrite (é»˜è®¤ default true) httpOnly: true, //cookie æ˜¯å¦åªæœ‰æœåŠ¡å™¨ç«¯å¯ä»¥è®¿é—® httpOnly or not (default true) signed: true, //ç­¾åé»˜è®¤ true rolling: false, //åœ¨æ¯æ¬¡è¯·æ±‚æ—¶å¼ºè¡Œè®¾ç½® cookieï¼Œè¿™å°†é‡ç½® cookie è¿‡æœŸæ—¶é—´ï¼ˆé»˜è®¤ï¼šfalseï¼‰ renew: false, //(boolean) renew session when session is nearly expired, }; app.use(session(CONFIG, app)); Cookie å’Œ Session åŒºåˆ« cookie æ•°æ®å­˜æ”¾åœ¨å®¢æˆ·çš„æµè§ˆå™¨ä¸Šï¼Œsession æ•°æ®æ”¾åœ¨æœåŠ¡å™¨ä¸Šã€‚ cookie ä¸æ˜¯å¾ˆå®‰å…¨ï¼Œåˆ«äººå¯ä»¥åˆ†æå­˜æ”¾åœ¨æœ¬åœ°çš„ COOKIE å¹¶è¿›è¡Œ COOKIE æ¬ºéª—è€ƒè™‘åˆ°å®‰å…¨åº”å½“ä½¿ç”¨ sessionã€‚ session ä¼šåœ¨ä¸€å®šæ—¶é—´å†…ä¿å­˜åœ¨æœåŠ¡å™¨ä¸Šã€‚å½“è®¿é—®å¢å¤šï¼Œä¼šæ¯”è¾ƒå ç”¨ä½ æœåŠ¡å™¨çš„æ€§èƒ½è€ƒè™‘åˆ°å‡è½»æœåŠ¡å™¨æ€§èƒ½æ–¹é¢ï¼Œåº”å½“ä½¿ç”¨ COOKIEã€‚ å•ä¸ª cookie ä¿å­˜çš„æ•°æ®ä¸èƒ½è¶…è¿‡ 4Kï¼Œå¾ˆå¤šæµè§ˆå™¨éƒ½é™åˆ¶ä¸€ä¸ªç«™ç‚¹æœ€å¤šä¿å­˜ 20 ä¸ª cookieã€‚","tags":[{"name":"Node","slug":"Node","permalink":"http://tanyibing.com/tags/Node/"},{"name":"Koa","slug":"Koa","permalink":"http://tanyibing.com/tags/Koa/"}]},{"title":"åˆ†äº«æŒ‰é’®åŠŸèƒ½çš„å®ç°","date":"2018-09-05T09:07:22.000Z","path":"2018/09/05/åˆ†äº«æŒ‰é’®åŠŸèƒ½çš„å®ç°/","text":"Facebookåˆ†äº«åŠŸèƒ½äº‹é¡¹ä»Šå¤©éœ€è¦å®ç°ä¸€ä¸ªç‚¹å‡»æŒ‰é’®è¿›è¡Œåˆ†äº«çš„åŠŸèƒ½ï¼Œè€Œä¸”éœ€è¦æ˜¯å¤šå¹³å°ï¼Œä¹‹å‰äº†è§£è¿‡åº”è¯¥æ˜¯é€šè¿‡è°ƒç”¨å„ä¸ªå¹³å°çš„apiè¿›è¡Œå®ç°çš„ï¼Œæ²¡åŠæ³•ï¼Œå»ç½‘ä¸Šæ‰¾æ‰¾æ–¹æ³•å§ã€‚ é¦–å…ˆæ‰¾ä¸ªFacebookçš„å®ç°çœ‹çœ‹æ•ˆæœï¼Œå½“ä½ åªæ˜¯æƒ³åˆ†äº«ä¸€ä¸ªé“¾æ¥åˆ°facebookä¸­çš„æ—¶å€™ï¼Œæˆ‘ä»¬åªéœ€è¦å°†åˆ†äº«çš„urlä½œä¸ºå‚æ•°çš„å½¢å¼ä¼ é€’åˆ°facebookç½‘ç«™å³å¯ï¼Œå¦‚ä¸‹ï¼š â€œhttp://www.facebook.com/sharer/sharer.php?u=&quot; + url; å½“ç„¶ä¹Ÿå¯ä»¥å½“æˆå‚æ•°çš„å½¢å¼ä¼ é€’ï¼š &lt;!DOCTYPE html&gt; &lt;html lang=&quot;en&quot;&gt; &lt;head&gt; &lt;meta charset=&quot;UTF-8&quot;&gt; &lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, initial-scale=1.0&quot;&gt; &lt;meta http-equiv=&quot;X-UA-Compatible&quot; content=&quot;ie=edge&quot;&gt; &lt;title&gt;Document&lt;/title&gt; &lt;/head&gt; &lt;body&gt; &lt;input id=&quot;share_button&quot; type=&quot;button&quot; value=&quot;share to facebook&quot; /&gt; &lt;script type=&quot;text/JavaScript&quot;&gt; function popupwindow(url, title, w, h) { wLeft = window.screenLeft ? window.screenLeft : window.screenX; wTop = window.screenTop ? window.screenTop : window.screenY; var left = wLeft + (window.innerWidth / 2) - (w / 2); var top = wTop + (window.innerHeight / 2) - (h / 2); return window.open(url, title, &apos;toolbar=no, location=no, directories=no, status=no, menubar=no, scrollbars=no, resizable=no, copyhistory=no, width=&apos; + w + &apos;, height=&apos; + h + &apos;, top=&apos; + top + &apos;, left=&apos; + left); } window.onload = function () { document.getElementById(&apos;share_button&apos;).onclick = function(){ var shareUrl = &quot;http://www.facebook.com/sharer/sharer.php?u=https://www.google.com&quot;; popupwindow(shareUrl, &apos;Facebook&apos;, 600, 400); } } &lt;/script&gt; &lt;/body&gt; &lt;/html&gt; ä¸Šé¢è™½ç„¶åˆ†äº«æˆåŠŸäº†ï¼Œä½†æ˜¯åˆ†äº«çš„å†…å®¹æ˜¾å¾—å¾ˆæ­»æ¿ï¼Œåªæœ‰ä¸€äº›æ–‡å­—ï¼Œå¦‚ä½•è‡ªå®šä¹‰æˆ‘ä»¬çš„å†…å®¹å‘¢ï¼Ÿæˆ‘ä»¬éœ€è¦åœ¨è¢«åˆ†äº«çš„ç½‘ç«™çš„é¡µé¢ä¸Šæ·»åŠ ä¸€äº›metaæ ‡ç­¾ï¼Œfacebookä¼šè‡ªå·±ä»æ‰€åˆ†äº«çš„é¡µé¢ä¸Šå»æŠ“å–è¿™äº›æ ‡ç­¾é‡Œçš„å†…å®¹ï¼Œä½ å¯ä»¥è‡ªå®šä¹‰å›¾ç‰‡ã€æè¿°ç­‰ç­‰ã€‚ åœ¨å®šä¹‰äº†è¿™äº›ä¹‹åå°±æ›´åŠ ç”ŸåŠ¨äº†ï¼š &lt;meta property=&quot;og:title&quot; content=&quot;ç™¾åº¦&quot;&gt; &lt;meta property=&quot;og:type&quot; content=&quot;website&quot;&gt; &lt;meta property=&quot;og:image&quot; content=&quot;www.baidu.com/img/bd_logo1.png&quot;&gt; &lt;meta property=&quot;og:description&quot; content=&quot;ç™¾åº¦ä¸€ä¸‹ï¼Œä½ å°±çŸ¥é“&quot;&gt; å½“ç„¶ï¼Œä½ å¯èƒ½æƒ³åŠ¨æ€çš„å»ç”Ÿæˆè¿™äº›ä¸œè¥¿ï¼Œè¿™å°±å¤æ‚ä¸€äº›ï¼Œéœ€è¦ç”¨åˆ°facebookä¸­çš„Javascript SDK: &lt;script&gt; window.fbAsyncInit = function() { FB.init({ appId : &apos;your-app-id&apos;, autoLogAppEvents : true, xfbml : true, version : &apos;v2.10&apos; }); FB.AppEvents.logPageView(); }; (function(d, s, id){ var js, fjs = d.getElementsByTagName(s)[0]; if (d.getElementById(id)) {return;} js = d.createElement(s); js.id = id; js.src = &quot;//connect.facebook.net/en_US/sdk.js&quot;; fjs.parentNode.insertBefore(js, fjs); }(document, &apos;script&apos;, &apos;facebook-jssdk&apos;)); &lt;/script&gt; åœ¨ä»–ä»¬çš„å®˜ç½‘å¯ä»¥çœ‹æ›´å¤šã€‚ æˆ‘ä»¬è¿˜å¯ä»¥é€šè¿‡facebook developæ¥æ£€æµ‹ä½ è¦åˆ†äº«çš„ç½‘ç«™çš„æ•ˆæœï¼Œå¹¶ä¸”åœ¨è¿™é‡Œå¯ä»¥ç”Ÿæˆä½¿ç”¨sdkæ‰€éœ€è¦çš„appidï¼Œè€Œä¸”å¯ä»¥åœ¨è¿™é‡Œçœ‹åˆ°ç½‘å€çš„è¢«è½¬å‘æ•°ï¼Œç‚¹å‡»æ•°ä¹‹ç±»çš„ã€‚ è¿™æ ·å°±å®Œæˆfacebookçš„åˆ†äº«åŠŸèƒ½äº†ï¼Œä½†ä»–å–µçš„æ˜¯ä¸æ˜¯ä¹Ÿå¤ªéº»çƒ¦äº†ï¼Œæœæ–­æ‰¾æ‰¾æœ‰æ²¡æœ‰åˆ«çš„æ–¹æ³•ï¼Œéš¾é“ä½ è¿˜çœŸä»¥ä¸ºæˆ‘ä¼šä¸€ä¸ªä¸ªå†™ä¸‹å»ï¼ï¼ï¼ï¼Ÿï¼Ÿï¼Ÿç»“æœè¿˜çœŸæ‰¾åˆ°äº†ä¸€ä¸ªæ–¹æ³•ï¼Œé‚£å°±æ˜¯Mobä¸Šé¢çš„ShareSDKå•¦ã€‚ æ€ä¹ˆå®ç°ï¼Ÿé¦–å…ˆåœ¨é‡Œé¢æ‰¾åˆ°ä½ éœ€è¦çš„ç®€å•çš„ï¼Œé¦–å…ˆåœ¨ä¸‹å›¾ä¸­æ‰¾åˆ°ä½ è¦çš„ï¼Œç„¶åå‚»ç“œå¼å†™ä»£ç å°±è¡Œäº† &lt;!--MOB SHARE BEGIN--&gt; &lt;div class=&quot;-mob-share-ui-button -mob-share-open&quot;&gt;åˆ†äº«&lt;/div&gt; &lt;div class=&quot;-mob-share-ui&quot; style=&quot;display: none&quot;&gt; &lt;ul class=&quot;-mob-share-list&quot;&gt; &lt;li class=&quot;-mob-share-weibo&quot;&gt;&lt;p&gt;æ–°æµªå¾®åš&lt;/p&gt;&lt;/li&gt; &lt;li class=&quot;-mob-share-qzone&quot;&gt;&lt;p&gt;QQç©ºé—´&lt;/p&gt;&lt;/li&gt; &lt;li class=&quot;-mob-share-qq&quot;&gt;&lt;p&gt;QQå¥½å‹&lt;/p&gt;&lt;/li&gt; &lt;li class=&quot;-mob-share-douban&quot;&gt;&lt;p&gt;è±†ç“£&lt;/p&gt;&lt;/li&gt; &lt;li class=&quot;-mob-share-facebook&quot;&gt;&lt;p&gt;Facebook&lt;/p&gt;&lt;/li&gt; &lt;li class=&quot;-mob-share-twitter&quot;&gt;&lt;p&gt;Twitter&lt;/p&gt;&lt;/li&gt; &lt;/ul&gt; &lt;div class=&quot;-mob-share-close&quot;&gt;å–æ¶ˆ&lt;/div&gt; &lt;/div&gt; &lt;div class=&quot;-mob-share-ui-bg&quot;&gt;&lt;/div&gt; &lt;script id=&quot;-mob-share&quot; src=&quot;http://f1.webshare.mob.com/code/mob-share.js?appkey=ä½ çš„appkey&quot;&gt;&lt;/script&gt; &lt;!--MOB SHARE END--&gt; è¿™æ˜¯æœ€ç®€å•çš„ä¸€ç§ï¼Œè‡³äºæ€ä¹ˆæ‰©å±•ï¼Œæ–‡æ¡£å†™çš„å¾ˆæ¸…æ¥šï¼Œä¹Ÿå¾ˆå‚»ç“œå¼ï¼Œæˆ‘å°±ä¸å†å‚»ç“œå¼çš„å†™å‡ºæ¥äº†ï¼Œå½±å“æˆ‘çš„å½¢è±¡ã€‚å•¦å•¦å•¦å•¦ï¼ï¼ï¼","tags":[{"name":"Web SDK","slug":"Web-SDK","permalink":"http://tanyibing.com/tags/Web-SDK/"}]},{"title":"angularåº”ç”¨çš„æ„å»ºå’Œéƒ¨ç½²","date":"2018-09-04T02:11:32.000Z","path":"2018/09/04/angularåº”ç”¨çš„æ„å»ºå’Œéƒ¨ç½²/","text":"ç¬¬ä¸€æ­¥ æ„å»ºæˆ‘ä»¬çŸ¥é“æˆ‘ä»¬çš„angularåº”ç”¨æ˜¯ä½¿ç”¨Typescriptè¿›è¡Œç¼–å†™çš„ï¼Œè€Œæµè§ˆå™¨ä¸èƒ½ç›´æ¥è¿è¡ŒTypescriptï¼Œè€Œä¸”æˆ‘ä»¬çš„æ ·å¼å¯èƒ½æ˜¯ä½¿ç”¨scssç¼–å†™çš„ï¼Œæˆ‘ä»¬éœ€è¦å°†è¿™æ‰€æœ‰çš„ä¸€åˆ‡è¿›è¡Œæ•´åˆï¼Œæ„å»ºæˆæµè§ˆå™¨èƒ½çœ‹å¾—æ‡‚çš„æ–‡ä»¶ã€‚ç´¢æ€§çš„æ˜¯angular cliå·¥å…·å·²ç»å¸®æˆ‘ä»¬å‡†å¤‡å¥½äº†ä¸€åˆ‡ï¼Œæˆ‘ä»¬åªè¦æ‰§è¡Œä¸€æ¡å‘½ä»¤å°±è¡Œäº†ï¼š ng build ç„¶åæˆ‘ä»¬å°±å¾—åˆ°äº†è¿™æ ·ä¸€ä¸ªdistæ–‡ä»¶å¤¹ï¼Œè¿™æ ·æˆ‘ä»¬å°±å·²ç»æ„å»ºå¥½äº†ã€‚ ç¬¬äºŒæ­¥ éƒ¨ç½²éƒ¨ç½²ç®€å•å•Šï¼Œä¾‹å¦‚nodeçš„æœåŠ¡å™¨ï¼Œç›´æ¥æ–°å»ºä¸€ä¸ªç›®å½•ï¼Œç„¶åæŠŠdisté‡Œé¢çš„æ–‡ä»¶éƒ½å¤åˆ¶è¿›å»å°±è¡Œäº†ï¼Œè¿™æ ·å°±ç®—æ˜¯éƒ¨ç½²å®Œæˆäº†ã€‚ å¤šç¯å¢ƒé…ç½®ä¸ºäº†è®©æˆ‘ä»¬çš„é¡¹ç›®èƒ½åœ¨å¤šç§ç¯å¢ƒä¸‹éƒ½èƒ½è¿è¡Œï¼Œæˆ‘ä»¬éœ€è¦åšå¤šç¯å¢ƒé…ç½®ï¼Œå…·ä½“é…ç½®æ–¹æ³•è¿˜åœ¨ç ”ç©¶ä¸­ï¼","tags":[{"name":"Angular","slug":"Angular","permalink":"http://tanyibing.com/tags/Angular/"},{"name":"Typescript","slug":"Typescript","permalink":"http://tanyibing.com/tags/Typescript/"}]},{"title":"angularä¸­çš„ä¸¤ç§è¡¨å•","date":"2018-09-03T06:44:55.000Z","path":"2018/09/03/angularä¸­çš„ä¸¤ç§è¡¨å•/","text":"è¡¨å•formsæ˜¯å‰ç«¯ä¸­å¾ˆé‡è¦çš„ä¸€å—å†…å®¹ï¼ŒAngularä¸­åŒæ ·å¦‚æ­¤ã€‚åœ¨Angularä¸­ï¼Œæœ‰ä¸¤ç§è¡¨å•çš„å½¢å¼ï¼Œä¸€ç§æ˜¯æ¨¡æ¿é©±åŠ¨è¡¨å•ï¼Œè¿˜æœ‰ä¸€ç§æ˜¯å“åº”å¼è¡¨å•ã€‚æ¥ä¸‹æ¥å°±ç®€å•çš„ä»‹ç»ä¸€ä¸‹ï¼š æ¨¡ç‰ˆé©±åŠ¨è¡¨å•åŒºåˆ«ï¼šåªèƒ½åœ¨æ¨¡æ¿ä¸­æ“ä½œï¼Œä¸èƒ½åœ¨ä»£ç ä¸­æ“ä½œã€‚ä¸è¯´äº†ï¼Œç›´æ¥ä¸Šä¸ªè¡¨å•ï¼š &lt;form #myForm=&quot;ngForm&quot; (ngSubmit)=&quot;onSubmit(myForm.value)&quot;&gt; &lt;div&gt;ç”¨æˆ·åï¼š&lt;input ngModel name=&quot;username&quot; type=&quot;text&quot;&gt;&lt;/div&gt; &lt;div&gt;æ‰‹æœºå·ï¼š&lt;input ngModel name=&quot;mobile&quot; type=&quot;number&quot;&gt;&lt;/div&gt; &lt;div ngModelGroup=&quot;passwordsGroup&quot;&gt; &lt;div&gt;å¯†ç ï¼š&lt;input ngModel name=&quot;password&quot; type=&quot;password&quot;&gt;&lt;/div&gt; &lt;div&gt;ç¡®è®¤å¯†ç ï¼š&lt;input ngModel name=&quot;pconfirm&quot; type=&quot;password&quot;&gt;&lt;/div&gt; &lt;/div&gt; &lt;button type=&quot;submit&quot;&gt;æ³¨å†Œ&lt;/button&gt; &lt;/form&gt; å“åº”å¼è¡¨å•åŒºåˆ«ï¼šåªèƒ½åœ¨ä»£ç ä¸­æ“ä½œï¼Œä¸èƒ½åœ¨æ¨¡æ¿ä¸­æ“ä½œã€‚å“åº”å¼è¡¨å•ä¸€å…±åˆ†ä¸ºä¸¤æ­¥ï¼š åˆ›å»ºæ•°æ®æ¨¡å‹ç”±ä¸‰ä¸ªç±»ç»„æˆï¼šFormControlã€FormGroupã€FormArrayï¼Œæ€ä¹ˆåˆ›å»ºå‘¢ï¼Ÿç›´æ¥è´´å‡ºä»£ç ï¼š export class ReactiveFormComponent implements OnInit { username: FormControl = new FormControl(&apos;username&apos;); formModel: FormGroup = new FormGroup({ dateRange: new FormGroup({ from: new FormControl(), to: new FormControl() }), emails: FormArray = new FormArray([ new FormControl(&quot;a@a.com&quot;), new FormControl(&quot;b@b.com&quot;) ]); }); } ä½¿ç”¨å“åº”å¼è¡¨å•æŒ‡ä»¤ç»‘å®šè¡¨å•æ¨¡ç‰ˆ html &lt;form [formGroup]=&quot;formModel&quot; (submit)=&quot;onSubmit()&quot;&gt; &lt;div formGroupName=&quot;dateRange&quot;&gt; èµ·å§‹æ—¥æœŸï¼š&lt;input type=&quot;date&quot; formControlName=&quot;from&quot;&gt; æˆªæ­¢æ—¥æœŸï¼š&lt;input type=&quot;date&quot; formControlName=&quot;to&quot;&gt; &lt;/div&gt; &lt;div&gt; &lt;ul formArryName=&quot;emails&quot;&gt; &lt;li *ngFor=&quot;let e of this.formModel.get(&apos;emails&apos;).controls; let i = index;&quot;&gt; &lt;input type=&quot;text&quot; [formControlName]=&quot;i&quot;&gt; &lt;/li&gt; &lt;/ul&gt; &lt;button type=&quot;button&quot; (click)=&quot;addEmail()&quot;&gt;å¢åŠ email&lt;/button&gt; &lt;/div&gt; &lt;div&gt; &lt;button type=&quot;submit&quot;&gt;ä¿å­˜&lt;/button&gt; &lt;/div&gt; &lt;/form&gt; js addEmail(){ let emails = this.formModel.get(&quot;emails&quot;) as FormArray; emails.push(new FormControl()); } è¿™æ ·çœ‹ä¸Šå»æ˜¯ä¸æ˜¯ä»£ç å¾ˆå¤šï¼Œæœ‰ä¸ªç®€åŒ–çš„æ–¹æ³•å°±æ˜¯ä½¿ç”¨FormBuilderï¼Œä½¿ç”¨é¦–å…ˆè¦å¼•å…¥ï¼Œç„¶åå†constructorä¸­æ³¨å†Œï¼Œç„¶åç»™ä¸ªå¯¹æ¯”å§ï¼š profileForm = new FormGroup({ firstName: new FormControl(&apos;&apos;), lastName: new FormControl(&apos;&apos;), address: new FormGroup({ street: new FormControl(&apos;&apos;), city: new FormControl(&apos;&apos;), state: new FormControl(&apos;&apos;), zip: new FormControl(&apos;&apos;) }) }); ä¸Šé¢çš„ç­‰åŒäºï¼š profileForm = this.fb.group({ firstName: [&apos;&apos;], lastName: [&apos;&apos;], address: this.fb.group({ street: [&apos;&apos;], city: [&apos;&apos;], state: [&apos;&apos;], zip: [&apos;&apos;] }), }); FormGroupç”¨this.fb.groupæ›¿ä»£ï¼ŒFormContrlç”¨[&#39;&#39;]æ›¿ä»£,æ€ä¹ˆè¿›è¡Œæ ¡éªŒï¼Œæˆ‘çš„å¤©ï¼Œåˆæ˜¯å¥½å¤šå­—ï¼Œä»Šå¤©å°±å…ˆè¿™æ ·å§ï¼ï¼ï¼åæ­£æ˜¯æˆ‘è‡ªå·±çœ‹çš„ï¼Œæˆ‘è®°å¾—å°±è¡Œäº†ï¼ï¼ï¼å“ˆå“ˆå“ˆï¼ï¼ï¼","tags":[{"name":"Angular","slug":"Angular","permalink":"http://tanyibing.com/tags/Angular/"},{"name":"Typescript","slug":"Typescript","permalink":"http://tanyibing.com/tags/Typescript/"}]},{"title":"angularç”Ÿå‘½å‘¨æœŸé’©å­","date":"2018-09-02T14:40:24.000Z","path":"2018/09/02/angularç”Ÿå‘½å‘¨æœŸé’©å­/","text":"Angularä¸­æ¯ä¸ªç»„ä»¶éƒ½æœ‰å®ƒçš„ç”Ÿå‘½å‘¨æœŸï¼Œä»åˆ›å»ºã€æ¸²æŸ“ï¼Œåˆ°å˜æ›´æ£€æµ‹ï¼Œå†åˆ°æœ€åçš„é”€æ¯è¿‡ç¨‹è¿‡ç¨‹ï¼ŒAngularä¸€å…±æä¾›äº†å…«ä¸ªç”Ÿå‘½å‘¨æœŸé’©å­ï¼Œä»–ä»¬æŒ‰ç…§é¡ºåºåˆ†åˆ«æ˜¯ï¼šconstructorã€ngOnChangesã€ngOnInitã€ngDoCheckã€ngAfterContentInitã€ngAfterContentCheckedã€ngAfterViewInitã€ngAfterViewCheckedã€ngOnDestroyï¼Œå…¶ä¸­æœ‰çš„é’©å­åœ¨ç”Ÿå‘½å‘¨æœŸå†…åªè°ƒç”¨ä¸€æ¬¡ï¼Œæœ‰çš„åˆ™å¯ä»¥åå¤è°ƒç”¨ï¼ˆå˜æ›´æ£€æµ‹æœºåˆ¶ä¸­éœ€è¦è°ƒç”¨æ–¹æ³•ï¼‰ã€‚å¦‚ä¸‹å›¾ï¼š å…¶ä¸­çº¢è‰²çš„è¡¨ç¤ºåªè°ƒä¸€æ¬¡ï¼Œç»¿è‰²çš„åˆ™å¯ä»¥è¢«å¤šæ¬¡è°ƒç”¨ã€‚æˆ‘ä»¬å°†ä»‹ç»å…¶ä¸­é‡è¦çš„å‡ ä¸ªæ–¹æ³•ã€‚ ngOnChanges:è¿™ä¸ªé’©å­åœ¨çˆ¶ç»„ä»¶åˆå§‹åŒ–æˆ–ä¿®æ”¹å­ç»„ä»¶çš„è¾“å…¥å±æ€§æ—¶ä¼šè¢«è°ƒç”¨ã€‚æƒ³è¦ç†è§£è¿™ä¸ªæ–¹æ³•ä¸ºä»€ä¹ˆä¼šè¢«è°ƒç”¨æˆ–ä¸è¢«è°ƒç”¨ï¼Œæˆ‘ä»¬éœ€è¦äº†è§£å¯å˜å¯¹è±¡å’Œä¸å¯å˜å¯¹è±¡ï¼Œåœ¨jsä¸­ï¼Œå­—ç¬¦ä¸²æ˜¯ä¸å¯å˜å¯¹è±¡ï¼Œä½†ä¸€ä¸ªå¯¹è±¡æ˜¯ä¸€ä¸ªå¯å˜å¯¹è±¡ï¼Œè‡³äºä¸ºä»€ä¹ˆï¼Œè¯·è‡ªè¡Œç™¾åº¦ã€‚æœ€åçš„ç»“è®ºæ˜¯ï¼šå½“è¾“å…¥å±æ€§æ˜¯å˜å¯¹è±¡ä¾‹å¦‚å¯¹è±¡æ—¶ï¼Œå¯¹è±¡çš„å±æ€§å‘ç”Ÿå˜åŒ–å¹¶ä¸ä¼šè§¦å‘ngOnChangesæ–¹æ³•ï¼›å½“è¾“å…¥å±æ€§æ˜¯ä¸å¯å˜å¯¹è±¡ä¾‹å¦‚å­—ç¬¦ä¸²æ—¶ï¼Œå­—ç¬¦ä¸²æ”¹å˜ä¼šè§¦å‘ngOnChangesæ–¹æ³•ã€‚è¿˜éœ€è¦æ³¨æ„ä¸€ç‚¹å°±æ˜¯ï¼šngOnChangesæ–¹æ³•é¦–æ¬¡è°ƒç”¨ä¸€å®šæ˜¯å‘ç”Ÿåœ¨ngOninitæ–¹æ³•ä¹‹å‰çš„ã€‚ ngDoCheck:å˜æ›´æ£€æµ‹å¯ä»¥è¯´æ˜¯Angularä¸­æœ€å¤æ‚çš„æ¨¡å—ï¼š angularæœ‰ä¸¤ç§å˜æ›´æ£€æµ‹æœºåˆ¶ï¼Œä¸€ç§æ˜¯Defaultç­–ç•¥ï¼Œä¸€ç§æ˜¯OnPushç­–ç•¥ã€‚Defaultç­–ç•¥ä¼šåœ¨ç»„ä»¶å‘ç”Ÿå˜åŒ–æ—¶å»æ£€æŸ¥ç»„ä»¶æ ‘ä¸­æ‰€æœ‰ç»„ä»¶ï¼Œè€Œä½¿ç”¨OnPushçš„ç»„ä»¶åªä¼šåœ¨å…¶è¾“å…¥å±æ€§å‘ç”Ÿå˜åŒ–æ—¶å»æ£€æŸ¥å®ƒã€‚å½“æˆ‘ä»¬å¯¹æ€§èƒ½è¦æ±‚æ¯”è¾ƒé«˜çš„æ—¶å€™ï¼Œä¾‹å¦‚æœ‰å¤§é‡çš„è¡¨æ ¼æ•°æ®åœ¨æ—¶æ—¶å‘ç”Ÿå˜åŒ–æ—¶ï¼Œè¿™ä¸¤ç§ç­–ç•¥çš„æ­£ç¡®é€‰æ‹©å°±æ˜¾å¾—å°¤ä¸ºé‡è¦ã€‚åœ¨ngOnChangesä¸­æˆ‘ä»¬çŸ¥é“ å½“è¾“å…¥å±æ€§æ˜¯å¯å˜å¯¹è±¡ä¾‹å¦‚å¯¹è±¡æ—¶ï¼Œå¯¹è±¡çš„å±æ€§å‘ç”Ÿå˜åŒ–å¹¶ä¸ä¼šè§¦å‘ngOnChangesæ–¹æ³•ã€‚ é‚£ä¹ˆæ€ä¹ˆæ£€æµ‹å¯¹è±¡çš„å±æ€§å‘¢ï¼Œè¿™æ—¶å°±éœ€è¦ç”¨åˆ°ngDoCheckæ–¹æ³•äº†ã€‚checkçš„è°ƒç”¨ååˆ†é¢‘ç¹ï¼Œå‘ç”Ÿä¸€ç‚¹ç‚¹åŠ¨é™éƒ½ä¼šè°ƒç”¨checkæ–¹æ³•ï¼Œå°±æ¯”å¦‚æˆ‘ä»¬çš„é¼ æ ‡å…‰æ ‡åˆ‡æ¢inputä½†æ˜¯æ²¡æœ‰æ”¹å˜å€¼æ¡†è¿™ç±»çš„åŠ¨ä½œï¼Œç»„ä»¶æ ‘ä¸Šæ‰€æœ‰çš„æœ‰checkå…³é”®å­—é’©å­éƒ½ä¼šè°ƒç”¨ï¼Œæ‰€ä»¥ï¼Œæˆ‘ä»¬çš„æ‰€æœ‰checkæ–¹æ³•ä¸€å®šè¦å°å¿ƒï¼Œä¸€å®šè¦é«˜æ•ˆï¼Œä¸€å®šè¦è½»é‡çº§ã€‚ ngAfterViewInit &amp; ngAfterViewChecked:é¡¾åæ€ä¹‰ï¼Œè¿™ä¸¤ä¸ªæ–¹æ³•éƒ½æ˜¯è·Ÿç»„ä»¶çš„è§†å›¾å¯†åˆ‡ç›¸å…³çš„ï¼Œå‰è€…æ˜¯åœ¨è§†å›¾éƒ½ç»„å»ºå®Œæ¯•ä¹‹åæ‰è°ƒç”¨ï¼Œåè€…æ˜¯åœ¨è§†å›¾å‘ç”Ÿå˜åŒ–æ—¶è°ƒç”¨ï¼Œå€¼å¾—æ³¨æ„çš„æ˜¯ï¼š è¿™ä¸¤ä¸ªæ–¹æ³•éƒ½æ˜¯åœ¨è§†å›¾ç»„å»ºå®Œæ¯•ä¹‹åè¢«è°ƒç”¨çš„ï¼› å¦‚æœçˆ¶ç»„ä»¶å­˜åœ¨å­ç»„ä»¶ï¼Œé‚£ä¹ˆçˆ¶ç»„ä»¶çš„è¿™ä¸¤ä¸ªæ–¹æ³•ä¼šåœ¨æ‰€æœ‰å­ç»„ä»¶çš„è§†å›¾éƒ½ç»„å»ºå®Œæ¯•åè°ƒç”¨ï¼› ä¸è¦æ—©åœ¨è¿™ä¸¤ä¸ªæ–¹æ³•é‡Œé¢å»æ”¹å˜è§†å›¾ä¸­ç»‘å®šçš„ä¸œè¥¿ï¼Œè¿™æ ·åšä¼šæŠ¥é”™ã€‚å¦‚æœçœŸçš„éœ€è¦ä¿®æ”¹ï¼Œéœ€è¦å†™åœ¨ä¸€ä¸ªtimeoutæ–¹æ³•é‡Œé¢ã€‚ ngAfterContentInit &amp; ngAfterContentChecked:è¦ä½¿ç”¨è¿™ä¸¤ä¸ªæ–¹æ³•ï¼Œå°±å¾—å†è¯´åˆ°ä¸€ä¸ªng-contentæŠ•å½±ï¼Œä»€ä¹ˆæ˜¯å†…å®¹æŠ•å½±å‘¢ï¼Ÿå°±æ˜¯ä»ç»„ä»¶å¤–éƒ¨å¯¼å…¥HTMLå†…å®¹ï¼Œå¹¶æŠŠå®ƒæ’åœ¨ç»„ä»¶ä¸­æŒ‡å®šä½ç½®ä¸Šçš„ä¸€ç§é€”å¾„ï¼Œä¸¾ä¸ªä¾‹å­ï¼Œæˆ‘ä»¬åœ¨å­ç»„ä»¶æ¨¡æ¿ä¸­è¿™æ ·å®šä¹‰ä¸€ä¸ªæŠ•å½±ç‚¹ï¼š &lt;ng-content&gt;&lt;/ng-content&gt; è¿™æ ·æˆ‘ä»¬åœ¨çˆ¶ç»„ä»¶ä¸­å¯ä»¥å®šä¹‰ï¼š &lt;app-child&gt; //è¿™é‡Œé¢å¯ä»¥å†™æƒ³æŠ•å½±åˆ°å­ç»„ä»¶çš„å†…å®¹ &lt;/app-child&gt; è¿™æ ·æˆ‘ä»¬å°±å°†çˆ¶ç»„ä»¶ä¸­çš„å†…å®¹æŠ•å½±åˆ°äº†å­ç»„ä»¶ä¸­ã€‚ä¸ä»…å¦‚æ­¤ï¼Œæˆ‘ä»¬è¿˜èƒ½åŒæ—¶æŠ•å½±å¤šä¸ªå†…å®¹ï¼Œåœ¨çˆ¶ç»„ä»¶ä¸­è¿™æ ·å®šä¹‰ï¼š &lt;app-child&gt; //è¿™é‡Œé¢å¯ä»¥å†™æƒ³æŠ•å½±åˆ°å­ç»„ä»¶çš„å†…å®¹ &lt;div class=&apos;header&apos;&gt;{{title}}&lt;/div&gt; &lt;div class=&apos;footer&apos;&gt;{{content}}&lt;/div&gt; &lt;/app-child&gt; ç„¶åå†å­ç»„ä»¶ä¸­å¯ä»¥è¿™æ ·æ¥æ”¶ï¼š &lt;ng-content select=&apos;.header&apos;&gt;&lt;/ng-content&gt; &lt;ng-content select=&apos;.footer&apos;&gt;&lt;/ng-content&gt; è¿™æ ·æˆ‘ä»¬ä¸ä»…å°†ä¸¤ä¸ªHTMLç‰‡æ®µæŠ•å½±åˆ°å­ç»„ä»¶ä¸­ï¼Œè¿˜å°†çˆ¶ç»„ä»¶æ§åˆ¶å™¨ä¸­çš„titleã€contenté€šè¿‡æ’å€¼è¡¨è¾¾å¼æŠ•å½±åˆ°äº†å­ç»„ä»¶ä¸­ã€‚ngAfterContentInitå’ŒngAfterViewInitä¸åŒçš„æ˜¯ï¼šngAfterViewInitä¸èƒ½å¤Ÿæ”¹å˜è§†å›¾ä¸­ç»‘å®šçš„å€¼ï¼Œè€Œåœ¨ngAfterContentInitä¸­æ˜¯å¯ä»¥çš„ï¼Œä¸ä¼šæŠ¥é”™ã€‚å› ä¸ºåœ¨ngAfterContentInitçš„æ—¶å€™ï¼Œè§†å›¾è¿˜æ²¡æœ‰ç»„è£…å®Œæ¯•ï¼Œåªæ˜¯æŠ•å½±è¿›æ¥çš„å†…å®¹è¢«ç»„è£…å®Œæ¯•äº†ã€‚ ngOnDestroyç»„ä»¶ä»€ä¹ˆæ—¶å€™è¢«é”€æ¯å‘¢ï¼Œå°±æ˜¯è·¯ç”±åˆ°åˆ«å¤„çš„æ—¶å€™ï¼Œå½“å‰ç»„ä»¶ä¼šè¢«é”€æ¯ï¼Œåˆ›å»ºæ–°çš„è·¯ç”±çš„ç»„ä»¶ã€‚åœ¨è¿™ä¸€èˆ¬æ˜¯ç”¨æ¥é‡Šæ”¾é‚£äº›ä¸ä¼šè¢«åƒåœ¾æ”¶é›†å™¨è‡ªåŠ¨å›æ”¶çš„å„ç±»èµ„æºçš„åœ°æ–¹ã€‚å–æ¶ˆé‚£äº›å¯¹å¯è§‚å¯Ÿå¯¹è±¡å’Œ DOM äº‹ä»¶çš„è®¢é˜…ã€‚åœæ­¢å®šæ—¶å™¨ã€‚æ³¨é”€è¯¥æŒ‡ä»¤æ›¾æ³¨å†Œåˆ°å…¨å±€æœåŠ¡æˆ–åº”ç”¨çº§æœåŠ¡ä¸­çš„å„ç§å›è°ƒå‡½æ•°ã€‚å¦‚æœä¸è¿™ä¹ˆåšï¼Œå°±ä¼šæœ‰å¯¼è‡´å†…å­˜æ³„éœ²çš„é£é™©ã€‚","tags":[{"name":"Angular","slug":"Angular","permalink":"http://tanyibing.com/tags/Angular/"},{"name":"Typescript","slug":"Typescript","permalink":"http://tanyibing.com/tags/Typescript/"}]},{"title":"angularä¸­ç»„ä»¶ä¹‹é—´å¦‚ä½•é€šä¿¡(äºŒ)","date":"2018-09-01T11:19:43.000Z","path":"2018/09/01/angularä¸­ç»„ä»¶ä¹‹é—´å¦‚ä½•é€šä¿¡ï¼ˆäºŒï¼‰/","text":"æ¥ç€ä¸Šä¸€ç¯‡çš„å†…å®¹ï¼Œä¸Šä¸€ç¯‡æœ€åè¯´åˆ°æœ‰å…¬å…±çˆ¶ç»„ä»¶çš„ç»„ä»¶ä¹‹é—´æ˜¯å¦‚ä½•é€šä¿¡çš„ï¼Œæœ€åè¿˜æœ‰ä¸€ä¸ªé—®é¢˜æ²¡æœ‰è§£å†³ã€‚ä½†æ˜¯åœ¨è¿™ä¹‹å‰æˆ‘éœ€è¦è¡¥å……ä¸€ä¸‹ï¼Œçˆ¶ç»„ä»¶å’Œå­ç»„ä»¶ä¹‹é—´çš„é€šä¿¡è¿˜æœ‰ä¸€ç§æ–¹å¼ï¼Œé‚£å°±æ˜¯é€šè¿‡æœ¬åœ°å˜é‡æˆ–è€…ä½¿ç”¨@ViewChiadæ¥è¿›è¡Œä¼ é€’ï¼Œä¸¾ä¸ªä¾‹å­ï¼š export class childComponent { private sayHello() { console.log(&apos;Hello&apos;); } } æˆ‘åœ¨å­ç»„ä»¶ä¸­å®šä¹‰è¿™æ ·ä¸€ä¸ªæ–¹æ³•ï¼Œæˆ‘æ€ä¹ˆåœ¨çˆ¶ç»„ä»¶ä¸­è°ƒç”¨å‘¢ï¼Œä¸€ä¸ªæ˜¯é€šè¿‡æœ¬åœ°å˜é‡çš„æ–¹æ³•ï¼š &lt;app-child #child1&gt;&lt;/app-child&gt; &lt;button (click)=&quot;child1.syaHello()&quot;&gt;sayHello&lt;/button&gt; æˆ‘åœ¨çˆ¶ç»„ä»¶çš„æ¨¡æ¿ä¸­ä½¿ç”¨å­ç»„ä»¶å¹¶åŠ ä¸Š#child1è¿™ä¸ªå±æ€§ï¼Œç„¶åå°±å¯ä»¥åœ¨çˆ¶ç»„ä»¶çš„æ¨¡ç‰ˆä¸­ç›´æ¥è°ƒç”¨å­ç»„ä»¶çš„æ–¹æ³•äº†ã€‚ä½†æ˜¯æˆ‘ä»¬å‘ç°çˆ¶ç»„ä»¶çš„æ§åˆ¶å™¨å¹¶ä¸èƒ½è°ƒç”¨åˆ°è¿™ä¸ªæ–¹æ³•ï¼Œäºæ˜¯ï¼Œæˆ‘ä»¬å°±å¯ä»¥ä½¿ç”¨@ViewChiadï¼š export class ParentComponent { @ViewChild(&apos;child1&apos;) private child: ChildComponent;//å£°æ˜ä¸€ä¸ªå­ç»„ä»¶ sayBay() { this.child.sayHello(); } } è¿™æ ·æˆ‘ä»¬å°±å®ç°äº†åœ¨çˆ¶ç»„ä»¶çš„æ§åˆ¶å™¨ä¸­è°ƒç”¨å­ç»„ä»¶çš„æ–¹æ³•ã€‚ æ¥ä¸‹æ¥æˆ‘ä»¬å°±è®¨è®ºä¸€ä¸‹æœ€åä¸€ä¸ªé—®é¢˜ï¼šå½“ç»„ä»¶ä¹‹é—´æ²¡æœ‰å…¬å…±çš„çˆ¶ç»„ä»¶æ—¶ï¼Œå®ƒä»¬åº”è¯¥å¦‚ä½•é€šä¿¡å‘¢ï¼Ÿç­”æ¡ˆå°±æ˜¯ä½¿ç”¨æœåŠ¡è¿›è¡Œé€šä¿¡ã€‚ã€‚ã€‚loading","tags":[{"name":"Angular","slug":"Angular","permalink":"http://tanyibing.com/tags/Angular/"},{"name":"Typescript","slug":"Typescript","permalink":"http://tanyibing.com/tags/Typescript/"}]},{"title":"angularä¸­ç»„ä»¶ä¹‹é—´å¦‚ä½•é€šä¿¡","date":"2018-08-31T07:27:24.000Z","path":"2018/08/31/angularä¸­ç»„ä»¶ä¹‹é—´å¦‚ä½•é€šä¿¡/","text":"åœ¨angularä¸­ï¼Œæˆ‘ä»¬ä¼šè®¾è®¡å¾ˆå¤šçš„componentç»„ä»¶ï¼Œä¹Ÿå°±ç”Ÿæˆäº†ç»„ä»¶æ ‘ï¼Œç»„ä»¶ä¹‹é—´æœ‰å¯èƒ½æ˜¯çˆ¶å­ç»„ä»¶ï¼Œæˆ–è€…å…„å¼Ÿç»„ä»¶ï¼Œæˆ–è€…å½¼æ­¤éƒ½æ²¡æœ‰å…³ç³»ã€‚é‚£ä¹ˆè¿™ä¹ˆå¤šç»„ä»¶ä¹‹é—´è¯¥å¦‚ä½•é€šè®¯å‘¢ï¼Ÿä¸‹é¢æˆ‘ä»¬å°±ç®€ç­”çš„äº†è§£äº†è§£ã€‚ çˆ¶å­ç»„ä»¶ä¹‹é—´çš„é€šè®¯çˆ¶å­ä¹‹é—´çš„é€šè®¯æ¯”è¾ƒç®€å•ï¼Œæˆ‘ä»¬éœ€è¦ç”¨åˆ°@Inputè¾“å…¥å±æ€§å’Œ@Outputè¾“å‡ºå±æ€§ã€‚å½“æˆ‘ä»¬éœ€è¦ä»çˆ¶ç»„ä»¶å‘å­ç»„ä»¶ä¼ é€’ä¿¡æ¯æ—¶ï¼Œæˆ‘ä»¬é¦–å…ˆéœ€è¦ä¸ºå­ç»„ä»¶å®šä¹‰ä¸€ä¸ªå±æ€§ï¼š export class childComponent { @Input() hero: Hero; } è¢«@Inputä¿®é¥°çš„å±æ€§å°±å³å°†æ¥å—ä»çˆ¶ç»„ä»¶ä¼ è¿‡æ¥çš„ä¿¡æ¯ã€‚å…·ä½“æ€ä¹ˆä¼ å€¼å‘¢ï¼Ÿæˆ‘ä»¬åœ¨çˆ¶ç»„ä»¶ä¸­é€šè¿‡å­ç»„ä»¶çš„å±æ€§è¿›è¡Œä¼ å€¼ï¼š &lt;app-child [hero]=&quot;æ§åˆ¶å™¨ä¸­çš„å±æ€§å€¼&quot;&gt;&lt;/app-child&gt; æˆ‘ä»¬åœ¨çˆ¶ç»„ä»¶çš„æ¨¡æ¿ä¸­è°ƒç”¨å­ç»„ä»¶æ—¶ï¼Œåªè¦åœ¨å­ç»„ä»¶ä¸­å¯¹heroå±æ€§è¿›è¡Œç»‘å®šå°±è¡Œäº†ã€‚æ˜¯ä¸æ˜¯å¾ˆç®€å•ï¼Ÿè€Œä»å­ç»„ä»¶å‘çˆ¶ç»„ä»¶ä¼ å€¼ä¹Ÿå¾ˆç®€å•ï¼Œå…¶å®å°±æ˜¯ä¸€ä¸ªåå‘çš„è¿‡ç¨‹ï¼Œæˆ‘ä»¬éœ€è¦å€ŸåŠ©EventEmitterçš„è®¢é˜…å’Œå¹¿æ’­çš„åŠŸèƒ½å°±å¯ä»¥äº†ï¼Œé¦–å…ˆæˆ‘ä»¬åœ¨å­ç»„ä»¶ä¸­å®šä¹‰è¦ä¼ è¾“å‡ºå»çš„å±æ€§å€¼ï¼š export class childComponent { @Output() voted = new EventEmitter&lt;boolean&gt;(); didVote = false; vote(agreed: boolean) { this.voted.emit(agreed); this.didVote = true; } } æˆ‘ä»¬å°†è¦è¾“å‡ºçš„æ˜¯é€šè¿‡EventEmitterè¿›è¡Œå®ä¾‹åŒ–ï¼Œç„¶ååœ¨éœ€è¦çš„æ—¶å€™è§¦å‘.emit(agreed)äº‹ä»¶å°±èƒ½å°†æ•°æ®ä¼ å‡ºå»ã€‚é‚£æ¥ä¸‹æ¥æˆ‘ä»¬éœ€è¦åœ¨çˆ¶ç»„ä»¶ä¸­è¿›è¡Œæ¥æ”¶ï¼š &lt;app-child (voted)=&quot;onVoted($event)&quot;&gt;&lt;/app-child&gt; æˆ‘ä»¬åœ¨çˆ¶ç»„ä»¶æ¨¡æ¿ä¸­çš„å­ç»„ä»¶ä¸ŠåŠ ä¸Šä¸€ä¸ªäº‹ä»¶ç»‘å®šï¼Œå¹¶ä¸”åœ¨çˆ¶ç»„ä»¶ä¸­å®šä¹‰onVoted()æ–¹æ³•ï¼š export class ParentComponent { agreed = 0; disagreed = 0; onVoted(event: boolean) {//eventå°±æ˜¯ä¼ é€’è¿‡æ¥çš„æ•°æ® agreed ? this.agreed++ : this.disagreed++; } åœ¨çˆ¶ç»„ä»¶çš„æ–¹æ³•ä¸­çš„å‚æ•°å°±æ˜¯æˆ‘ä»¬ä»å­ç»„ä»¶ä¸­æ‹¿åˆ°çš„æ•°æ®ã€‚è¿™æ ·å°±æˆåŠŸçš„ä¼ é€’å‡ºäº†ä¿¡æ¯ã€‚ä½†æ˜¯éœ€è¦æ³¨æ„çš„æ˜¯ï¼šé»˜è®¤æƒ…å†µä¸‹çˆ¶ç»„ä»¶æ¨¡æ¿ä¸­æ•è·äº‹ä»¶çš„åå­—å’Œå­ç»„ä»¶ä¸­è¾“å‡ºå±æ€§çš„åå­—æ˜¯ä¸€æ ·çš„ï¼Œéƒ½æ˜¯votedï¼ï¼ï¼ä½†æ˜¯æˆ‘ä»¬ä¹Ÿå¯ä»¥é€šè¿‡è¾“å‡ºå±æ€§æ¥é‡å‘½åï¼š @Output(&apos;XXX&apos;)//è¿™æ ·å°±å¯ä»¥æ”¹æ‰è¾“å‡ºå±æ€§çš„åå­—ï¼ŒåŒæ ·çš„æ•è·äº‹ä»¶çš„åå­—ä¹Ÿè¦åŒæ­¥æ”¹è¿‡æ¥ã€‚ ä¸­é—´äººæ¨¡å¼çˆ¶å­ç»„ä»¶ä¹‹é—´ä¼ é€’æ•°æ®å®¹æ˜“å®ç°ï¼Œä½†æ˜¯å½“æˆ‘ä»¬çš„ç»„ä»¶ä¸æ˜¯çˆ¶å­å…³ç³»çš„æ—¶å€™æˆ‘ä»¬åº”è¯¥æ€ä¹ˆä¼ é€’æ•°æ®ï¼Ÿè¿™å°±è¦ç”¨åˆ°æˆ‘ä»¬çš„ä¸­é—´äººæ¨¡å¼äº†ã€‚ ä¸­é—´äººæ¨¡å¼æœ€ç®€å•çš„ä¸€ç§å…³ç³»å°±æ˜¯ä¸¤ä¸ªç»„ä»¶æœ‰å…±åŒçš„çˆ¶ç»„ä»¶ï¼Œä¹Ÿå°±æ˜¯ä¸¤ä¸ªç»„ä»¶æ˜¯å…„å¼Ÿå…³ç³»ã€‚ä½†æ˜¯è¿™ä¸ªæ¯”å–»ä¸è´´åˆ‡ï¼Œä»–ä»¬åªæ˜¯æ‹¥æœ‰å…±åŒçš„çˆ¶ç»„ä»¶ï¼Œå…¶å®ä»–ä»¬ä¸¤ä¹‹é—´è°éƒ½ä¸è®¤è¯†è°ã€‚é‚£ä¹ˆä»–ä»¬ä¹‹é—´æ€ä¹ˆé€šä¿¡å‘¢ï¼Ÿå°±æŠŠçˆ¶ç»„ä»¶å½“æˆä¸­é—´äººå°±è¡Œäº†ï¼š export class childOneComponent { @Output() voted = new EventEmitter&lt;boolean&gt;(); didVote = false; vote(agreed: boolean) { this.voted.emit(agreed); this.didVote = true; } } é¦–å…ˆè¿˜æ˜¯ä¸€ä¸ªç»„ä»¶ä¸­è¾“å‡ºä¸€ä¸ªå±æ€§ï¼Œå¹¶åœ¨é€‚å½“çš„æ—¶è§¦å‘å¹¿æ’­çš„è¡Œä¸ºï¼Œå°†æˆ‘ä»¬çš„æ•°æ®å‘é€å‡ºå»ã€‚æ¥ç€éœ€è¦åœ¨çˆ¶ç»„ä»¶ä¸­ç›‘å¬votedè¿™ä¸ªäº‹ä»¶ï¼š &lt;app-child-one (voted)=&quot;veteHandler($event)&quot;&gt;&lt;/app-child-one&gt; æˆ‘ä»¬çš„å¦ä¸€ä¸ªå­ç»„ä»¶éœ€è¦æœ‰ä¸ªè¾“å…¥å±æ€§ï¼š export class childTwoComponent { @Input() voteCount; } æ—¢ç„¶æ˜¯æˆ‘ä»¬çš„ä¸­é—´äººï¼Œå®ƒå°±åº”è¯¥å…ˆæ¥æ”¶å®ƒæ”¶åˆ°çš„æ•°æ®ï¼Œç„¶åå°†æ•°æ®å†ä¼ ç»™éœ€è¦çš„äººã€‚è¿™å°±å¾ˆç®€å•å•¦ï¼š export class ParentComponent { voteCount; veteHandler(event: boolean) {//eventå°±æ˜¯ä¼ é€’è¿‡æ¥çš„æ•°æ® this.voteCount = event; } æˆ‘æƒ³ä½ å·²ç»çŒœåˆ°ä¸‹ä¸€æ­¥åº”è¯¥æ€ä¹ˆåŠäº†ï¼Œæˆ‘ä»¬å°†çˆ¶ç»„ä»¶æ¥å—çš„æ•°æ®ä¼ ç»™å¦ä¸€ä¸ªå­ç»„ä»¶å°±è¡Œäº†ï¼Œæ€ä¹ˆä¼ ï¼Ÿé€šè¿‡å±æ€§ç»‘å®šæ¥ä¼ é€’å•Šï¼š &lt;app-child-one (voted)=&quot;veteHandler($event)&quot;&gt;&lt;/app-child-one&gt; &lt;app-child-two [voteCount]=&quot;voteCount&quot;&gt;&lt;/app-child-two&gt; è¿™æ ·æˆ‘è¿™ä¸ªä¸­é—´äººçš„èŒè´£å°±å®Œæˆå•¦ï¼ŒæˆåŠŸå°†ä¸€ä¸ªç»„ä»¶ä¼ é€’ç»™å¦ä¸€ä¸ªç»„ä»¶ã€‚è€Œä¸”ä»–ä»¬ä¸¤äº’ç›¸ä¹‹é—´æ ¹æœ¬ä¸çŸ¥æƒ…ã€‚ é‚£ä¹ˆæ²¡æœ‰å…±åŒçš„çˆ¶ç»„ä»¶çš„ç»„ä»¶ä¹‹é—´éš¾é“å°±ä¸èƒ½é€šè®¯äº†å—ï¼Ÿç­”æ¡ˆè‚¯å®šæ˜¯ä¸æ˜¯çš„ï¼Œæˆ‘å°†åœ¨ä¸‹ä¸€ç¯‡åšå®¢ä¸­å›ç­”ï¼","tags":[{"name":"Angular","slug":"Angular","permalink":"http://tanyibing.com/tags/Angular/"},{"name":"Typescript","slug":"Typescript","permalink":"http://tanyibing.com/tags/Typescript/"}]},{"title":"angularæ•°æ®ç»‘å®š","date":"2018-08-30T14:56:05.000Z","path":"2018/08/30/angularæ•°æ®ç»‘å®š/","text":"Angularæ•°æ®ç»‘å®šæ˜¯Angularä¸­æœ€å¸¸è§çš„ï¼Œç»‘å®šçš„æ–¹å¼æœ‰å•å‘æ•°æ®ç»‘å®šå’ŒåŒå‘æ•°æ®ç»‘å®šã€‚å•å‘çš„æ•°æ®ç»‘å®šé€šå¸¸æœ‰ä»¥ä¸‹å‡ ç§æ–¹å¼ï¼š 1.ä½¿ç”¨æ’å€¼è¡¨è¾¾å¼å°†ä¸€ä¸ªè¡¨è¾¾å¼çš„å€¼æ˜¾ç¤ºåœ¨æ¨¡æ¿ä¸Šï¼š &lt;h1&gt;{{titke}}&lt;/h1&gt; 2.ä½¿ç”¨æ–¹æ‹¬å·å°†HTMLæ ‡ç­¾çš„ä¸€ä¸ªå±æ€§ç»‘å®šåˆ°ä¸€ä¸ªè¡¨è¾¾å¼ä¸Šï¼š &lt;img [src] = &quot;imgUrl&quot;&gt; å…¶å®æˆ‘ä»¬çš„å±æ€§ç»‘å®šå’Œæˆ‘ä»¬çš„æ’å€¼è¡¨è¾¾å¼æ˜¯ä¸€æ ·çš„ï¼Œæˆ‘ä»¬ä¸¾ä¸ªä¾‹å­; &lt;img [src] = &quot;imgUrl&quot;&gt; &lt;img src = {{imgUrl}}&gt; è¿™ä¸¤ç§å†™æ³•å…¶å®éƒ½ä¸€æ ·ï¼Œæ’å€¼çš„è¡¨è¾¾å¼éƒ½ä¼šè¢«Angularè½¬åŒ–æˆå±æ€§ç»‘å®šã€‚åœ¨è¿™è¿˜æœ‰ä¸€ä¸ªéœ€è¦ç†è§£çš„ä¸œè¥¿å°±æ˜¯HTMLå±æ€§å’ŒDOMå±æ€§çš„åŒºåˆ«ï¼Œä¸¾ä¸ªä¾‹å­ï¼š &lt;input value=&quot;hello&quot; (click)=&quot;doOnInput($event)&quot;&gt; æˆ‘ä»¬çš„æ§åˆ¶å™¨å®šä¹‰ä¸€ä¸‹æˆ‘ä»¬çš„è¾“å…¥äº‹ä»¶ï¼š doOnInput(event: any) { console.log(event.target.value);//æ‰“å°DOMå±æ€§çš„å€¼ console.log(event.target.getAttribute(&apos;value&apos;);//æ‰“å°HTMLå±æ€§çš„å€¼ } æˆ‘ä»¬å¯ä»¥å‘ç°DOMå±æ€§çš„å€¼æ˜¯éšç€ä½ æ”¹å˜è¾“å…¥çš„å€¼è€Œä¸€ç›´åœ¨æ”¹å˜çš„ï¼Œè€ŒHTMLå±æ€§çš„å€¼ä¸€ç›´æ˜¯helloï¼Œå› ä¸ºHTMLæ˜¯åˆå§‹åŒ–DOMå±æ€§çš„å€¼çš„ï¼Œä¸èƒ½æ”¹å˜ï¼Œè€ŒDOMå±æ€§çš„å€¼å¯ä»¥æ”¹å˜ã€‚ HTMLå±æ€§å’ŒDOMå±æ€§çš„å…³ç³»å¦‚ä¸‹ï¼š å°‘é‡HTMLå±æ€§å’ŒDOMå±æ€§ä¹‹é—´æœ‰1:1çš„æ˜ å°„ï¼Œæ¯”å¦‚idã€‚ æœ‰äº›HTMLå±æ€§æ²¡æœ‰å¯¹åº”çš„DOMå±æ€§ï¼Œå¦‚colspanã€‚ æœ‰äº›DOMå±æ€§æ²¡æœ‰å¯¹åº”çš„HTMLå±æ€§ï¼Œå¦‚textContentã€‚ å°±ç®—åå­—ç›¸åŒï¼ŒHTMLå±æ€§å’ŒDOMå±æ€§ä¹Ÿä¸æ˜¯ä¸€æ ·ä¸œè¥¿ã€‚ HTMLå±æ€§çš„å€¼æŒ‡å®šäº†åˆå§‹å€¼ï¼›DOMå±æ€§çš„å€¼è¡¨ç¤ºå½“å‰å€¼.DOMå±æ€§çš„å€¼å¯ä»¥æ”¹å˜ï¼›HTMLå±æ€§çš„å€¼ä¸èƒ½æ”¹å˜ã€‚ æ¨¡æ¿ç»‘å®šæ˜¯é€šè¿‡DOMå±æ€§å’Œäº‹ä»¶æ¥å·¥ä½œçš„ï¼Œè€Œä¸æ˜¯HTMLå±æ€§ã€‚ ä»¥ä¸Šæ˜¯DOMå±æ€§çš„ç»‘å®šï¼Œä¸‹é¢ä»‹ç»ä¸‹HTMLå±æ€§çš„ç»‘å®šç®€å•çš„ä¸¾ä¸ªä¾‹å­ï¼š &lt;td [attr.colspan]={{1+1}}&gt; å› ä¸ºcolspanæ˜¯ä¸ªDOMå±æ€§æ²¡æœ‰çš„HTMLå±æ€§ï¼Œæ‰€ä»¥æˆ‘ä»¬åœ¨å‰é¢åŠ ä¸Šattrè¿™ä¸ªå‰ç¼€æ¥è¡¨ç¤ºå®ƒæ˜¯HTMLå±æ€§ã€‚ æ›´å¤šçš„æˆ‘ä»¬å¯ä»¥é€šè¿‡[ngClass]æˆ–è€…[class.classname]ã€[class]è¿™ç§æ¥æ§åˆ¶éƒ¨åˆ†æˆ–è€…å…¨éƒ¨çš„ç±»åï¼Œä»¥æ­¤æ¥è¾¾åˆ°æ§åˆ¶æ ·å¼çš„æ•ˆæœã€‚ngclassçš„è¡¨è¾¾å¼éœ€è¦æ¥æ”¶ä¸€ä¸ªå¯¹è±¡ï¼Œå¯¹è±¡ä¸­é€šè¿‡{cssClassName: Boolen}è¿™ç§é”®å€¼å¯¹æ¥è¡¨ç¤ºè¯¥ç±»æ˜¯å¦è¦åŠ ä¸Šï¼Œtrueè¡¨ç¤ºåŠ ä¸Šï¼Œfalseä»£è¡¨ç§»é™¤ï¼Œè¿™å°±æ˜¯CSSç±»ç»‘å®šã€‚ ç±»ä¼¼çš„ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥é€šè¿‡cssæ ·å¼ç»‘å®šï¼Œä¸è¿‡ä¸å†æ˜¯classå¼€å¤´äº†ï¼Œè€Œæ˜¯styleå¼€å¤´ï¼Œä¸¾ä¸ªæ —å­ï¼š &lt;div [style.color]=&quot; isDev? &apos;red&apos;: &apos;blue&apos;&quot;&gt; å…¶ä¸­çš„isDevå°±æ˜¯æ§åˆ¶å™¨æ¥æ§åˆ¶çš„ã€‚å’Œä¸Šé¢cssç±»ç»‘å®šä¸€æ ·ï¼Œè¿™åªæ˜¯å•ä¸€æ ·å¼çš„ç»‘å®šï¼Œæ‰€ä»¥æˆ‘ä»¬è¿˜æœ‰ä¸ª[ngStyle]æ¥æ‰¹é‡æ§åˆ¶ï¼Œå®ƒä¹Ÿæ˜¯æ¥å—ä¸€ä¸ªå¯¹è±¡ï¼Œä½†å’Œcssç±»ä¸åŒçš„æ˜¯ï¼Œè¿™ä¸ªå¯¹è±¡é‡Œé¢å®šä¹‰çš„æ˜¯æ ·å¼çš„é”®å€¼å¯¹ï¼Œä¾‹å¦‚{color: red,background: black} 3.ä¸Šé¢è¿™ä¸¤ä¸ªç»‘å®šæ–¹å¼éƒ½æ˜¯æ§åˆ¶å™¨å‘æ¨¡æ¿ä¼ è¾“æ•°æ®ï¼Œä¸‹é¢è¿™ç§æ˜¯æ¨¡æ¿å‘æ§åˆ¶å™¨ä¼ è¾“æ•°æ®ï¼Œä¹Ÿå°±æ˜¯äº‹ä»¶ç»‘å®šï¼š &lt;button (click)=&quot;onClickEvent($event)&quot;&gt;ç‚¹å‡»æ‰§è¡Œ&lt;/button&gt; //å°æ‹¬å·è¡¨ç¤ºè¿™æ˜¯ä¸€ä¸ªäº‹ä»¶ç»‘å®š //å°æ‹¬å·ä¸­çš„æ˜¯äº‹ä»¶çš„åç§° //ç­‰å·åé¢åŒå¼•å·ä¸­çš„æ˜¯äº‹ä»¶å‘ç”Ÿæ—¶æ‰§è¡Œçš„è¡¨è¾¾å¼ //å¦‚æœå¤„ç†äº‹ä»¶çš„æ–¹æ³•éœ€è¦äº†è§£äº‹ä»¶çš„å±æ€§ï¼Œæˆ‘ä»¬å°±å¯ä»¥ç»™æ–¹æ³•åŠ ä¸Š$eventå‚æ•° æˆ‘ä»¬çš„äº‹ä»¶ç»‘å®šä¸­ä¹Ÿå¯ä»¥ä¸æ˜¯ä¸€ä¸ªæ–¹æ³•è°ƒç”¨ï¼Œè€Œæ˜¯ä¸€ä¸ªå±æ€§èµ‹å€¼ï¼š &lt;button (click)=&quot;saved = true&quot;&gt; è¿™æ ·æˆ‘ä»¬å°±èƒ½å¤Ÿç›´æ¥ç»™æ§åˆ¶å™¨ä¸­çš„savedå±æ€§èµ‹å€¼ä¸ºtrueã€‚ æ¥ä¸‹æ¥æˆ‘ä»¬çœ‹ä¸€ä¸‹æœ€é‡è¦çš„åŒå‘æ•°æ®ç»‘å®š ç›’å­é‡Œé¢è£…é¦™è•‰ è¿™å¥è¯æ˜¯å®˜ç½‘æ–‡æ¡£ä¸Šé¢è¯´çš„ï¼Œå°±æ˜¯æŒ‡[(ngModel)]æ˜¯æ–¹æ‹¬å·åŒ…ç€å°æ‹¬å·ï¼Œå…¶å®ä»ä¸Šé¢å°±èƒ½çœ‹å‡ºï¼Œæ§åˆ¶å™¨ä¼ å€¼ç»™æ¨¡æ¿æ˜¯æ–¹æ‹¬å·ï¼Œæ¨¡æ¿ä¼ å€¼ç»™æ§åˆ¶å™¨æ˜¯å°æ‹¬å·ï¼Œä¸¤ä¸ªèåˆåˆ°ä¸€èµ·å°±æ˜¯åŒå‘æ•°æ®ç»‘å®šäº†ï¼Œä¸¾ä¸ªæ —å­ï¼š &lt;input [value]=&quot;currentHero.name&quot; (input)=&quot;currentHero.name=$event.target.value&quot; &gt; ä¸‹é¢è¿™ä¸ªè€Œå…¶å®å°±æ˜¯ä¸€ä¸ªåŒå‘æ•°æ®ç»‘å®šï¼Œä½†æ˜¯æ˜¾å¾—å¤ªè¿‡ç¬¨é‡ï¼Œäºæ˜¯æœ‰äº†ä¸‹é¢è¿™ç§å†™æ³•ï¼š &lt;input [(ngModel)]=&quot;currentHero.name&quot;&gt; è¿™æ ·å°±èƒ½å¤ŸåŒæ­¥è¾“å…¥å’Œæ˜¾ç¤ºäº†ï¼Œæœ€å¸¸ç”¨çš„åœ°æ–¹å°±æ˜¯æˆ‘ä»¬çš„è¡¨å•å…ƒç´ äº†ã€‚","tags":[{"name":"Angular","slug":"Angular","permalink":"http://tanyibing.com/tags/Angular/"},{"name":"Typescript","slug":"Typescript","permalink":"http://tanyibing.com/tags/Typescript/"}]},{"title":"angularä¸­å¦‚ä½•å¼•å…¥ç¬¬ä¸‰æ–¹åº“","date":"2018-08-29T15:06:42.000Z","path":"2018/08/29/angularä¸­å¦‚ä½•å¼•å…¥ç¬¬ä¸‰æ–¹åº“/","text":"å½“æˆ‘ä»¬æƒ³è¦åœ¨angularé¡¹ç›®ä¸­å¼•å…¥ç¬¬ä¸‰æ–¹çš„åº“çš„æ—¶å€™æˆ‘ä»¬åº”è¯¥æ€ä¹ˆæ“ä½œï¼Ÿå°±æ‹¿jqueryæ¥è¯´å§ï¼š ç¬¬ä¸€æ­¥æˆ‘ä»¬éœ€è¦åœ¨é¡¹ç›®ç›®å½•ä¸‹å®‰è£…è‡ªå·±æ‰€éœ€è¦çš„åŒ…ï¼š npm install --save jquery --saveå’Œ--save-devçš„åŒºåˆ«å°±ä¸å¤šæè¿°äº†ï¼Œå®‰è£…å®Œæˆä¹‹åæˆ‘ä»¬å°±å¯ä»¥åœ¨é¡¹ç›®ä¸‹çš„node_modulesä¸‹é¢çœ‹åˆ°å®ƒäº†ã€‚ ç¬¬äºŒæ­¥æˆ‘ä»¬éœ€è¦æŠŠæˆ‘ä»¬ä¸‹è½½å¥½çš„åŒ…åŠ å…¥åˆ°angularçš„é…ç½®æ–‡ä»¶ä¸­ï¼Œåœ¨6.xä¹‹å‰ï¼Œè¿™ä¸ªé…ç½®æ–‡ä»¶çš„åç§°æ˜¯.angular-cli.jsonï¼Œä½†æ˜¯åœ¨6.xä¹‹åå°±ä¸æ˜¯è¿™ä¸ªåå­—äº†ï¼Œè€Œæ˜¯æ¢æˆäº†angular.jsonï¼Œæ‰“å¼€è¿™ä¸ªæ–‡ä»¶æˆ‘ä»¬å°±èƒ½çœ‹åˆ°ä¸€ç³»åˆ—çš„é…ç½®ä¿¡æ¯ã€‚æˆ‘ä»¬éœ€è¦å°†è‡ªå·±ä¸‹è½½çš„åŒ…çš„è·¯å¾„å¼•ç”¨åˆ°styleså’Œscriptsæ•°ç»„ä¸‹é¢ï¼š åœ¨è¿™é‡Œå¡«å…¥æ­£ç¡®çš„è·¯å¾„å°±å¯ä»¥äº†ã€‚è¿™æ ·jqueryæˆ–è€…ä½ éœ€è¦çš„ç¬¬ä¸‰æ–¹åŒ…å°±è¢«åŠ å…¥åˆ°angularé¡¹ç›®ä¸­äº†ã€‚ ä½†æ˜¯æˆ‘ä»¬ç°åœ¨è¿˜æ˜¯ä¸èƒ½ç›´æ¥ä½¿ç”¨jqueryï¼Œå› ä¸ºangularæ˜¯ä½¿ç”¨typescriptå¼€å‘çš„ï¼Œè€Œjqueryçš„æœ¬è´¨æ˜¯javascriptï¼ŒTypescriptæ˜¯ä¸èƒ½ç›´æ¥ä½¿ç”¨çš„ã€‚æˆ‘ä»¬è¿˜éœ€è¦å®‰è£…ç±»å‹æè¿°æ–‡ä»¶è®©Typescriptè®¤è¯†jqueryã€‚ ç¬¬ä¸‰æ­¥æˆ‘ä»¬é€šè¿‡å‘½ä»¤æ¥å®‰è£…jqueryçš„ç±»å‹æè¿°æ–‡ä»¶ï¼š npm install @types/jquery(è¿™ä¸ªåå­—æ˜¯ä½ éœ€è¦å®‰è£…çš„åŒ…çš„åå­—) --save-dev è¿™æ ·æˆ‘ä»¬å°±èƒ½å¤Ÿä½¿ç”¨jqueryçš„å‘½ä»¤äº†ã€‚","tags":[{"name":"Angular","slug":"Angular","permalink":"http://tanyibing.com/tags/Angular/"},{"name":"Typescript","slug":"Typescript","permalink":"http://tanyibing.com/tags/Typescript/"}]},{"title":"remçš„æ­£ç¡®ä½¿ç”¨å§¿åŠ¿","date":"2018-08-27T14:14:03.000Z","path":"2018/08/27/remçš„æ­£ç¡®ä½¿ç”¨å§¿åŠ¿/","text":"æœ€è¿‘ç”¨çš„æ¯”è¾ƒå¤šçš„å°±æ˜¯remäº†ï¼Œæ‰€ä»¥å†™ä¸€ç¯‡remçš„æ–‡ç« æ¥è®°å½•ä¸‹ä½¿ç”¨remæ¥åˆ¶ä½œç§»åŠ¨ç«¯çš„é¡µé¢çš„å…³é”®ä¹‹å¤„ã€‚ é¦–å…ˆç®€å•çš„é˜è¿°ä¸‹pxã€emã€remä¸‰è€…ä¹‹é—´çš„å…³ç³»ï¼š pxï¼šåƒç´ æ˜¯ç›¸å¯¹äºæ˜¾ç¤ºå™¨å±å¹•åˆ†è¾¨ç‡è€Œè¨€çš„ç›¸å¯¹é•¿åº¦å•ä½ã€‚pcç«¯ä½¿ç”¨pxå€’ä¹Ÿæ— æ‰€è°“ï¼Œå¯æ˜¯åœ¨ç§»åŠ¨ç«¯ï¼Œå› ä¸ºæ‰‹æœºåˆ†è¾¨ç‡ç§ç±»é¢‡å¤šï¼Œä¸å¯èƒ½ä¸€ä¸ªä¸ªå»é€‚é…ï¼Œè¿™æ—¶pxå°±æ˜¾å¾—éå¸¸æ— åŠ›ï¼Œæ‰€ä»¥å°±è¦è€ƒè™‘emå’Œremã€‚ emï¼šç»§æ‰¿çˆ¶çº§çš„ï¼Œå‡è®¾htmlçš„font-sizeé»˜è®¤ä¸º16pxï¼Œbodyå­—ä½“å¤§å°å®šä¹‰ä¸º50%ï¼Œé‚£ä¹ˆåœ¨bodyé‡Œå­—ä½“å¤§å°å°±æ˜¯1em=8pxäº†ã€‚å¯å½“ä½ åˆå®šä¹‰äº†ä¸€ä¸ªdivï¼Œç„¶åæŠŠå­—ä½“è®¾ç½®æˆäº†50%ï¼Œè¯·é—®ï¼Œç°åœ¨divä¸‹çš„1emç­‰äºå¤šå°‘ï¼Ÿå› ä¸ºç»§æ‰¿äº†çˆ¶çº§çš„å€¼ï¼Œç°åœ¨è¿™ä¸ªdivé‡Œçš„1em=4pxï¼Œè¿™ä¹ˆåµŒå¥—ä¸‹å»çš„è¯ï¼ŒæŠ±æ­‰ï¼Œæˆ‘æ•°å­¦ä¸å¥½ï¼æ‰€ä»¥remå°±å‡ºç°äº†ã€‚ remï¼šæ˜¯emçš„å‡çº§ç‰ˆï¼Œremåªä¼šç›¸å¯¹htmlçš„å€¼ï¼Œä¸ä¼šå—åˆ°çˆ¶çº§çš„å½±å“ï¼Œè¿™æ ·çš„å¥½å¤„åœ¨äºï¼šä»emé‡Œçš„ä¾‹å­æ¥è®²ï¼Œ1remå§‹ç»ˆä¼šç­‰äº8pxã€‚ä½¿ç”¨çš„æ—¶å€™ä¸éœ€è¦é‡æ–°è®¡ç®—remæ­¤æ—¶çš„å¤§å°ã€‚remå› ä¸ºæ˜¯css3å¢åŠ çš„ï¼Œæ‰€ä»¥ie8æˆ–ä»¥ä¸‹è¯·æ— è§†ï¼ˆå§‹ç»ˆæƒ³ä¸æ˜ç™½ï¼Œä¸ºä»€ä¹ˆå›½äººè‡³ä»Šå¯¹å¾®è½¯éƒ½æ”¾å¼ƒçš„ieè¿™ä¹ˆæ‹æ‹ä¸èˆï¼‰ã€‚ ä½¿ç”¨æ–¹æ³•ï¼šé¦–å…ˆåœ¨cssä¸­å…ˆå…¨å±€å£°æ˜font-size=625%,è¿™é‡Œä¸ºä»€ä¹ˆç”¨625%å‘¢ï¼Ÿå› ä¸º100%=16px,1px=6.25%,æ‰€ä»¥100px=625%ï¼Œ1rem=100pxã€‚è¿™æ ·åœ¨åé¢ä½¿ç”¨çš„æ—¶å€™å°±æ–¹ä¾¿å¾ˆå¤šã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œremæ˜¯ç›¸å¯¹äºæ ¹å…ƒç´ htmlçš„font-sizeï¼Œä¹Ÿå°±æ˜¯è¯´åªéœ€è¦è®¾ç½®æ ¹å…ƒç´ htmlçš„ç™¾åˆ†æ¯”å°±è¡Œäº†ï¼š html{font-size: 625%;} è¿˜å¯ä»¥åŠ¨æ€çš„æ¥è®¾ç½®remï¼Œä¾‹å¦‚ä½¿ç”¨åª’ä½“æŸ¥è¯¢ï¼š @media screen and (min-width: 320px) { html {font-size: 14px;} } @media screen and (min-width: 360px) { html {font-size: 16px;} } @media screen and (min-width: 400px) { html {font-size: 18px;} } @media screen and (min-width: 440px) { html {font-size: 20px;} } @media screen and (min-width: 480px) { html {font-size: 22px;} } @media screen and (min-width: 640px) { html {font-size: 28px;} } æˆ–è€…åˆ©ç”¨jsè®¡ç®—å½“å‰è®¾å¤‡æ¥è®¾ç½®ï¼š (function (doc, win) { var docEl = doc.documentElement, resizeEvt = &apos;orientationchange&apos; in window ? &apos;orientationchange&apos; : &apos;resize&apos;, recalc = function () { var clientWidth = docEl.clientWidth; if (!clientWidth) return; if(clientWidth&gt;=640){ docEl.style.fontSize = &apos;100px&apos;; }else{ //è¿™é‡Œçš„640æ˜¯æ ¹æ®è®¾è®¡å›¾å®é™…å¤§å°æ¥çš„ docEl.style.fontSize = 100 * (clientWidth / 640) + &apos;px&apos;; } }; if (!doc.addEventListener) return; win.addEventListener(resizeEvt, recalc, false); doc.addEventListener(&apos;DOMContentLoaded&apos;, recalc, false); })(document, window); åæ¥çœ‹åˆ°ä¸€ä¸ªå…³äºæ‰‹æ·˜çš„æ–‡ç« ï¼Œæœ‰äº†ä¸‹é¢è¿™ç§æœ€ä½³çš„æ–¹æ³•ï¼Œé€šè¿‡jsè®¡ç®—å½“å‰è®¾å¤‡çš„DPRï¼ŒåŠ¨æ€è®¾ç½®åœ¨htmlæ ‡ç­¾ä¸Šï¼Œå¹¶åŠ¨æ€çš„è®¾ç½®htmlçš„font-sizeï¼Œåˆ©ç”¨cssé€‰æ‹©å™¨æ ¹æ®DPRæ¥è®¾ç½®ä¸åŒDPRä¸‹çš„å­—ä½“çš„å¤§å°ï¼š function(win, lib) { var timer, doc = win.document, docElem = doc.documentElement, vpMeta = doc.querySelector(&apos;meta[name=&quot;viewport&quot;]&apos;), flexMeta = doc.querySelector(&apos;meta[name=&quot;flexible&quot;]&apos;), dpr = 0, scale = 0, flexible = lib.flexible || (lib.flexible = {}); // è®¾ç½®äº† viewport meta if (vpMeta) { console.warn(&quot;å°†æ ¹æ®å·²æœ‰çš„metaæ ‡ç­¾æ¥è®¾ç½®ç¼©æ”¾æ¯”ä¾‹&quot;); var initial = vpMeta.getAttribute(&quot;content&quot;).match(/initial\\-scale=([\\d\\.]+)/); if (initial) { scale = parseFloat(initial[1]); // å·²è®¾ç½®çš„ initialScale dpr = parseInt(1 / scale); // è®¾å¤‡åƒç´ æ¯” devicePixelRatio } // è®¾ç½®äº† flexible Meta }else if (flexMeta) { var flexMetaContent = flexMeta.getAttribute(&quot;content&quot;); if (flexMetaContent) { var initial = flexMetaContent.match(/initial\\-dpr=([\\d\\.]+)/), maximum = flexMetaContent.match(/maximum\\-dpr=([\\d\\.]+)/); if (initial) { dpr = parseFloat(initial[1]); scale = parseFloat((1 / dpr).toFixed(2)); } if (maximum) { dpr = parseFloat(maximum[1]); scale = parseFloat((1 / dpr).toFixed(2)); } } } // viewport æˆ– flexible // meta å‡æœªè®¾ç½® if (!dpr &amp;&amp; !scale) { // QST // è¿™é‡Œçš„ ç¬¬ä¸€å¥æœ‰ä»€ä¹ˆç”¨ ? // å’Œ Android æœ‰æ¯›å…³ç³» ? var u = (win.navigator.appVersion.match(/android/gi), win.navigator.appVersion.match(/iphone/gi)), _dpr = win.devicePixelRatio; // æ‰€ä»¥è¿™é‡Œä¼¼ä¹æ˜¯å°†æ‰€æœ‰ Android è®¾å¤‡éƒ½è®¾ç½®ä¸º 1 äº† dpr = u ? ( (_dpr &gt;= 3 &amp;&amp; (!dpr || dpr &gt;= 3)) ? 3 : (_dpr &gt;= 2 &amp;&amp; (!dpr || dpr &gt;= 2)) ? 2 : 1 ) : 1; scale = 1 / dpr; } docElem.setAttribute(&quot;data-dpr&quot;, dpr); // æ’å…¥ viewport meta if (!vpMeta) { vpMeta = doc.createElement(&quot;meta&quot;); vpMeta.setAttribute(&quot;name&quot;, &quot;viewport&quot;); vpMeta.setAttribute(&quot;content&quot;, &quot;initial-scale=&quot; + scale + &quot;, maximum-scale=&quot; + scale + &quot;, minimum-scale=&quot; + scale + &quot;, user-scalable=no&quot;); if (docElem.firstElementChild) { docElem.firstElementChild.appendChild(vpMeta) } else { var div = doc.createElement(&quot;div&quot;); div.appendChild(vpMeta); doc.write(div.innerHTML); } } function setFontSize() { var winWidth = docElem.getBoundingClientRect().width; if (winWidth / dpr &gt; 540) { (winWidth = 540 * dpr); } // æ ¹èŠ‚ç‚¹ fontSize æ ¹æ®å®½åº¦å†³å®š var baseSize = winWidth / 10; docElem.style.fontSize = baseSize + &quot;px&quot;; flexible.rem = win.rem = baseSize; } // è°ƒæ•´çª—å£æ—¶é‡ç½® win.addEventListener(&quot;resize&quot;, function() { clearTimeout(timer); timer = setTimeout(setFontSize, 300); }, false); // è¿™ä¸€æ®µæ˜¯æˆ‘è‡ªå·±åŠ çš„ // orientationchange æ—¶ä¹Ÿéœ€è¦é‡ç®—ä¸‹å§ win.addEventListener(&quot;orientationchange&quot;, function() { clearTimeout(timer); timer = setTimeout(setFontSize, 300); }, false); // pageshow // keyword: å€’é€€ ç¼“å­˜ç›¸å…³ win.addEventListener(&quot;pageshow&quot;, function(e) { if (e.persisted) { clearTimeout(timer); timer = setTimeout(setFontSize, 300); } }, false); // è®¾ç½®åŸºå‡†å­—ä½“ if (&quot;complete&quot; === doc.readyState) { doc.body.style.fontSize = 12 * dpr + &quot;px&quot;; } else { doc.addEventListener(&quot;DOMContentLoaded&quot;, function() { doc.body.style.fontSize = 12 * dpr + &quot;px&quot;; }, false); } setFontSize(); flexible.dpr = win.dpr = dpr; flexible.refreshRem = setFontSize; flexible.rem2px = function(d) { var c = parseFloat(d) * this.rem; if (&quot;string&quot; == typeof d &amp;&amp; d.match(/rem$/)) { c += &quot;px&quot;; } return c; }; flexible.px2rem = function(d) { var c = parseFloat(d) / this.rem; if (&quot;string&quot; == typeof d &amp;&amp; d.match(/px$/)) { c += &quot;rem&quot;; } return c; } }(window, window.lib || (window.lib = {}));","tags":[{"name":"JavaScript","slug":"JavaScript","permalink":"http://tanyibing.com/tags/JavaScript/"},{"name":"HTML","slug":"HTML","permalink":"http://tanyibing.com/tags/HTML/"},{"name":"CSS","slug":"CSS","permalink":"http://tanyibing.com/tags/CSS/"}]},{"title":"å…¨å±é®ç½©æ’­æ”¾è§†é¢‘","date":"2018-08-23T08:48:28.000Z","path":"2018/08/23/å…¨å±é®ç½©æ’­æ”¾è§†é¢‘/","text":"æ¥ç€ä¸Šä¸€ç¯‡çš„å†…å®¹ï¼Œç°åœ¨æˆ‘æ’­æ”¾è§†é¢‘ä¸å¸Œæœ›è·³è½¬åˆ°ä¸€ä¸ªæ–°çš„è§†é¢‘æ’­æ”¾é¡µé¢è¿™ä¹ˆéº»çƒ¦äº†ï¼Œæˆ‘æƒ³è¦é€šè¿‡ç‚¹å‡»ç›´æ¥åœ¨æœ¬é¡µé¢è¿›è¡Œæ’­æ”¾ã€‚æœ€åå†³å®šçš„æ˜¯åœ¨å…¨å±åŠ ä¸Šä¸€ä¸ªé®ç½©ï¼Œè§†é¢‘æ§åˆ¶ä½åœ¨å±å¹•çš„æ­£ä¸­å¤®è¿›è¡Œæ’­æ”¾ã€‚ç›´æ¥ä¸Šæˆ‘çš„ä»£ç å§ï¼š &lt;div class=&quot;box-mask&quot;&gt;&lt;/div&gt; &lt;div class=&quot;box&quot;&gt; &lt;input class=&quot;btnCancel&quot; type=&quot;button&quot; value=&quot;å…³é—­&quot;&gt; &lt;script src=&apos;//player.polyv.net/script/polyvplayer.min.js&apos;&gt;&lt;/script&gt; &lt;div id=&apos;&apos; class=&quot;demo&quot;&gt;&lt;/div&gt; &lt;script&gt; let videoDiv = $(&apos;.box div&apos;); $(&quot;.btnDel&quot;).click(function() { let vid = $(this).attr(&apos;id&apos;); console.log(vid); let plv = &apos;plv_&apos; + vid; let plvObj = &apos;#&apos; + plv; $(videoDiv).attr(&apos;id&apos;, plv); let plvConfig = { &apos;width&apos;:&apos;100%&apos;, &apos;height&apos;:&apos;100%&apos;, &apos;vid&apos; : vid } let player = polyvObject(plvObj).videoPlayer(plvConfig); }); &lt;/script&gt; &lt;/div&gt; è¿™æ˜¯æˆ‘çš„é®ç½©å’Œè§†é¢‘æ’­æ”¾æ¨¡å—çš„DOMç»“æ„ï¼Œå…¶ä¸­.btnDelå°±æ˜¯æˆ‘ä»¬ç‚¹å‡»è¿›å…¥é®ç½©çš„å…¥å£ã€‚ç´§æ¥ç€æˆ‘æ”¾å‡ºæˆ‘çš„cssæ ·å¼ï¼š .box-mask { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: #000; opacity: 0.7; filter: alpha(opacity=50); z-index: 99; display: none; } .box { position: absolute; width: 1000px; height: 620px; line-height:620px; text-align: center; z-index: 101; display: none; } .demo{ width:100%; height:100%; margin:0 auto; } .btnCancel { float: right; width: 50px; height: 30px; } ç´§æ¥ç€æˆ‘è¦å®ç°é€šè¿‡ç‚¹å‡»æ¥å®ç°é®ç½©çš„å¼€å¯å’Œå…³é—­ï¼Œå¹¶ä¸”è¦è€ƒè™‘ä¸‹é¼ æ ‡æ»šè½®çš„æ»šåŠ¨å’Œæµè§ˆå™¨çª—å£çš„å¤§å°æ”¹å˜è¿™äº›æƒ…å†µï¼š $(document).ready(function() { var isOpen = 0; //å…¨å±€å˜é‡ï¼Œåˆ¤æ–­æ˜¯å¦å·²ç»æ‰“å¼€å¼¹å‡ºæ¡† $(&quot;.btnDel&quot;).click(function() { //$(&quot;.box-mask&quot;).css({&quot;display&quot;:&quot;block&quot;}); $(&quot;.box-mask&quot;).fadeIn(500); center($(&quot;.box&quot;)); //è½½å…¥å¼¹å‡ºçª—å£ä¸Šçš„æŒ‰é’®äº‹ä»¶ checkEvent($(this).parent(), $(&quot;.btnSure&quot;), $(&quot;.btnCancel&quot;)); }); function center(obj) { //objè¿™ä¸ªå‚æ•°æ˜¯å¼¹å‡ºæ¡†çš„æ•´ä¸ªå¯¹è±¡ var screenWidth = $(window).width(), screenHeigth = $(window).height(); //è·å–å±å¹•å®½é«˜ var scollTop = $(document).scrollTop(); //å½“å‰çª—å£è·ç¦»é¡µé¢é¡¶éƒ¨çš„è·ç¦» var objLeft = (screenWidth - obj.width()) / 2; ///å¼¹å‡ºæ¡†è·ç¦»å·¦ä¾§è·ç¦» var objTop = (screenHeigth - obj.height()) / 2 + scollTop; ///å¼¹å‡ºæ¡†è·ç¦»é¡¶éƒ¨çš„è·ç¦» obj.css({ left:objLeft + &quot;px&quot;, top:objTop + &quot;px&quot; }); obj.fadeIn(500); //å¼¹å‡ºæ¡†æ·¡å…¥ isOpen = 1; //å¼¹å‡ºæ¡†æ‰“å¼€åè¿™ä¸ªå˜é‡ç½®1 è¯´æ˜å¼¹å‡ºæ¡†æ˜¯æ‰“å¼€è£…å¡« //å½“çª—å£å¤§å°å‘ç”Ÿæ”¹å˜æ—¶ $(window).resize(function() { //åªæœ‰isOpençŠ¶æ€ä¸‹æ‰æ‰§è¡Œ if (isOpen == 1) { //é‡æ–°è·å–æ•°æ® screenWidth = $(window).width(); screenHeigth = $(window).height(); var scollTop = $(document).scrollTop(); objLeft = (screenWidth - obj.width()) / 2; var objTop = (screenHeigth - obj.height()) / 2 + scollTop; obj.css({ left:objLeft + &quot;px&quot;, top:objTop + &quot;px&quot; }); obj.fadeIn(500); } }); //å½“æ»šåŠ¨æ¡å‘ç”Ÿæ”¹å˜çš„æ—¶å€™ $(window).scroll(function() { if (isOpen == 1) { //é‡æ–°è·å–æ•°æ® screenWidth = $(window).width(); screenHeigth = $(window).height(); var scollTop = $(document).scrollTop(); objLeft = (screenWidth - obj.width()) / 2; var objTop = (screenHeigth - obj.height()) / 2 + scollTop; obj.css({ left:objLeft + &quot;px&quot;, top:objTop + &quot;px&quot; }); obj.fadeIn(500); } }); } //å¯¼å…¥ä¸¤ä¸ªæŒ‰é’®äº‹ä»¶ objæ•´ä¸ªé¡µé¢çš„å†…å®¹å¯¹è±¡ï¼Œobj1ä¸ºç¡®è®¤æŒ‰é’®ï¼Œobj2ä¸ºå–æ¶ˆæŒ‰é’® function checkEvent(obj, obj1, obj2) { //ç¡®è®¤ååˆ é™¤é¡µé¢æ‰€æœ‰ä¸œè¥¿ obj1.click(function() { //ç§»é™¤æ‰€æœ‰çˆ¶æ ‡ç­¾å†…å®¹ obj.remove(); //è°ƒç”¨closedå…³é—­å¼¹å‡ºæ¡† closed($(&quot;.box-mask&quot;), $(&quot;.box&quot;)); }); //å–æ¶ˆæŒ‰é’®äº‹ä»¶ obj2.click(function() { //è°ƒç”¨closedå…³é—­å¼¹å‡ºæ¡† closed($(&quot;.box-mask&quot;), $(&quot;.box&quot;)); }); } //å…³é—­å¼¹å‡ºçª—å£äº‹ä»¶ function closed(obj1, obj2) { obj1.fadeOut(500); obj2.fadeOut(500); isOpen = 0; } }); è‡³äºè§†é¢‘å†…å®¹çš„åˆ‡æ¢ï¼Œå’Œä¸Šä¸€ç¯‡å·®ä¸å¤šï¼Œä¹Ÿå¯ä»¥å»æˆ‘çš„githubä¸Šçœ‹å®ä¾‹https://github.com/TanYiBing/zenith.","tags":[{"name":"JavaScript","slug":"JavaScript","permalink":"http://tanyibing.com/tags/JavaScript/"},{"name":"CSS","slug":"CSS","permalink":"http://tanyibing.com/tags/CSS/"},{"name":"HTTP","slug":"HTTP","permalink":"http://tanyibing.com/tags/HTTP/"}]},{"title":"é™æ€é¡µé¢ä¹‹é—´ä¼ å€¼","date":"2018-08-22T14:40:46.000Z","path":"2018/08/22/é™æ€é¡µé¢ä¹‹é—´ä¼ å€¼/","text":"ä»Šå¤©åœ¨å·¥ä½œä¸­éœ€è¦å®ç°è§†é¢‘çš„æ’­æ”¾åŠŸèƒ½ï¼Œæˆ‘éœ€è¦ä»è§†é¢‘çš„èšåˆé¡µé€šè¿‡ç‚¹å‡»æ¥è·³è½¬åˆ°è§†é¢‘æ’­æ”¾é¡µé¢æ¥è¿›è¡Œæ’­æ”¾ã€‚å› ä¸ºè§†é¢‘æ˜¯æ‰˜ç®¡åœ¨POLYVå¹³å°ä¸Šçš„ï¼Œè§†é¢‘ä»¥.swfçš„æ ¼å¼ä¿å­˜çš„è¯å°±ä¸èƒ½ç›´æ¥ä½¿ç”¨videoæ ‡ç­¾ï¼Œè€Œæ˜¯éœ€è¦ä½¿ç”¨ç‰¹å®šçš„æ–¹æ³•æ¥å®ç°è§†é¢‘çš„æ’­æ”¾åŠŸèƒ½ï¼Œæˆ‘æœ€åé€‰æ‹©çš„æ˜¯è§†é¢‘å¹³å°ä¸Šçš„å¤šç»ˆç«¯æ ·å¼ï¼Œå…·ä½“ä»£ç å¦‚ä¸‹ï¼š &lt;script src=&apos;//player.polyv.netscriptpolyvplayer.min.js&apos;&gt;&lt;/script&gt; &lt;div id=&apos;plv_228d7015db12fcd9a62b5abc1f76540f_2&apos;&gt;&lt;/div&gt; &lt;script&gt; var player = polyvObject(&apos;#plv_228d7015db12fcd9a62b5abc1f76540f_2&apos;).videoPlayer({ &apos;width&apos;:&apos;600&apos;, &apos;height&apos;:&apos;338&apos;, &apos;vid&apos; : &apos;228d7015db12fcd9a62b5abc1f76540f_2&apos; }); &lt;/script&gt; æˆ‘çš„è§†é¢‘èšåˆé¡µä¸­çš„ä¸€ä¸ªä¾‹å­æ˜¯: &lt;a href=&quot;&quot; class=&quot;vedioCard&quot;&gt; &lt;img src=&quot;xxx.jpg&quot; class=&quot;ved&quot;&gt; &lt;div class=&quot;deti&quot;&gt;æ±Ÿè‹çš„å¯ä¸œ&lt;/div&gt; &lt;/a&gt; ç´§æ¥ç€æˆ‘åœ¨aæ ‡ç­¾é‡Œé¢åŠ ä¸Šä¼ é€’å‚æ•°çš„urlï¼š &lt;a href=&quot;./video.html?vid=228d7015db9fd7dbd831b586d395e7fb_2&quot; class=&quot;vedioCard&quot;&gt; &lt;img src=&quot;xxx.jpg&quot; class=&quot;ved&quot;&gt; &lt;div class=&quot;deti&quot;&gt;æ±Ÿè‹çš„å¯ä¸œ&lt;/div&gt; &lt;/a&gt; vidå°±æ˜¯æˆ‘åœ¨æ’­æ”¾é¡µé¢æƒ³è¦è·å–çš„å‚æ•°ï¼Œå› ä¸ºè§†é¢‘çš„æ’­æ”¾éœ€è¦è¿™ä¸ªå‚æ•°ã€‚æ¥ä¸‹æ¥æˆ‘éœ€è¦åœ¨æ’­æ”¾é¡µé¢ä½¿ç”¨$.query.getï¼ˆparamï¼‰æ–¹æ³•æ¥è·å–æˆ‘æƒ³è¦çš„ä¸œè¥¿ï¼Œè¿™çœ‹ä¸Šå»å°±æ˜¯å’Œjqueryæœ‰å…³ï¼Œæ²¡é”™ï¼è¿™æ˜¯jqueryçš„ä¸€ä¸ªæ’ä»¶ï¼Œæ’ä»¶çš„ä»£ç æˆ‘ä¹Ÿæ‹¿è¿‡æ¥ä½¿ç”¨ï¼š new function(settings) { var $separator = settings.separator || &apos;&amp;&apos;; var $spaces = settings.spaces === false ? false : true; var $suffix = settings.suffix === false ? &apos;&apos; : &apos;[]&apos;; var $prefix = settings.prefix === false ? false : true; var $hash = $prefix ? settings.hash === true ? &quot;#&quot; : &quot;?&quot; : &quot;&quot;; var $numbers = settings.numbers === false ? false : true; jQuery.query = new function() { var is = function(o, t) { return o != undefined &amp;&amp; o !== null &amp;&amp; (!!t ? o.constructor == t : true); }; var parse = function(path) { var m, rx = /\\[([^[]*)\\]/g, match = /^([^[]+)(\\[.*\\])?$/.exec(path), base = match[1], tokens = []; while (m = rx.exec(match[2])) tokens.push(m[1]); return [base, tokens]; }; var set = function(target, tokens, value) { var o, token = tokens.shift(); if (typeof target != &apos;object&apos;) target = null; if (token === &quot;&quot;) { if (!target) target = []; if (is(target, Array)) { target.push(tokens.length == 0 ? value : set(null, tokens.slice(0), value)); } else if (is(target, Object)) { var i = 0; while (target[i++] != null); target[--i] = tokens.length == 0 ? value : set(target[i], tokens.slice(0), value); } else { target = []; target.push(tokens.length == 0 ? value : set(null, tokens.slice(0), value)); } } else if (token &amp;&amp; token.match(/^\\s*[0-9]+\\s*$/)) { var index = parseInt(token, 10); if (!target) target = []; target[index] = tokens.length == 0 ? value : set(target[index], tokens.slice(0), value); } else if (token) { var index = token.replace(/^\\s*|\\s*$/g, &quot;&quot;); if (!target) target = {}; if (is(target, Array)) { var temp = {}; for (var i = 0; i &lt; target.length; ++i) { temp[i] = target[i]; } target = temp; } target[index] = tokens.length == 0 ? value : set(target[index], tokens.slice(0), value); } else { return value; } return target; }; var queryObject = function(a) { var self = this; self.keys = {}; if (a.queryObject) { jQuery.each(a.get(), function(key, val) { self.SET(key, val); }); } else { jQuery.each(arguments, function() { var q = &quot;&quot; + this; q = q.replace(/^[?#]/,&apos;&apos;); q = q.replace(/[;&amp;]$/,&apos;&apos;); if ($spaces) q = q.replace(/[+]/g,&apos; &apos;); jQuery.each(q.split(/[&amp;;]/), function(){ var key = decodeURIComponent(this.split(&apos;=&apos;)[0] || &quot;&quot;); var val = decodeURIComponent(this.split(&apos;=&apos;)[1] || &quot;&quot;); if (!key) return; if ($numbers) { if (/^[+-]?[0-9]+\\.[0-9]*$/.test(val)) val = parseFloat(val); else if (/^[+-]?[0-9]+$/.test(val)) val = parseInt(val, 10); } val = (!val &amp;&amp; val !== 0) ? true : val; if (val !== false &amp;&amp; val !== true &amp;&amp; typeof val != &apos;number&apos;) val = val; self.SET(key, val); }); }); } return self; }; queryObject.prototype = { queryObject: true, has: function(key, type) { var value = this.get(key); return is(value, type); }, GET: function(key) { if (!is(key)) return this.keys; var parsed = parse(key), base = parsed[0], tokens = parsed[1]; var target = this.keys[base]; while (target != null &amp;&amp; tokens.length != 0) { target = target[tokens.shift()]; } return typeof target == &apos;number&apos; ? target : target || &quot;&quot;; }, get: function(key) { var target = this.GET(key); if (is(target, Object)) return jQuery.extend(true, {}, target); else if (is(target, Array)) return target.slice(0); return target; }, SET: function(key, val) { var value = !is(val) ? null : val; var parsed = parse(key), base = parsed[0], tokens = parsed[1]; var target = this.keys[base]; this.keys[base] = set(target, tokens.slice(0), value); return this; }, set: function(key, val) { return this.copy().SET(key, val); }, REMOVE: function(key) { return this.SET(key, null).COMPACT(); }, remove: function(key) { return this.copy().REMOVE(key); }, EMPTY: function() { var self = this; jQuery.each(self.keys, function(key, value) { delete self.keys[key]; }); return self; }, load: function(url) { var hash = url.replace(/^.*?[#](.+?)(?:\\?.+)?$/, &quot;$1&quot;); var search = url.replace(/^.*?[?](.+?)(?:#.+)?$/, &quot;$1&quot;); return new queryObject(url.length == search.length ? &apos;&apos; : search, url.length == hash.length ? &apos;&apos; : hash); }, empty: function() { return this.copy().EMPTY(); }, copy: function() { return new queryObject(this); }, COMPACT: function() { function build(orig) { var obj = typeof orig == &quot;object&quot; ? is(orig, Array) ? [] : {} : orig; if (typeof orig == &apos;object&apos;) { function add(o, key, value) { if (is(o, Array)) o.push(value); else o[key] = value; } jQuery.each(orig, function(key, value) { if (!is(value)) return true; add(obj, key, build(value)); }); } return obj; } this.keys = build(this.keys); return this; }, compact: function() { return this.copy().COMPACT(); }, toString: function() { var i = 0, queryString = [], chunks = [], self = this; var encode = function(str) { str = str + &quot;&quot;; if ($spaces) str = str.replace(/ /g, &quot;+&quot;); return encodeURIComponent(str); }; var addFields = function(arr, key, value) { if (!is(value) || value === false) return; var o = [encode(key)]; if (value !== true) { o.push(&quot;=&quot;); o.push(encode(value)); } arr.push(o.join(&quot;&quot;)); }; var build = function(obj, base) { var newKey = function(key) { return !base || base == &quot;&quot; ? [key].join(&quot;&quot;) : [base, &quot;[&quot;, key, &quot;]&quot;].join(&quot;&quot;); }; jQuery.each(obj, function(key, value) { if (typeof value == &apos;object&apos;) build(value, newKey(key)); else addFields(chunks, newKey(key), value); }); }; build(this.keys); if (chunks.length &gt; 0) queryString.push($hash); queryString.push(chunks.join($separator)); return queryString.join(&quot;&quot;); } }; return new queryObject(location.search, location.hash); }; }(jQuery.query || {}); åœ¨æœ‰äº†è¿™ä¸ªæ’ä»¶ä¹‹åæˆ‘ä»¬å°±å¯ä»¥å¾ˆè½»æ¾åœ°æ‹¿åˆ°urlä¸­çš„å‚æ•°äº†ï¼š let vid = $.query.get(&apos;vid&apos;); æ‹¿åˆ°å‚æ•°ä¹‹ååªè¦åƒå¯¹å¾…æ™®é€šDOMå…ƒç´ ä¸€æ ·å¯¹ä¸Šé¢è§†é¢‘æ’­æ”¾çš„é‚£ä¸ªdivè¿›è¡Œå±æ€§çš„ä¿®æ”¹ï¼Œå°±å¯ä»¥æ’­æ”¾ä¸åŒçš„è§†é¢‘äº†ã€‚","tags":[{"name":"HTTP","slug":"HTTP","permalink":"http://tanyibing.com/tags/HTTP/"},{"name":"URL","slug":"URL","permalink":"http://tanyibing.com/tags/URL/"}]},{"title":"angular6åœ¨ä½¿ç”¨antdçš„layoutä¹‹åæ²¡æœ‰cssæ ·å¼","date":"2018-08-21T17:37:10.000Z","path":"2018/08/22/angular6åœ¨ä½¿ç”¨antdçš„layoutä¹‹åæ²¡æœ‰cssæ ·å¼/","text":"ä»Šå¤©æˆ‘åœ¨ä½¿ç”¨Angular6å®‰è£…å®Œantdä¹‹åï¼Œä½¿ç”¨äº†layoutæ¨¡å—ï¼Œæ‰“å¼€ä¹‹åå‘ç°æ²¡æœ‰æ ·å¼ï¼Œæœ€åè§£å†³æ–¹æ¡ˆå¦‚ä¸‹ï¼š é¦–å…ˆæˆ‘ä»¬çœ‹çœ‹antdçš„å®˜ç½‘ï¼š https://ng.ant.design/docs/getting-started/zh å½“æˆ‘ä»¬å¼€å§‹ä½¿ç”¨ä¹‹å‰ï¼Œæˆ‘ä»¬éœ€è¦å¼•å…¥csså…¨å±€æ ·å¼ï¼Œä½†æ˜¯å¼•å…¥çš„ä½ç½®ä¸æ­£ç¡®å°±ä¼šå¯¼è‡´æˆ‘ä»¬çš„æ¨¡å—æ²¡æœ‰æ ·å¼ã€‚ è§£å†³æ–¹æ¡ˆæ˜¯åœ¨å…¨å±€æ ·å¼æ–‡ä»¶style.cssçš„å¼€å¤´å¼•å…¥antdçš„css @importnode_modules/ng-zorro-antd/src/ng-zorro-antd.min.css å¦‚ä¸‹å›¾ï¼š","tags":[{"name":"Angular","slug":"Angular","permalink":"http://tanyibing.com/tags/Angular/"},{"name":"Typescript","slug":"Typescript","permalink":"http://tanyibing.com/tags/Typescript/"}]},{"title":"JSåŸå‹ç†è§£","date":"2018-08-08T15:40:45.000Z","path":"2018/08/08/JSåŸå‹ã€åŸå‹é“¾/","text":"JSåŸå‹å’ŒåŸå‹é“¾jsåŸå‹jsåŸå‹å’ŒåŸå‹é“¾ä¸€ç›´æ˜¯jsä¸­ä¸€ä¸ªéš¾ç‚¹ï¼Œä¹Ÿæ˜¯é¢è¯•æ—¶å¤§æ¦‚ç‡çš„é—®é¢˜ï¼Œçœ‹äº†ç½‘ä¸Šå¾ˆå¤šçš„è¯´æ³•ï¼Œå¥½åƒéƒ½ä¸æ˜¯é‚£ä¹ˆé€šä¿—æ˜“æ‡‚ã€‚æˆ‘å°±ç”¨ç®€å•çš„æ–¹å¼æ¥ä»‹ç»ä»‹ç»ï¼Œæœ¬äººæ˜¯å‰ç«¯èœé¸Ÿï¼Œè¯´é”™äº†æ¬¢è¿å¤§å®¶æå‡ºæ¥ã€‚ æˆ‘ç†è§£ä¸­çš„åŸå‹æ˜¯ä¸ºäº†ç»§æ‰¿è€Œäº§ç”Ÿçš„ï¼Œä¸ºäº†é˜²æ­¢æ±¡æŸ“å…¨å±€å˜é‡ï¼Œæˆ‘ä»¬å¯ä»¥ç»™Personçš„åŸå‹åŠ ä¸Šä¸€ä¸ªsayHelloæ–¹æ³•ï¼Œè¿™ä¹Ÿæ˜¯æœ€ç®€å•çš„ä¾‹å­ï¼ˆè‡ªè¡Œè„‘è¡¥ä»£ç ï¼‰ï¼Œè¿™æ ·æˆ‘ä»¬å°±å¯ä»¥åœ¨Personçš„å®ä¾‹ä¸­å…±äº«sayHelloè¿™ä¸ªæ–¹æ³•ã€‚å›¾ä¸­çš„æ¯æ¡çº¿å…¶å®éƒ½å¯ä»¥ç”¨ä¸€ä¸ªå±æ€§ä»£æ›¿ï¼Œæˆ‘ç”»å‡ºæ¥ä½ ä»¬å°±ä¸€ç›®äº†ç„¶äº†ã€‚ æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼ŒPersonæ„é€ å‡½æ•°å¯ä»¥é€šè¿‡prototypeå±æ€§è®¿é—®å®ƒè‡ªå·±çš„åŸå‹å¯¹è±¡çš„ï¼Œè€Œå®ä¾‹åŒ–å‡ºæ¥çš„å¯¹è±¡å¯ä»¥é€šè¿‡_proto_å±æ€§è®¿é—®Perosonæ„é€ å‡½æ•°çš„åŸå‹å¯¹è±¡._proto_å±æ€§å…¶å®æ˜¯éæ ‡å‡†çš„å±æ€§ï¼Œä¹Ÿå°±æ˜¯è¯´è¿™æ˜¯æµè§ˆå™¨ä¸ºäº†æ–¹ä¾¿æ‰äº§ç”Ÿçš„å±æ€§ï¼Œä¸ºäº†ä»€ä¹ˆæ–¹ä¾¿ï¼Ÿå½“ç„¶æ˜¯ä¸ºäº†è°ƒè¯•çš„æ–¹ä¾¿å•¦ï¼Œæ‰€ä»¥æˆ‘ä»¬è¿˜æ˜¯å°½é‡ä¸è¦åœ¨ä»£ç ä¸­ä½¿ç”¨_proto_ï¼Œè€Œåœ¨è°ƒè¯•çš„æ—¶å€™ä½¿ç”¨ã€‚ jsåŸå‹é“¾ä¸Šé¢ç»™çš„æ˜¯ä¸€ä¸ªç®€å•çš„åŸå‹æ¨¡å‹ï¼Œæˆ‘ä»¬çŸ¥é“ï¼ŒåŸå‹å¯¹è±¡è¿˜æœ‰ä¸€ä¸ªå±æ€§constructorï¼Œè¿™ä¸ªå±æ€§å°±æ˜¯æŒ‡å‘è¯¥å¯¹è±¡çš„æ„é€ å‡½æ•°çš„ã€‚ä¸‹é¢æˆ‘ä»¬éœ€è¦äº†è§£å‡ ä¸ªæ¦‚å¿µï¼Œä»¥ä¾¿æˆ‘ä»¬æ¸…æ¥šçš„çŸ¥é“åŸå‹é“¾æ˜¯ä»€ä¹ˆï¼š1.æ¯ä¸ªæ„é€ å‡½æ•°éƒ½æœ‰åŸå‹å¯¹è±¡2.æ¯ä¸ªå¯¹è±¡éƒ½ä¼šæœ‰æ„é€ å‡½æ•°3.æ¯ä¸ªæ„é€ å‡½æ•°çš„åŸå‹éƒ½æ˜¯ä¸€ä¸ªå¯¹è±¡4.é‚£ä¹ˆè¿™ä¸ªåŸå‹å¯¹è±¡ä¹Ÿä¼šæœ‰æ„é€ å‡½æ•°5.é‚£ä¹ˆè¿™ä¸ªåŸå‹å¯¹è±¡çš„æ„é€ å‡½æ•°ä¹Ÿä¼šæœ‰åŸå‹å¯¹è±¡è¿™æ ·å°±å½¢æˆä¸€ä¸ªé“¾å¼ç»“æ„ï¼Œä¹Ÿå°±æ˜¯æˆ‘ä»¬è¯´çš„åŸå‹é“¾ ä»å›¾ä¸­æˆ‘ä»¬å°±å¯ä»¥æ¸…æ¥šçš„çœ‹åˆ°ä¸€ä¸ªåŸå‹é“¾ç»“æ„ï¼Œæˆ‘ä»¬çš„åŸå‹å…¶å®ä¹Ÿæ˜¯ä¸ªå¯¹è±¡ï¼Œå¯¹è±¡ä¹Ÿæ˜¯ç”±å¯¹è±¡æ„é€ å‡½æ•°ç”Ÿæˆçš„ï¼Œå…¶å®ä¹Ÿå°±æ˜¯ä¹‹å‰çš„åŸå‹ä¸‰è§’ç»“æ„çš„å»¶ä¼¸ï¼Œå¯ä»¥çœ‹åˆ°ï¼Œæ‰€æœ‰çš„å¯¹è±¡çš„åŸå‹æœ€é¡¶å±‚å°±æ˜¯nullã€‚","tags":[{"name":"JavaScript","slug":"JavaScript","permalink":"http://tanyibing.com/tags/JavaScript/"}]},{"title":"SEOè‡ªå­¦ç¬”è®°ï¼ˆäº”ï¼‰","date":"2018-08-02T14:03:55.000Z","path":"2018/08/02/SEOè‡ªå­¦ç¬”è®°ï¼ˆäº”ï¼‰/","text":"SEOè‡ªå­¦ç¬”è®°ï¼ˆäº”ï¼‰ä»Šå¤©ä¸»è¦çš„å·¥ä½œæ˜¯ä¼˜åŒ–å…¬å¸å®˜ç½‘çš„å…³é”®è¯ï¼Œå»å¤–ç½‘å‘å¤–é“¾ï¼Œè™½ç„¶å¿ƒä¸­è´¨ç–‘å¦‚ä»Šå¤–é“¾å¯¹ä¼˜åŒ–è¿˜æœ‰æ²¡æœ‰ä½œç”¨ï¼Œä½†è¿˜æ˜¯åšäº†ï¼Œä¹Ÿç§¯ç´¯äº†ä¸€äº›å›½å¤–çš„å¤–é“¾èµ„æºï¼Œæœ‰éœ€è¦çš„å°ä¼™ä¼´ä¹Ÿå¯ä»¥ç§èŠæˆ‘ï¼Œæˆ‘çš„ä¼é¹…æ˜¯820567197.è¨€å½’æ­£ä¼ ï¼ŒSEOæŠ½ç©ºçœ‹äº†ä¸€äº›ï¼Œåªæœ‰ä¸€å¼ ç¬”è®°ï¼Œå‘å‡ºæ¥ï¼š","tags":[{"name":"SEO","slug":"SEO","permalink":"http://tanyibing.com/tags/SEO/"}]},{"title":"SEOè‡ªå­¦ç¬”è®°ï¼ˆå››ï¼‰","date":"2018-08-01T13:53:59.000Z","path":"2018/08/01/SEOè‡ªå­¦ç¬”è®°ï¼ˆå››ï¼‰/","text":"SEOè‡ªå­¦ç¬”è®°ï¼ˆå››ï¼‰ä»¥ä¸‹æ˜¯ä»Šå¤©çš„è‡ªå­¦ç¬”è®°ï¼š","tags":[{"name":"SEO","slug":"SEO","permalink":"http://tanyibing.com/tags/SEO/"}]},{"title":"SEOè‡ªå­¦ç¬”è®°ï¼ˆä¸‰ï¼‰","date":"2018-07-31T13:58:21.000Z","path":"2018/07/31/SEOè‡ªå­¦ç¬”è®°ï¼ˆä¸‰ï¼‰/","text":"SEOè‡ªå­¦ç¬”è®°ï¼ˆä¸‰ï¼‰è‡ªä»githubè¢«å¾®è½¯æ”¶è´­ä¹‹åï¼Œæˆ‘ç”¨hexoæ¥å†™åšå®¢å°±ä¸æ˜¯é‚£ä¹ˆé¡ºåˆ©äº†ï¼Œå°±è·Ÿè¢«å¢™ä¸€æ ·ï¼Œç½‘ç«™æ‰“å¼€æ…¢å°±ä¸è¯´äº†ï¼Œæ˜¨æ™šä¸€ç›´hexo då‘½ä»¤æŠ¥é”™ï¼Œå®³å¾—æˆ‘æŠŠåšå®¢è¿ç§»äº†ä¸€éï¼Œæœ€åä¸çŸ¥é“æ€ä¹ˆé¬¼ä½¿ç¥å·®çš„ä¸Šä¼ å¥½äº†ã€‚ä»Šå¤©ä¸Šä¼ çš„æ—¶å€™åˆé‡åˆ°äº†é—®é¢˜ï¼Œæ­äº†æ¢¯å­æ‰è§£å†³ã€‚åœ¨è¿™åæ§½ä¸€ä¸‹ï¼Œçœ‹åˆ°å¾ˆå¤šäººå·²ç»æŠŠè‡ªå·±çš„é¡¹ç›®éƒ½è¿èµ°äº†ï¼Œæ„Ÿè§‰githubçš„æœªæ¥ä¸æ˜¯é‚£ä¹ˆç¾å¥½äº†ã€‚ è¨€å½’æ­£ä¼ ï¼Œå†ä¸Šä¼ ä¸€ä¸‹æˆ‘ä»Šå¤©é¢å¤–çš„SEOç¬”è®°ï¼š","tags":[{"name":"SEO","slug":"SEO","permalink":"http://tanyibing.com/tags/SEO/"}]},{"title":"SEOè‡ªå­¦ç¬”è®°ï¼ˆäºŒï¼‰","date":"2018-07-31T13:40:04.000Z","path":"2018/07/31/SEOè‡ªå­¦ç¬”è®°ï¼ˆäºŒï¼‰/","text":"SEOè‡ªå­¦ç¬”è®°ï¼ˆäºŒï¼‰ç´§æ¥ç€ç¬¬ä¸€å¤©çš„å†…å®¹ï¼Œä»Šå¤©çš„å­¦ä¹ ç¬”è®°å¦‚ä¸‹ï¼š","tags":[{"name":"SEO","slug":"SEO","permalink":"http://tanyibing.com/tags/SEO/"}]},{"title":"SEOè‡ªå­¦ç¬”è®°ï¼ˆä¸€ï¼‰","date":"2018-07-30T14:28:13.000Z","path":"2018/07/30/SEOè‡ªå­¦ç¬”è®°ï¼ˆä¸€ï¼‰/","text":"SEOè‡ªå­¦ç¬”è®°ï¼ˆä¸€ï¼‰æœ€è¿‘åœ¨å·¥ä½œä¸­è¦æ±‚å­¦ä¹ ä¸€äº›SEOçš„æŠ€æœ¯æ¥ç»™ä¸»ç«™è¿›è¡Œä¸€å®šçš„ä¼˜åŒ–ï¼Œæ‰€ä»¥è‡ªå­¦äº†SEOçš„ä¸€äº›çŸ¥è¯†ï¼Œæˆ‘é€šè¿‡xmindæ€ç»´å¯¼å›¾åšäº†ä¸€äº›ç¬”è®°ï¼Œä¸‹é¢å°±è´´å‡ºæˆ‘å­¦ä¹ çš„è¿‡ç¨‹ï¼š","tags":[{"name":"SEO","slug":"SEO","permalink":"http://tanyibing.com/tags/SEO/"}]},{"title":"PHPä¸­Sessionçš„æ¸…é™¤å’Œé”€æ¯","date":"2018-03-26T09:48:30.000Z","path":"2018/03/26/PHPä¸­Sessionçš„æ¸…é™¤å’Œé”€æ¯-1/","text":"PHPä¸­sessionæ¸…é™¤å’Œé”€æ¯ä»Šå¤©åœ¨å·¥ä½œä¸­ä½¿ç”¨sessionè¿›è¡Œç”¨æˆ·çš„ç™»å½•éªŒè¯æ“ä½œï¼Œæœ€åè¦è¿›è¡Œç”¨æˆ·æ³¨é”€çš„æ“ä½œï¼Œä¹Ÿå°±æ˜¯sessionçš„åˆ é™¤ï¼Œæ‰€ä»¥æŸ¥é˜…æ–‡æ¡£å‘ç°åˆ é™¤ä¼šè¯ä¸»è¦æœ‰åˆ é™¤å•ä¸ªä¼šè¯ã€åˆ é™¤æ‰€æœ‰ä¼šè¯å’Œç»“æŸå½“å‰ä¼šè¯çš„ä¸‰ç§æ–¹å¼ï¼Œä»¥ä¸‹å°±æ˜¯ä¸‰ç§æ¸…é™¤sessionçš„å…·ä½“æ–¹æ³•ï¼š 1.åˆ é™¤å•ä¸ªä¼šè¯åˆ é™¤å•ä¸ªä¼šè¯å…¶å®å°±æ˜¯åˆ å•ä¸ªä¼šè¯çš„å˜é‡ï¼Œå’Œæ•°ç»„çš„æ“ä½œä¸€æ ·ï¼Œç›´æ¥æ³¨é”€$_SESSIONæ•°ç»„çš„æŸä¸ªå…ƒç´ å³å¯ã€‚ä¾‹å¦‚ï¼š$_SESSION[â€œsession_nameâ€]å˜é‡ï¼Œå¯ä»¥ä½¿ç”¨unset()å‡½æ•°ï¼Œä»£ç å¦‚ä¸‹æ‰€ç¤ºï¼šunset($_SESSION[&quot;session_name&quot;]);æ³¨æ„ï¼šåœ¨ä½¿ç”¨unset()æ—¶ï¼Œè¦æ³¨æ„$SESSIONæ•°ç»„ä¸­çš„å…ƒç´ ä¸€å®šä¸å¯ä»¥å¯ç•¥ï¼Œå³ä¸å¯ä»¥ä¸€æ¬¡æ³¨é”€æ•´ä¸ªæ•°ç»„ï¼Œè¿™æ ·ä¼šç¦æ­¢æ•´ä¸ªä¼šè¯çš„åŠŸèƒ½ï¼Œä¸€æ—¦ä½¿ç”¨ä¼šå°†å…¨å±€å˜é‡$_SESSIONå…¨å±€å˜é‡é”€æ¯ï¼Œè€Œä¸”æ²¡æœ‰åŠæ³•å°†å…¶æ¢å¤ï¼Œç”¨æˆ·ä¹Ÿä¸å¯èƒ½å†æ³¨å†Œ$_SESSIONå˜é‡ï¼Œåœ¨phpæ–‡æ¡£ä¸­ä¹Ÿå¯ä»¥å‘ç°è­¦å‘Š Cautionè¯·ä¸è¦ä½¿ç”¨unset($ã€_SESSION)æ¥é‡Šæ”¾æ•´ä¸ª$_SESSIONï¼Œ å› ä¸ºå®ƒå°†ä¼šç¦ç”¨é€šè¿‡å…¨å±€$_SESSIONå»æ³¨å†Œä¼šè¯å˜é‡ 2.åˆ é™¤æ‰€æœ‰ä¼šè¯å¦‚æœæƒ³å§æŸä¸ªç”¨æˆ·åœ¨sessionä¸­æ³¨å†Œçš„æ‰€æœ‰å˜é‡éƒ½åˆ é™¤ï¼Œä¹Ÿå°±æ˜¯ä¸€æ¬¡åˆ é™¤æ‰€æœ‰çš„ä¼šè¯å˜é‡ï¼Œå¯ä»¥é€šè¿‡å°†ä¸€ä¸ªç©ºæ•°ç»„èµ‹å€¼ç»™$_SESSIONæ¥å®ç°ï¼Œå…¶ä»£ç æ˜¾ç¤ºå¦‚ä¸‹ï¼š$_SESSION = array();ä¹Ÿå¯ä»¥ä½¿ç”¨session_unset æ¥é‡Šæ”¾æ‰€æœ‰çš„ä¼šè¯å˜é‡,ä½¿ç”¨æ–¹æ³•å¦‚ä¸‹ï¼švoid session_unset ( void )è¯¥å‡½æ•°æ²¡æœ‰è¿”å›å€¼ã€‚ 3.åˆ é™¤å½“å‰ä¼šè¯å¦‚æœæ•´ä¸ªä¼šè¯å·²ç»ç»“æŸï¼Œé¦–å…ˆåº”è¯¥æ³¨é”€æ‰€æœ‰ä¼šè¯å˜é‡ï¼Œç„¶åä½¿ç”¨ session_destroy()å‡½æ•°æ¸…é™¤ç»“æŸå½“å‰çš„ä¼šè¯ï¼Œå¹¶æ¸…ç©ºä¼šè¯ä¸­çš„æ‰€æœ‰èµ„æºï¼Œå½»åº•é”€æ¯ Sessionï¼Œå…¶ä»£ç å¦‚ä¸‹æ˜¾ç¤ºï¼šsession_destroy()ï¼›ç›¸å¯¹äº session_start() å‡½æ•° ï¼ˆåˆ›å»º Session æ–‡ä»¶ï¼‰ï¼Œsession_destroy()å‡½æ•°ç”¨æ¥å…³é—­ Session çš„è¿ä½œ ï¼ˆåˆ é™¤ Session æ–‡ä»¶ï¼‰ï¼Œå¦‚æœæˆåŠŸåˆ™è¿”å› TUREï¼Œé”€æ¯ Session èµ„æ–™å¤±è´¥åˆ™è¿”å› FALSEã€‚ä½†è¯¥å‡½æ•°å¹¶ä¸ä¼šé‡Šæ”¾å’Œå½“å‰ Session ç›¸å…³çš„å˜é‡ï¼Œä¹Ÿä¸ä¼šåˆ é™¤ä¿å­˜åœ¨å®¢æˆ·ç«¯ Cookie ä¸­çš„ Session ID ã€‚ä¸‹é¢æ˜¯æˆ‘åœ¨ä»£ç ä¸­å®é™…ä½¿ç”¨çš„æ–¹æ³•ï¼š if(isset($_SESSION['username'])){ $_SESSION = array(); if(isset($_COOKIE[session_name()])){ setcookie(session_name(),'',time()-3600); } session_destroy(); }","tags":[{"name":"php","slug":"php","permalink":"http://tanyibing.com/tags/php/"},{"name":"session","slug":"session","permalink":"http://tanyibing.com/tags/session/"}]},{"title":"ä»è¾“å…¥URLåˆ°é¡µé¢æ¸²æŸ“å®Œæˆ","date":"2018-02-20T10:09:24.000Z","path":"2018/02/20/ä»è¾“å…¥URLåˆ°é¡µé¢æ¸²æŸ“å®Œæˆ/","text":"è½¬è½½è‡ªwww.chauncywu.com ä»è¾“å…¥URLåˆ°é¡µé¢æ¸²æŸ“å®ŒæˆåŸæ–‡-è‹±æ–‡è¯‘æ–‡ æ¨èé˜…è¯»ã€Šå›¾è§£HTTPã€‹ å„ç§åè®®ä¸HTTPåè®®çš„å…³ç³»(å‚ç…§è¯¥å›¾ç†è§£ä¸‹æ–‡) 0-1 1. è¾“å…¥URLåœ°å€ 1-1 2. æµè§ˆå™¨æ ¹æ®åŸŸåæŸ¥è¯¢IPåœ°å€ 2-1 ä»è¦è®¿é—®çš„åŸŸåä¸­è·å–IPåœ°å€ï¼ŒDNSæŸ¥è¯¢çš„æ­¥éª¤å¦‚ä¸‹ï¼š ä»æµè§ˆå™¨ç¼“å­˜ä¸­æŸ¥è¯¢ã€‚æµè§ˆå™¨ä¼šå­˜å‚¨ä¸€å®šæ—¶é—´çš„DNSè®°å½•ï¼Œæ“ä½œç³»ç»Ÿä¸ä¼šå‘Šè¯‰æµè§ˆå™¨æ¯ä¸ªDNSè®°å½•çš„ä¿å­˜æ—¶é™ï¼Œä¸åŒæµè§ˆå™¨è®¾ç½®ä¿å­˜æ—¶é™ä¸ºä¸€ä¸ªå›ºå®šå€¼ï¼ˆä¸åŒæµè§ˆå™¨æƒ…å†µä¸åŒï¼Œä¸€èˆ¬åœ¨2-30åˆ†é’Ÿï¼‰ã€‚ ä»æ“ä½œç³»ç»Ÿç¼“å­˜ä¸­æŸ¥è¯¢ã€‚å¦‚æœæµè§ˆå™¨ä¸­æ²¡æœ‰åŒ…å«æƒ³è¦çš„ç¼“å­˜è®°å½•ï¼Œé‚£æµè§ˆå™¨å°±ä¼šå‘èµ·æ“ä½œç³»ç»Ÿè¯·æ±‚ï¼Œç»§ç»­æŸ¥è¯¢æ“ä½œç³»ç»Ÿç¼“å­˜ ä»è·¯ç”±å™¨ä¸­æŸ¥è¯¢DNSç¼“å­˜ã€‚è¯·æ±‚æŒç»­å‘é€åˆ°ä½ çš„è·¯ç”±ï¼Œå®ƒé€šå¸¸ä¼šæœ‰è‡ªå·±çš„DNSç¼“å­˜ã€‚ ä»ISPä¸­æŸ¥è¯¢DNSç¼“å­˜ã€‚ä¸‹ä¸€ä¸ªè¢«æŸ¥è¯¢åœ°æ–¹æ˜¯ISPç¼“å­˜DNSçš„æœåŠ¡å™¨ã€‚ åŸŸåæœåŠ¡å™¨é€’å½’æŸ¥è¯¢ã€‚é¦–å…ˆä»rootåŸŸåæœåŠ¡å™¨ä¸­æŸ¥è¯¢å¦‚.comåŸŸåæœåŠ¡å™¨ï¼Œç„¶åé€æ­¥å‘å‰æŸ¥è¯¢ï¼Œ.comé¡¶çº§åŸŸåæœåŠ¡å™¨åˆ°Facebookçš„åŸŸåæœåŠ¡å™¨ã€‚ä¸€èˆ¬æ¥è¯´ï¼Œ.comçº§åˆ«çš„éƒ½å·²ç»åœ¨ç¼“å­˜ä¸­äº†ï¼Œæ‰€ä»¥ä¸€èˆ¬ä¸ä¼šè¿›è¡Œå¯¹rootåŸŸåæœåŠ¡å™¨çš„æŸ¥è¯¢ã€‚ä¸‹é¢ç»™å‡ºä¸€å¼ é€’å½’æŸ¥è¯¢çš„å›¾ã€‚æ‰©å±•ä»€ä¹ˆæ˜¯DNSï¼ŸDNSï¼ˆDomain Name Systemï¼ŒåŸŸåç³»ç»Ÿï¼‰ï¼Œå› ç‰¹ç½‘ä¸Šä½œä¸ºåŸŸåå’ŒIPåœ°å€ç›¸äº’æ˜ å°„çš„ä¸€ä¸ªåˆ†å¸ƒå¼æ•°æ®åº“ï¼Œèƒ½å¤Ÿä½¿ç”¨æˆ·æ›´æ–¹ä¾¿çš„è®¿é—®äº’è”ç½‘ï¼Œè€Œä¸ç”¨å»è®°ä½èƒ½å¤Ÿè¢«æœºå™¨ç›´æ¥è¯»å–çš„IPæ•°ä¸²ã€‚é€šè¿‡ä¸»æœºåï¼Œæœ€ç»ˆå¾—åˆ°è¯¥ä¸»æœºåå¯¹åº”çš„IPåœ°å€çš„è¿‡ç¨‹å«åšåŸŸåè§£æï¼ˆæˆ–ä¸»æœºåè§£æï¼‰ã€‚ DNSæŸ¥è¯¢çš„ä¸¤ç§æ–¹å¼ï¼šé€’å½’æŸ¥è¯¢å’Œè¿­ä»£æŸ¥è¯¢1ã€é€’å½’è§£æå½“å±€éƒ¨DNSæœåŠ¡å™¨è‡ªå·±ä¸èƒ½å›ç­”å®¢æˆ·æœºçš„DNSæŸ¥è¯¢æ—¶ï¼Œå®ƒå°±éœ€è¦å‘å…¶ä»–DNSæœåŠ¡å™¨è¿›è¡ŒæŸ¥è¯¢ã€‚æ­¤æ—¶æœ‰ä¸¤ç§æ–¹å¼ï¼Œå¦‚å›¾æ‰€ç¤ºçš„æ˜¯é€’å½’æ–¹å¼ã€‚å±€éƒ¨DNSæœåŠ¡å™¨è‡ªå·±è´Ÿè´£å‘å…¶ä»–DNSæœåŠ¡å™¨è¿›è¡ŒæŸ¥è¯¢ï¼Œä¸€èˆ¬æ˜¯å…ˆå‘è¯¥åŸŸåçš„æ ¹åŸŸæœåŠ¡å™¨æŸ¥è¯¢ï¼Œå†ç”±æ ¹åŸŸåæœåŠ¡å™¨ä¸€çº§çº§å‘ä¸‹æŸ¥è¯¢ã€‚æœ€åå¾—åˆ°çš„æŸ¥è¯¢ç»“æœè¿”å›ç»™å±€éƒ¨DNSæœåŠ¡å™¨ï¼Œå†ç”±å±€éƒ¨DNSæœåŠ¡å™¨è¿”å›ç»™å®¢æˆ·ç«¯ã€‚ 2-2 2ã€è¿­ä»£è§£æå½“å±€éƒ¨DNSæœåŠ¡å™¨è‡ªå·±ä¸èƒ½å›ç­”å®¢æˆ·æœºçš„DNSæŸ¥è¯¢æ—¶ï¼Œä¹Ÿå¯ä»¥é€šè¿‡è¿­ä»£æŸ¥è¯¢çš„æ–¹å¼è¿›è¡Œè§£æï¼Œå¦‚å›¾æ‰€ç¤ºã€‚å±€éƒ¨DNSæœåŠ¡å™¨ä¸æ˜¯è‡ªå·±å‘å…¶ä»–DNSæœåŠ¡å™¨è¿›è¡ŒæŸ¥è¯¢ï¼Œè€Œæ˜¯æŠŠèƒ½è§£æè¯¥åŸŸåçš„å…¶ä»–DNSæœåŠ¡å™¨çš„IPåœ°å€è¿”å›ç»™å®¢æˆ·ç«¯DNSç¨‹åºï¼Œå®¢æˆ·ç«¯DNSç¨‹åºå†ç»§ç»­å‘è¿™äº›DNSæœåŠ¡å™¨è¿›è¡ŒæŸ¥è¯¢ï¼Œç›´åˆ°å¾—åˆ°æŸ¥è¯¢ç»“æœä¸ºæ­¢ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œè¿­ä»£è§£æåªæ˜¯å¸®ä½ æ‰¾åˆ°ç›¸å…³çš„æœåŠ¡å™¨è€Œå·²ï¼Œè€Œä¸ä¼šå¸®ä½ å»æŸ¥ã€‚æ¯”å¦‚è¯´ï¼šbaidu.comçš„æœåŠ¡å™¨ipåœ°å€åœ¨192.168.4.5è¿™é‡Œï¼Œä½ è‡ªå·±å»æŸ¥å§ï¼Œæœ¬äººæ¯”è¾ƒå¿™ï¼Œåªèƒ½å¸®ä½ åˆ°è¿™é‡Œäº†ã€‚ 2-3 DNSåŸŸåç§°ç©ºé—´çš„ç»„ç»‡æ–¹å¼æˆ‘ä»¬åœ¨å‰é¢æœ‰è¯´åˆ°æ ¹DNSæœåŠ¡å™¨ï¼ŒåŸŸDNSæœåŠ¡å™¨ï¼Œè¿™äº›éƒ½æ˜¯DNSåŸŸåç§°ç©ºé—´çš„ç»„ç»‡æ–¹å¼ã€‚æŒ‰å…¶åŠŸèƒ½å‘½åç©ºé—´ä¸­ç”¨æ¥æè¿° DNS åŸŸåç§°çš„äº”ä¸ªç±»åˆ«çš„ä»‹ç»è¯¦è§ä¸‹è¡¨ä¸­ï¼Œä»¥åŠä¸æ¯ä¸ªåç§°ç±»å‹çš„ç¤ºä¾‹: 2-4 3. æµè§ˆå™¨å‘é€HTTPè¯·æ±‚åˆ°webæœåŠ¡å™¨å‘ http://facebook.com/ å‘å‡ºGETè¯·æ±‚ HTTPè¯·æ±‚æŠ¥æ–‡åœ¨è¯·æ±‚ä¸­ï¼ŒHTTPæŠ¥æ–‡é¦–éƒ¨ç”±æ–¹æ³•ã€URIã€HTTPç‰ˆæœ¬ã€HTTPé¦–éƒ¨å­—æ®µç­‰æ„æˆã€‚ 3-1 ç¡®ä¿å¯é æ€§çš„TCPåè®® 3-2 æ‰©å±•TCPä¸‰æ¬¡æ¡æ‰‹ ç¬¬ä¸€æ¬¡æ¡æ‰‹ï¼š å®¢æˆ·ç«¯Aå°†æ ‡å¿—ä½SYNç½®ä¸º1,éšæœºäº§ç”Ÿä¸€ä¸ªå€¼ä¸ºseq=Jï¼ˆJçš„å–å€¼èŒƒå›´ä¸º=1234567ï¼‰çš„æ•°æ®åŒ…åˆ°æœåŠ¡å™¨ï¼Œå®¢æˆ·ç«¯Aè¿›å…¥SYN_SENTçŠ¶æ€ï¼Œç­‰å¾…æœåŠ¡ç«¯Bç¡®è®¤ï¼› ç¬¬äºŒæ¬¡æ¡æ‰‹ï¼š æœåŠ¡ç«¯Bæ”¶åˆ°æ•°æ®åŒ…åç”±æ ‡å¿—ä½SYN=1çŸ¥é“å®¢æˆ·ç«¯Aè¯·æ±‚å»ºç«‹è¿æ¥ï¼ŒæœåŠ¡ç«¯Bå°†æ ‡å¿—ä½SYNå’ŒACKéƒ½ç½®ä¸º1ï¼Œack=J+1ï¼Œéšæœºäº§ç”Ÿä¸€ä¸ªå€¼seq=Kï¼Œå¹¶å°†è¯¥æ•°æ®åŒ…å‘é€ç»™å®¢æˆ·ç«¯Aä»¥ç¡®è®¤è¿æ¥è¯·æ±‚ï¼ŒæœåŠ¡ç«¯Bè¿›å…¥SYN_RCVDçŠ¶æ€ã€‚ ç¬¬ä¸‰æ¬¡æ¡æ‰‹ï¼š å®¢æˆ·ç«¯Aæ”¶åˆ°ç¡®è®¤åï¼Œæ£€æŸ¥ackæ˜¯å¦ä¸ºJ+1ï¼ŒACKæ˜¯å¦ä¸º1ï¼Œå¦‚æœæ­£ç¡®åˆ™å°†æ ‡å¿—ä½ACKç½®ä¸º1ï¼Œack=K+1ï¼Œå¹¶å°†è¯¥æ•°æ®åŒ…å‘é€ç»™æœåŠ¡ç«¯Bï¼ŒæœåŠ¡ç«¯Bæ£€æŸ¥ackæ˜¯å¦ä¸ºK+1ï¼ŒACKæ˜¯å¦ä¸º1ï¼Œå¦‚æœæ­£ç¡®åˆ™è¿æ¥å»ºç«‹æˆåŠŸï¼Œå®¢æˆ·ç«¯Aå’ŒæœåŠ¡ç«¯Bè¿›å…¥ESTABLISHEDçŠ¶æ€ï¼Œå®Œæˆä¸‰æ¬¡æ¡æ‰‹ï¼Œéšåå®¢æˆ·ç«¯Aä¸æœåŠ¡ç«¯Bä¹‹é—´å¯ä»¥å¼€å§‹ä¼ è¾“æ•°æ®äº†ã€‚ 3-2-1 ä¸ºä»€éœ€è¦ä¸‰æ¬¡æ¡æ‰‹ï¼Ÿã€Šè®¡ç®—æœºç½‘ç»œã€‹ç¬¬å››ç‰ˆä¸­è®²â€œä¸‰æ¬¡æ¡æ‰‹â€çš„ç›®çš„æ˜¯â€œä¸ºäº†é˜²æ­¢å·²å¤±æ•ˆçš„è¿æ¥è¯·æ±‚æŠ¥æ–‡æ®µçªç„¶åˆä¼ é€åˆ°äº†æœåŠ¡ç«¯ï¼Œå› è€Œäº§ç”Ÿé”™è¯¯â€ ä¹¦ä¸­çš„ä¾‹å­æ˜¯è¿™æ ·çš„ï¼Œâ€œå·²å¤±æ•ˆçš„è¿æ¥è¯·æ±‚æŠ¥æ–‡æ®µâ€çš„äº§ç”Ÿåœ¨è¿™æ ·ä¸€ç§æƒ…å†µä¸‹ï¼šclientå‘å‡ºçš„ç¬¬ä¸€ä¸ªè¿æ¥è¯·æ±‚æŠ¥æ–‡æ®µå¹¶æ²¡æœ‰ä¸¢å¤±ï¼Œè€Œæ˜¯åœ¨æŸä¸ªç½‘ç»œç»“ç‚¹é•¿æ—¶é—´çš„æ»ç•™äº†ï¼Œä»¥è‡´å»¶è¯¯åˆ°è¿æ¥é‡Šæ”¾ä»¥åçš„æŸä¸ªæ—¶é—´æ‰åˆ°è¾¾serverã€‚æœ¬æ¥è¿™æ˜¯ä¸€ä¸ªæ—©å·²å¤±æ•ˆçš„æŠ¥æ–‡æ®µã€‚ä½†serveræ”¶åˆ°æ­¤å¤±æ•ˆçš„è¿æ¥è¯·æ±‚æŠ¥æ–‡æ®µåï¼Œå°±è¯¯è®¤ä¸ºæ˜¯clientå†æ¬¡å‘å‡ºçš„ä¸€ä¸ªæ–°çš„è¿æ¥è¯·æ±‚ã€‚äºæ˜¯å°±å‘clientå‘å‡ºç¡®è®¤æŠ¥æ–‡æ®µï¼ŒåŒæ„å»ºç«‹è¿æ¥ã€‚ å‡è®¾ä¸é‡‡ç”¨â€œä¸‰æ¬¡æ¡æ‰‹â€ï¼Œé‚£ä¹ˆåªè¦serverå‘å‡ºç¡®è®¤ï¼Œæ–°çš„è¿æ¥å°±å»ºç«‹äº†ã€‚ç”±äºç°åœ¨clientå¹¶æ²¡æœ‰å‘å‡ºå»ºç«‹è¿æ¥çš„è¯·æ±‚ï¼Œå› æ­¤ä¸ä¼šç†ç¬serverçš„ç¡®è®¤ï¼Œä¹Ÿä¸ä¼šå‘serverå‘é€æ•°æ®ã€‚ä½†serverå´ä»¥ä¸ºæ–°çš„è¿è¾“è¿æ¥å·²ç»å»ºç«‹ï¼Œå¹¶ä¸€ç›´ç­‰å¾…clientå‘æ¥æ•°æ®ã€‚è¿™æ ·ï¼Œserverçš„å¾ˆå¤šèµ„æºå°±ç™½ç™½æµªè´¹æ‰äº†ã€‚é‡‡ç”¨â€œä¸‰æ¬¡æ¡æ‰‹â€çš„åŠæ³•å¯ä»¥é˜²æ­¢ä¸Šè¿°ç°è±¡å‘ç”Ÿã€‚ ä¾‹å¦‚åˆšæ‰é‚£ç§æƒ…å†µï¼Œclientä¸ä¼šå‘serverçš„ç¡®è®¤å‘å‡ºç¡®è®¤ã€‚serverç”±äºæ”¶ä¸åˆ°ç¡®è®¤ï¼Œå°±çŸ¥é“clientå¹¶æ²¡æœ‰è¦æ±‚å»ºç«‹è¿æ¥ã€‚â€ã€‚ä¸»è¦ç›®çš„é˜²æ­¢serverç«¯ä¸€ç›´ç­‰å¾…ï¼Œæµªè´¹èµ„æºã€‚ TCPå››æ¬¡æŒ¥æ‰‹ ç¬¬ä¸€æ¬¡æŒ¥æ‰‹ï¼š Clientå‘é€ä¸€ä¸ªFINï¼Œç”¨æ¥å…³é—­Clientåˆ°Serverçš„æ•°æ®ä¼ é€ï¼ŒClientè¿›å…¥FIN_WAIT_1çŠ¶æ€ã€‚ ç¬¬äºŒæ¬¡æŒ¥æ‰‹ï¼š Serveræ”¶åˆ°FINåï¼Œå‘é€ä¸€ä¸ªACKç»™Clientï¼Œç¡®è®¤åºå·ä¸ºæ”¶åˆ°åºå·+1ï¼ˆä¸SYNç›¸åŒï¼Œä¸€ä¸ªFINå ç”¨ä¸€ä¸ªåºå·ï¼‰ï¼ŒServerè¿›å…¥CLOSE_WAITçŠ¶æ€ã€‚ ç¬¬ä¸‰æ¬¡æŒ¥æ‰‹ï¼š Serverå‘é€ä¸€ä¸ªFINï¼Œç”¨æ¥å…³é—­Serveråˆ°Clientçš„æ•°æ®ä¼ é€ï¼ŒServerè¿›å…¥LAST_ACKçŠ¶æ€ã€‚ ç¬¬å››æ¬¡æŒ¥æ‰‹ï¼š Clientæ”¶åˆ°FINåï¼ŒClientè¿›å…¥TIME_WAITçŠ¶æ€ï¼Œæ¥ç€å‘é€ä¸€ä¸ªACKç»™Serverï¼Œç¡®è®¤åºå·ä¸ºæ”¶åˆ°åºå·+1ï¼ŒServerè¿›å…¥CLOSEDçŠ¶æ€ï¼Œå®Œæˆå››æ¬¡æŒ¥æ‰‹ã€‚ 3-2-2 ä¸ºä»€ä¹ˆå»ºç«‹è¿æ¥æ˜¯ä¸‰æ¬¡æ¡æ‰‹ï¼Œè€Œå…³é—­è¿æ¥å´æ˜¯å››æ¬¡æŒ¥æ‰‹å‘¢ï¼Ÿè¿™æ˜¯å› ä¸ºæœåŠ¡ç«¯åœ¨LISTENçŠ¶æ€ä¸‹ï¼Œæ”¶åˆ°å»ºç«‹è¿æ¥è¯·æ±‚çš„SYNæŠ¥æ–‡åï¼ŒæŠŠACKå’ŒSYNæ”¾åœ¨ä¸€ä¸ªæŠ¥æ–‡é‡Œå‘é€ç»™å®¢æˆ·ç«¯ã€‚ è€Œå…³é—­è¿æ¥æ—¶ï¼Œå½“æ”¶åˆ°å¯¹æ–¹çš„FINæŠ¥æ–‡æ—¶ï¼Œä»…ä»…è¡¨ç¤ºå¯¹æ–¹ä¸å†å‘é€æ•°æ®äº†ä½†æ˜¯è¿˜èƒ½æ¥æ”¶æ•°æ®ï¼Œå·±æ–¹ä¹Ÿæœªå¿…å…¨éƒ¨æ•°æ®éƒ½å‘é€ç»™å¯¹æ–¹äº†ï¼Œæ‰€ä»¥å·±æ–¹å¯ä»¥ç«‹å³closeï¼Œä¹Ÿå¯ä»¥å‘é€ä¸€äº›æ•°æ®ç»™å¯¹æ–¹åï¼Œå†å‘é€FINæŠ¥æ–‡ç»™å¯¹æ–¹æ¥è¡¨ç¤ºåŒæ„ç°åœ¨å…³é—­è¿æ¥ï¼Œå› æ­¤ï¼Œå·±æ–¹ACKå’ŒFINä¸€èˆ¬éƒ½ä¼šåˆ†å¼€å‘é€ã€‚ ä»€ä¹ˆæ˜¯åå‘ä»£ç†ï¼Ÿå®¢æˆ·ç«¯æœ¬æ¥å¯ä»¥ç›´æ¥é€šè¿‡HTTPåè®®è®¿é—®æŸç½‘ç«™åº”ç”¨æœåŠ¡å™¨ï¼Œç½‘ç«™ç®¡ç†å‘˜å¯ä»¥åœ¨ä¸­é—´åŠ ä¸Šä¸€ä¸ªNginxï¼Œå®¢æˆ·ç«¯è¯·æ±‚Nginxï¼ŒNginxè¯·æ±‚åº”ç”¨æœåŠ¡å™¨ï¼Œç„¶åå°†ç»“æœè¿”å›ç»™å®¢æˆ·ç«¯ï¼Œæ­¤æ—¶Nginxå°±æ˜¯åå‘ä»£ç†æœåŠ¡å™¨ã€‚ 3-2-3 è´Ÿè´£ä¼ è¾“çš„IPåè®® IPé—´çš„é€šä¿¡ä¾èµ–MACåœ°å€ ARPåè®®ï¼š(Address Resolution Protocol)ç”¨ä»¥è§£æåœ°å€çš„åè®®ï¼Œæ ¹æ®é€šä¿¡æ–¹çš„IPåœ°å€å°±å¯ä»¥åæŸ¥å‡ºå¯¹åº”çš„MACåœ°å€ 3-3 4. FacebookæœåŠ¡å™¨è¿”å›ä¸€ä¸ªæ°¸ä¹…é‡å®šå‘å“åº”æœåŠ¡å™¨ä¼šå‘é€ä¸€ä¸ª301æ°¸ä¹…é‡å®šå‘å“åº”æ¥å‘Šè¯‰æµè§ˆå™¨è®¿é—® http://www.facebook.com/ è€Œä¸æ˜¯ http://facebook.com/ã€‚ ä¸ºä»€ä¹ˆæœåŠ¡å™¨åšæŒé‡å®šå‘è€Œä¸æ˜¯ç›´æ¥ç»™äºˆæµè§ˆå™¨ç”¨æˆ·éœ€è¦çš„ç»“æœï¼Œè¿™æœ‰å¾ˆå¤šæœ‰æ„æ€åŸå› : ä¸€ä¸ªåŸå› æ˜¯æœç´¢å¼•æ“æ’åï¼Œå¦‚æœæœ‰ä¸¤ä¸ªURLsæŒ‡å‘åŒä¸€ä¸ªé¡µé¢ï¼Œæ¯”å¦‚ http://www.igoro.com/ å’Œ http://igoro.com/ ,æœç´¢å¼•æ“ä¼šè®¤ä¸ºè¿™æ˜¯ä¸¤ä¸ªä¸åŒçš„ç½‘ç«™ï¼Œç»“æœä»–ä»¬ä¸¤ä¸ªæ¯ä¸ªéƒ½æœ‰ä¸€éƒ¨åˆ†è®¿é—®é‡ï¼Œä½†æ˜¯ä¹Ÿåªèƒ½æ‹¥æœ‰æ›´ä½çš„æœç´¢å¼•æ“æ’åã€‚å¦‚æœä½¿ç”¨äº†301å®šä½ï¼Œæœç´¢å¼•æ“å°†ä¼šè¯†åˆ«é‡å®šå‘ï¼Œè¿›è€Œå°†åŒä¸€æ¥æºçš„å¤šä¸ªé“¾æ¥ç®—ä½œä¸€ä¸ªã€‚ å¦ä¸€ä¸ªåŸå› æ˜¯ï¼ŒåŒæ ·çš„å†…å®¹å¤šä¸ªURLsè¿˜ä¸åˆ©äºç¼“å­˜ï¼ŒåŒæ ·çš„å†…å®¹æ‹¥æœ‰å¤šä¸ªåå­—ï¼Œæ½œåœ¨é€ æˆç¼“å­˜æµªè´¹ã€‚ æ‰©å±•301å’Œ302çš„åŒºåˆ«ï¼š301å’Œ302çŠ¶æ€ç éƒ½è¡¨ç¤ºé‡å®šå‘ï¼Œå°±æ˜¯è¯´æµè§ˆå™¨åœ¨æ‹¿åˆ°æœåŠ¡å™¨è¿”å›çš„è¿™ä¸ªçŠ¶æ€ç åä¼šè‡ªåŠ¨è·³è½¬åˆ°ä¸€ä¸ªæ–°çš„URLåœ°å€ï¼Œè¿™ä¸ªåœ°å€å¯ä»¥ä»å“åº”çš„Locationé¦–éƒ¨ä¸­è·å–ï¼ˆç”¨æˆ·çœ‹åˆ°çš„æ•ˆæœå°±æ˜¯ä»–è¾“å…¥çš„åœ°å€Aç¬é—´å˜æˆäº†å¦ä¸€ä¸ªåœ°å€Bï¼‰â€”â€”è¿™æ˜¯å®ƒä»¬çš„å…±åŒç‚¹ã€‚ ä»–ä»¬çš„ä¸åŒåœ¨äºã€‚301è¡¨ç¤ºæ—§åœ°å€Açš„èµ„æºå·²ç»è¢«æ°¸ä¹…åœ°ç§»é™¤äº†ï¼ˆè¿™ä¸ªèµ„æºä¸å¯è®¿é—®äº†ï¼‰ï¼Œæœç´¢å¼•æ“åœ¨æŠ“å–æ–°å†…å®¹çš„åŒæ—¶ä¹Ÿå°†æ—§çš„ç½‘å€æ¢ä¸ºé‡å®šå‘ä¹‹åçš„ç½‘å€ï¼› 302è¡¨ç¤ºæ—§åœ°å€Açš„èµ„æºè¿˜åœ¨ï¼ˆä»ç„¶å¯ä»¥è®¿é—®ï¼‰ï¼Œè¿™ä¸ªé‡å®šå‘åªæ˜¯ä¸´æ—¶åœ°ä»æ—§åœ°å€Aè·³è½¬åˆ°åœ°å€Bï¼Œæœç´¢å¼•æ“ä¼šæŠ“å–æ–°çš„å†…å®¹è€Œä¿å­˜æ—§çš„ç½‘å€ã€‚ SEO 302å¥½äº301 é‡å®šå‘åŸå› ï¼š ç½‘ç«™è°ƒæ•´ï¼ˆå¦‚æ”¹å˜ç½‘é¡µç›®å½•ç»“æ„ï¼‰ï¼› ç½‘é¡µè¢«ç§»åˆ°ä¸€ä¸ªæ–°åœ°å€ï¼› ç½‘é¡µæ‰©å±•åæ”¹å˜(å¦‚åº”ç”¨éœ€è¦æŠŠ.phpæ”¹æˆ.Htmlæˆ–.shtml)ã€‚ è¿™ç§æƒ…å†µä¸‹ï¼Œå¦‚æœä¸åšé‡å®šå‘ï¼Œåˆ™ç”¨æˆ·æ”¶è—å¤¹æˆ–æœç´¢å¼•æ“æ•°æ®åº“ä¸­æ—§åœ°å€åªèƒ½è®©è®¿é—®å®¢æˆ·å¾—åˆ°ä¸€ä¸ª404é¡µé¢é”™è¯¯ä¿¡æ¯ï¼Œè®¿é—®æµé‡ç™½ç™½ä¸§å¤±ï¼›å†è€…æŸäº›æ³¨å†Œäº†å¤šä¸ªåŸŸåçš„ç½‘ç«™ï¼Œä¹Ÿéœ€è¦é€šè¿‡é‡å®šå‘è®©è®¿é—®è¿™äº›åŸŸåçš„ç”¨æˆ·è‡ªåŠ¨è·³è½¬åˆ°ä¸»ç«™ç‚¹ç­‰ã€‚ ä»€ä¹ˆæ—¶å€™è¿›è¡Œ301æˆ–è€…302è·³è½¬å‘¢ï¼Ÿå½“ä¸€ä¸ªç½‘ç«™æˆ–è€…ç½‘é¡µ24â€”48å°æ—¶å†…ä¸´æ—¶ç§»åŠ¨åˆ°ä¸€ä¸ªæ–°çš„ä½ç½®ï¼Œè¿™æ—¶å€™å°±è¦è¿›è¡Œ302è·³è½¬ï¼Œè€Œä½¿ç”¨301è·³è½¬çš„åœºæ™¯å°±æ˜¯ä¹‹å‰çš„ç½‘ç«™å› ä¸ºæŸç§åŸå› éœ€è¦ç§»é™¤æ‰ï¼Œç„¶åè¦åˆ°æ–°çš„åœ°å€è®¿é—®ï¼Œæ˜¯æ°¸ä¹…æ€§çš„ã€‚ æ¸…æ™°æ˜ç¡®è€Œè¨€ï¼šä½¿ç”¨301è·³è½¬çš„å¤§æ¦‚åœºæ™¯å¦‚ä¸‹ï¼š 1ã€ åŸŸååˆ°æœŸä¸æƒ³ç»­è´¹ï¼ˆæˆ–è€…å‘ç°äº†æ›´é€‚åˆç½‘ç«™çš„åŸŸåï¼‰ï¼Œæƒ³æ¢ä¸ªåŸŸåã€‚2ã€ åœ¨æœç´¢å¼•æ“çš„æœç´¢ç»“æœä¸­å‡ºç°äº†ä¸å¸¦wwwçš„åŸŸåï¼Œè€Œå¸¦wwwçš„åŸŸåå´æ²¡æœ‰æ”¶å½•ï¼Œè¿™ä¸ªæ—¶å€™å¯ä»¥ç”¨301é‡å®šå‘æ¥å‘Šè¯‰æœç´¢å¼•æ“æˆ‘ä»¬ç›®æ ‡çš„åŸŸåæ˜¯å“ªä¸€ä¸ªã€‚3ã€ ç©ºé—´æœåŠ¡å™¨ä¸ç¨³å®šï¼Œæ¢ç©ºé—´çš„æ—¶å€™ã€‚ 5. æµè§ˆå™¨ä¼šè·Ÿè¸ªé‡å®šå‘åœ°å€æµè§ˆå™¨çŸ¥é“äº† http://www.facebook.com/ æ˜¯çœŸæ­£åº”è¯¥è®¿é—®çš„URLï¼Œæ‰€ä»¥å°±å‘é€äº†å¦å¤–ä¸€ä¸ªGETè¯·æ±‚ã€‚ 6. æœåŠ¡å™¨å¤„ç†è¯·æ±‚æœåŠ¡å™¨ä¼šæ¥æ”¶è¿™ä¸ªGETè¯·æ±‚ï¼Œå¹¶ä¸”è¿”å›ä¸€ä¸ªå“åº”ç»“æœ æ€ä¹ˆå­˜å‚¨æ•°æ®æ˜¯æ¯ä¸ªåŠ¨æ€ç½‘ç«™éƒ½ä¼šé¢ä¸´çš„æœ‰è¶£éš¾é¢˜å°ç½‘ç«™ä¼šç»å¸¸æœ‰ä¸€ä¸ªSQLæ•°æ®åº“æ¥å­˜å‚¨ä»–ä»¬çš„æ•°æ®ï¼Œä½†æ˜¯ç½‘ç«™å­˜å‚¨æ•°æ®é‡è¿‡å¤§æˆ–è€…æµé‡è¿‡å¤§åå°±å¿…é¡»å°†æ•°æ®åº“åˆ†å¸ƒåœ¨å¤šå°æœºå™¨ï¼Œè§£å†³çš„æ–¹æ³•æœ‰å¾ˆå¤šç§ åŒ…æ‹¬sharding(åœ¨ä¸»é”®åŸºç¡€ä¸Šåˆ’åˆ†è¡¨åˆ°å¤šä¸ªæ•°æ®åº“ä¸­)ï¼Œå¤åˆ¶å’Œä½¿ç”¨ç®€åŒ–çš„å¼±è¯­ä¹‰ä¸€è‡´æ€§æ•°æ®åº“ æ¨è¿Ÿä¸€äº›ä»»åŠ¡åˆ°æ‰¹å¤„ç†ä½œä¸šæ˜¯å»‰ä»·ä¿æŒæ•°æ®æ›´æ–°çš„çš„ä¸€ç§æŠ€æœ¯ã€‚ä¾‹å¦‚ï¼ŒFacebookå¿…é¡»å°½å¿«æ›´æ–°æ–°é—»ä¾›åº”ï¼Œä½†æ•°æ®æ”¯æŒçš„â€œä½ å¯èƒ½è®¤è¯†çš„äººâ€åŠŸèƒ½å¯èƒ½åªéœ€è¦æ¯æ™šè¿›è¡Œæ›´æ–°ï¼ˆä½œè€…çŒœæµ‹æ˜¯è¿™æ ·ï¼‰ã€‚æ‰¹å¤„ç†ä½œä¸šçš„æ›´æ–°å¯¼è‡´å­˜åœ¨ä¸€äº›æ—§çš„ç›¸å¯¹ä¸é‡è¦çš„æ•°æ®ï¼Œä½†æ˜¯ä½¿æ•°æ®æ›´æ–°æ›´å¿«æ›´ç®€å•ã€‚ 7.æœåŠ¡å™¨è¿”å›ä¸€ä¸ªHTMLå“åº”123456789101112HTTP/1.1 200 OKCache-Control: private, no-store, no-cache, must-revalidate, post-check=0, pre-check=0Expires: Sat, 01 Jan 2000 00:00:00 GMTP3P: CP=&quot;DSP LAW&quot;Pragma: no-cacheContent-Encoding: gzipContent-Type: text/html; charset=utf-8X-Cnection: closeTransfer-Encoding: chunkedDate: Fri, 12 Feb 2010 09:05:55 GMT... æ•´ä¸ªå®Œæ•´çš„å“åº”æ˜¯36KBï¼Œå…¶ä¸­å¤§éƒ¨åˆ†å¤„ç†åç”±blobç±»å‹ä¼ é€å†…å®¹ç¼–ç å¤´éƒ¨å‘Šè¯‰æµè§ˆå™¨å“åº”ä½“ä½¿ç”¨äº†gzipå‹ç¼©ç®—æ³•ã€‚åœ¨è§£æblobåï¼Œä½ å°±ä¼šçœ‹åˆ°ä½ æœŸæœ›çš„HTMLäº†ã€‚ 8. æµè§ˆå™¨å¼€å§‹æ¸²æŸ“HTMLåœ¨æµè§ˆå™¨æ¥æ”¶å®Œæ•´HTMLæ–‡ä»¶å‰ï¼Œæµè§ˆå™¨å°±å¼€å§‹æ¸²æŸ“é¡µé¢äº†ã€‚ 9. æµè§ˆå™¨å‘é€åµŒå…¥åœ¨HTMLä¸­çš„å¯¹è±¡çš„è¯·æ±‚éšç€æµè§ˆå™¨æ¸²æŸ“HTMLï¼Œæµè§ˆå™¨ä¼šæ³¨æ„åˆ°æœ‰äº›æ ‡ç­¾éœ€è¦è¯·æ±‚å…¶ä»–URLsçš„èµ„æºï¼Œæµè§ˆå™¨å°†ä¼šå‘é€ä¸€ä¸ªGETè¯·æ±‚æ¥é‡æ–°è·å–æ¯ä¸ªæ–‡ä»¶ ã€‚ 10. æµè§ˆå™¨å‘é€å¼‚æ­¥è¯·æ±‚åœ¨web2.0æ—¶ä»£ï¼Œå³ä½¿åœ¨é¡µé¢æ¸²æŸ“åå®¢æˆ·ç«¯è¿˜æ˜¯æŒç»­ä¸æœåŠ¡å™¨ç«¯é€šä¿¡ã€‚ ä¾‹å¦‚ï¼Œå½“ä½ çš„æœ‹å‹ä¸Šçº¿æˆ–ä¸‹çº¿æ—¶ï¼ŒFacebookèŠå¤©åŠŸèƒ½å°†ä¼šæŒç»­æ›´æ–°ä½ å·²ç»ç™»å½•çš„æœ‹å‹åˆ—è¡¨ã€‚ä¸ºäº†æ›´æ–°è¿™ä¸ªåˆ—è¡¨ï¼Œä½ æµè§ˆå™¨ä¸Šè¿è¡Œçš„JSå°†ä¼šå‘é€å¼‚æ­¥è¯·æ±‚åˆ°æœåŠ¡å™¨ï¼Œå¼‚æ­¥è¯·æ±‚æ˜¯å‘é€ç»™ç‰¹æ®ŠURLçš„GETæˆ–POSTè¯·æ±‚ã€‚åœ¨Facebookçš„ä¾‹å­ä¸­ï¼Œå®¢æˆ·ç«¯ä¼šå‘é€ä¸€ä¸ªPOSTè¯·æ±‚åˆ° http://www.facebook.com/ajax/chat/buddy_list.php ï¼Œè·å–ä½ åœ¨çº¿çš„æœ‹å‹åˆ—è¡¨ è¿™ä¸ªæ¨¡å¼è¢«ç§°ä¸ºAJAXï¼Œæ˜¯â€œAsynchronous JavaScript And XMLâ€,çš„ç¼©å†™ï¼Œè™½ç„¶ä¸å¤ªæ¸…æ¥šä¸ºä»€ä¹ˆæœåŠ¡å™¨å¿…é¡»å°†å“åº”æ ¼å¼åŒ–ä¸ºxmlã€‚ ç›¸å…³é˜…è¯»ï¼šå½“ä½ è®¿é—®æ·˜å®çš„æ—¶å€™ï¼Œå‘ç”Ÿäº†ä»€ä¹ˆï¼Ÿ","tags":[{"name":"HTTP","slug":"HTTP","permalink":"http://tanyibing.com/tags/HTTP/"},{"name":"URL","slug":"URL","permalink":"http://tanyibing.com/tags/URL/"}]},{"title":"hadoopå•æœºå®‰è£…ã€è¿è¡Œ","date":"2017-12-28T14:28:13.000Z","path":"2017/12/28/hadoopå•æœºé…ç½®ã€è¿è¡Œ/","text":"äº‘è®¡ç®— hadoop é…ç½®æ­¥éª¤Tanyibingï¼Œthis is for 14çº§è½¯ä»¶å·¥ç¨‹ä¸“ä¸šï¼ŒMy email &#116;&#x61;&#x6e;&#121;&#x69;&#x62;&#105;&#x6e;&#x67;&#49;&#x39;&#x39;&#53;&#64;&#103;&#109;&#x61;&#x69;&#x6c;&#46;&#99;&#111;&#109; link Hadoopç¯å¢ƒå‡†å¤‡å·¥ä½œ VMwareç‰ˆæœ¬VMware-workstation-full-12.5.7-5813279(ç‰ˆæœ¬è‡ªå·±é€‰æ‹©)Xshell5è‡ªå·±é€‰æ‹©æ˜¯å¦ä½¿ç”¨ CentOSç‰ˆæœ¬CentOS-6.4-x86_64-bin-DVD1(æœ¬äººçš„æ˜¯64ä½ï¼Œå…¶ä»–ç‰ˆæœ¬æœªæµ‹è¯•) Hadoopç‰ˆæœ¬hadoop-2.6.0(å®‰è£…å®Œç³»ç»Ÿåç›´æ¥å‘½ä»¤è¡Œå®‰è£…) jdkç‰ˆæœ¬jdk-8u45-linux-x64.tar éœ€è¦äº†è§£åŸºæœ¬çš„linuxå’Œvimçš„ä½¿ç”¨ èµ„æºä½ç½®ç™¾åº¦ç½‘ç›˜:https://pan.baidu.com/s/1i5s2eFFå¯†ç :n3jq CentOSé•œåƒä¸‹è½½åœ°å€http://mirror.nsc.liu.se/centos-store/6.4/isos/x86_64/ VMwareå®‰è£…ä»¥åŠCentOSå®‰è£…VMwareå®‰è£…æ­¥éª¤çœç•¥CentOSå®‰è£…1.ç‚¹å‡»æ–°å»ºè™šæ‹Ÿæœº 2.é€‰æ‹©ç¨åæ“ä½œç³»ç»Ÿ 3.é€‰æ‹©64ä½CentOSçš„ç³»ç»Ÿ 4.é€‰æ‹©å®‰è£…ä½ç½®(æœ€å¥½ä¸è¦æ”¾Cç›˜) 5.é»˜è®¤é…ç½®å°±å¥½ï¼Œç‚¹å‡»ä¸‹ä¸€æ­¥ 6.ç‚¹å‡»è‡ªå®šä¹‰ç¡¬ä»¶ 7.é…ç½®è™šæ‹Ÿæœºçš„å†…å­˜ï¼Œæˆ‘ä»¬çš„å®éªŒ1Gå³å¯ï¼Œç”µè„‘å¥½çš„é€‰æ‹©2Gä¹Ÿå¯ 8.é€‰æ‹©è™šæ‹ŸåŒ–cpu(ä½¿ç”¨æœ¬æœºçœŸå®cpu) 9.é€‰æ‹©åŠ è½½çš„é•œåƒï¼Œé€‰1ç›˜ï¼Œå¦‚æœè‡ªå·±ä¸‹è½½çš„è¯2ç›˜æ˜¯ä¸€äº›è½¯ä»¶ï¼Œä¸éœ€è¦åŠ è½½ 10.æ¡¥æ¥å’ŒNATæ¨¡å¼æ‰èƒ½ä¸Šç½‘ï¼Œæˆ‘é€‰æ‹©çš„æ˜¯æ¡¥æ¥(ä½¿ç”¨è‡ªå·±çš„çœŸå®ç½‘å¡) 11.é€‰æ‹©ç¬¬ä¸€ä¸ªé€‰é¡¹(å®‰è£…æˆ–å‡çº§ç³»ç»Ÿ) 12.è¿™ä¸€æ­¥é€‰skipè·³è¿‡å³å¯ 13.é€‰æ‹©ç®€ä½“ä¸­æ–‡ï¼Œç‚¹å‡»ä¸‹ä¸€æ­¥ 14.é€‰æ‹©è‹±å›½ç¾å¼ï¼Œä¸‹ä¸€æ­¥ 15.é€‰æ‹©é»˜è®¤çš„åŸºæœ¬å­˜å‚¨è®¾å¤‡ï¼Œä¸‹ä¸€æ­¥ 16.å¿…é¡»é€‰æ‹©æ˜¯ï¼Œå¿½ç•¥æ‰€æœ‰æ•°æ® 17.é»˜è®¤å°±è¡Œï¼Œä¸‹ä¸€æ­¥ 18.è‡ªå·±è¾“å…¥å¯†ç ï¼ˆ6ä½ï¼Œå­—æ¯æ•°å­—ï¼‰ï¼Œé€‰æ‹©æ— è®ºå¦‚ä½•ä½¿ç”¨(å› ä¸ºæˆ‘è®¾ç½®çš„å¯†ç ä¸æ˜¯å®‰å…¨çš„) 19.ä¸ºäº†æ›´å¥½çš„äº†è§£linuxï¼Œç°åœ¨è¿›è¡Œåˆ†ç›˜(æŒ‚è½½ç‚¹) 20.é¦–å…ˆåˆ†ç»™/home 2G(é€‰æ‹©ç©ºé—²ç‚¹å‡»åˆ›å»ºï¼Œç„¶åæŒ‚è½½ç‚¹é€‰/home) 21.å¿…é¡»ç»™/bootä¸€å®šçš„ç©ºé—´(ç³»ç»Ÿä½¿ç”¨ï¼ŒåŠæ—¶å…¶ä»–å‡ºç°é—®é¢˜ä¹Ÿèƒ½æ­£å¸¸å¼€æœºï¼Œä¸€èˆ¬200Må³å¯) 22.æ¥ç€ç»™swapåˆ†4Gç©ºé—´(ä¸æ˜¯åœ¨æŒ‚è½½ç‚¹é€‰æ‹©ï¼Œè€Œæ˜¯åœ¨æ–‡ä»¶ç³»ç»Ÿç±»å‹é€‰æ‹©) 23.æœ€åæ‰€æœ‰ç©ºé—´éƒ½åˆ†ç»™ / æŒ‚è½½ç‚¹(æ ¹ç›®å½•) 24.é€‰æ‹©å°†ä¿®æ”¹å†™å…¥ç£ç›˜ï¼Œç‚¹å‡»ä¸‹ä¸€æ­¥ 25.é»˜è®¤å³å¯ï¼Œä¸‹ä¸€æ­¥ 26.ç”±äºminimalå­˜åœ¨ä¸€äº›å…¼å®¹é—®é¢˜ï¼Œé€‰æ‹©Basic Serverç‰ˆæœ¬ï¼Œç‚¹å‡»ä¸‹ä¸€æ­¥è¿›è¡Œå®‰è£… 27.å®‰è£…å®Œæˆï¼Œç‚¹å‡»é‡æ–°å¼•å¯¼ï¼Œé‡å¯è™šæ‹Ÿæœº 28.å…ˆè¾“å…¥ç”¨æˆ·åï¼šroot å›è½¦ï¼Œæ¥ç€è¾“å…¥å¯†ç (å¯†ç æ˜¯ä¸æ˜¾ç¤ºçš„ï¼Œè¾“å…¥å®Œå›è½¦å°±è¡Œ) 29.ç°åœ¨ä¸€ä¸ªè™šæ‹Ÿæœºå°±ç»ˆäºå®‰è£…å®Œæˆäº† jdkã€hadoopçš„è§£å‹1.å°†jdkè§£å‹åˆ° /opt ä¸‹ tar -zxvf jdk-8u45-linux-x64.tar.gz -C /opt æ³¨æ„å¦‚æœä½ çš„è™šæ‹Ÿæœºè‡ªå¸¦openjdkéœ€è¦å…ˆå¸è½½ rpm -qa | grep java //æ£€æŸ¥æœºå™¨ä¸Šçš„jdk åº”è¯¥æ˜¾ç¤ºè¿™ä¸€ç±»çš„ç»“æœï¼š java-1.8.0-openjdk-1.8.0.102-4.b14.el7.x86_64 javapackages-tools-3.4.1-11.el7.noarch java-1.8.0-openjdk-headless-1.8.0.102-4.b14.el7.x86_64 ä½¿ç”¨ä¸‹é¢çš„å‘½ä»¤åˆ é™¤ä¸Šé¢åˆ—å‡ºçš„å†…å®¹ï¼š rpm -e --nodeps + ä¸Šé¢å‡ºç°çš„å†…å®¹ 2.å°†hadoopè§£å‹åˆ° /opt/hadoop ä¸‹ tar -zxvf hadoop-2.6.0-x64.tar.gz -C /opt/hadoop æ²¡æœ‰hadoopç›®å½•çš„è‡ªå·±åœ¨/optä¸‹åˆ›å»º åœ¨/root /hadoop/ç›®å½•ä¸‹ï¼Œå»ºç«‹tmpã€hdfs/nameã€hdfs/dataç›®å½•ï¼Œæ‰§è¡Œå¦‚ä¸‹å‘½ä»¤ï¼š mkdir /opt/hadoop/tmp mkdir /opt/hadoop/hdfs mkdir /opt/hadoop/hdfs/data mkdir /opt/hadoop/hdfs/name ##sshçš„å®‰è£…ã€æ— å¯†ç é…ç½® 1.æ£€æŸ¥ CentOS é»˜è®¤å·²å®‰è£…äº† SSH clientã€SSH serverï¼Œæ‰“å¼€ç»ˆç«¯æ‰§è¡Œå¦‚ä¸‹å‘½ä»¤è¿›è¡Œæ£€éªŒï¼š rpm -qa | grep ssh æˆåŠŸæ˜¾ç¤ºå‡ºclientã€serverç‰ˆæœ¬çš„è¯åˆ™æ— éœ€å®‰è£…ï¼Œè‹¥éœ€è¦å®‰è£…ï¼Œåˆ™å¯ä»¥é€šè¿‡ yum è¿›è¡Œå®‰è£…ï¼ˆå®‰è£…è¿‡ç¨‹ä¸­ä¼šè®©ä½ è¾“å…¥ [y/N]ï¼Œè¾“å…¥ y å³å¯ï¼‰ï¼š sudo yum install openssh-clients sudo yum install openssh-server æ¥ç€æ‰§è¡Œå¦‚ä¸‹å‘½ä»¤æµ‹è¯•ä¸€ä¸‹ SSH æ˜¯å¦å¯ç”¨ï¼š ssh localhost æ­¤æ—¶ä¼šæœ‰æç¤º(SSHé¦–æ¬¡ç™»é™†æç¤º)ï¼Œè¾“å…¥ yes ã€‚ç„¶åæŒ‰æç¤ºè¾“å…¥å¯†ç ï¼Œå°±ç™»é™†åˆ°æœ¬æœºäº†ã€‚ 2.sshæ— å¯†ç é…ç½® ä¸Šé¢è¿™æ ·ç™»é™†æ˜¯éœ€è¦æ¯æ¬¡è¾“å…¥å¯†ç çš„ï¼Œæˆ‘ä»¬éœ€è¦é…ç½®æˆSSHæ— å¯†ç ç™»é™†æ¯”è¾ƒæ–¹ä¾¿ã€‚ é¦–å…ˆè¾“å…¥ exit é€€å‡ºåˆšæ‰çš„ sshï¼Œå°±å›åˆ°äº†æˆ‘ä»¬åŸå…ˆçš„ç»ˆç«¯çª—å£ï¼Œç„¶ååˆ©ç”¨ ssh-keygen ç”Ÿæˆå¯†é’¥ï¼Œå¹¶å°†å¯†é’¥åŠ å…¥åˆ°æˆæƒä¸­ï¼š exit # é€€å‡ºåˆšæ‰çš„ ssh localhost cd ~/.ssh/ # è‹¥æ²¡æœ‰è¯¥ç›®å½•ï¼Œè¯·å…ˆæ‰§è¡Œä¸€æ¬¡ssh localhost ssh-keygen -t rsa # ä¼šæœ‰æç¤ºï¼Œéƒ½æŒ‰å›è½¦å°±å¯ä»¥ cat id_rsa.pub &gt;&gt; authorized_keys # åŠ å…¥æˆæƒ chmod 600 ./authorized_keys # ä¿®æ”¹æ–‡ä»¶æƒé™ æ­¤æ—¶å†ç”¨ ssh localhost å‘½ä»¤ï¼Œæ— éœ€è¾“å…¥å¯†ç å°±å¯ä»¥ç›´æ¥ç™»é™†äº†ã€‚ jdkã€hadoopçš„é…ç½®1.ç¯å¢ƒå˜é‡çš„é…ç½® vim /etc/profileåŠ å…¥å¦‚ä¸‹é…ç½®ï¼š export JAVA_HOME=/opt/jdk1.8.0_45 export HADOOP_HOME=/opt/hadoop/hadoop-2.6.0 exportCLASSPATH=.:$JAVA_HOME/lib/dt.jar:$JAVA_HOME/lib/tools.jar: exportPATH=$PATH:$JAVA_HOME/bin:$HADOOP_HOME/bin:$HADOOP_HOME/sbin: ä¿å­˜åï¼Œä¸è¦å¿˜è®°æ‰§è¡Œå¦‚ä¸‹å‘½ä»¤ä½¿é…ç½®ç”Ÿæ•ˆï¼š source /etc/profile 2.hostsæ–‡ä»¶çš„ä¿®æ”¹ vim /etc/hostsæœ€ååŠ å…¥å¦‚ä¸‹å†…å®¹ï¼š 127.0.0.1 è‡ªå·±çš„ä¸»æœºå 3.hadoopé…ç½® è¿›å…¥/opt/hadoop/hadoop-2.6.0/etc/hadoopç›®å½• 1)åœ¨hadoop-env.shå’Œ yarn-env.shçš„å¼€å¤´æ·»åŠ å¦‚ä¸‹ç¯å¢ƒå˜é‡(ä¸€å®šè¦æ·»åŠ ) export JAVA_HOME=/opt/jdk1.8.0_45 2)é…ç½®core-site.xml &lt;configuration&gt; &lt;property&gt; &lt;name&gt;fs.default.name&lt;/name&gt; &lt;value&gt;hdfs://localhost:9000&lt;/value&gt; &lt;description&gt;HDFSçš„URIï¼Œæ–‡ä»¶ç³»ç»Ÿ://namenodeæ ‡è¯†:ç«¯å£å·&lt;/description&gt; &lt;/property&gt; &lt;property&gt; &lt;name&gt;hadoop.tmp.dir&lt;/name&gt; &lt;value&gt;/opt/hadoop/tmp&lt;/value&gt; &lt;description&gt;namenodeä¸Šæœ¬åœ°çš„hadoopä¸´æ—¶æ–‡ä»¶å¤¹&lt;/description&gt; &lt;/property&gt; &lt;/configuration&gt; 3)é…ç½®hdfs-site.xml &lt;configuration&gt; &lt;!â€”hdfs-site.xml--&gt; &lt;property&gt; &lt;name&gt;dfs.name.dir&lt;/name&gt; &lt;value&gt;/opt/hadoop/hdfs/name&lt;/value&gt; &lt;description&gt;namenodeä¸Šå­˜å‚¨hdfsåå­—ç©ºé—´å…ƒæ•°æ® &lt;/descriptio&gt; &lt;/property&gt; &lt;property&gt; &lt;name&gt;dfs.data.dir&lt;/name&gt; &lt;value&gt;/opt/hadoop/hdfs/data&lt;/value&gt; &lt;description&gt;datanodeä¸Šæ•°æ®å—çš„ç‰©ç†å­˜å‚¨ä½ç½®&lt;/description&gt; &lt;/property&gt; &lt;property&gt; &lt;name&gt;dfs.replication&lt;/name&gt; &lt;value&gt;1&lt;/value&gt; &lt;description&gt;å‰¯æœ¬ä¸ªæ•°ï¼Œé…ç½®é»˜è®¤æ˜¯3,åº”å°äºdatanodeæœºå™¨æ•°é‡&lt;/description&gt; &lt;/property&gt; &lt;/configuration&gt; 4)é…ç½®yarn-site.xml &lt;configuration&gt; &lt;property&gt; &lt;name&gt;yarn.nodemanager.aux-services&lt;/name&gt; &lt;value&gt;mapreduce_shuffle&lt;/value&gt; &lt;/property&gt; &lt;property&gt; &lt;name&gt;yarn.resourcemanager.webapp.address&lt;/name&gt; &lt;value&gt;${yarn.resourcemanager.hostname}:8099&lt;/value&gt; &lt;/propert&gt; &lt;/configuration&gt; #####4)é…ç½®mapred-site.xml ç›®å½•ä¸‹æ²¡æœ‰mapred-site.xmlï¼Œåªæœ‰mapred-site.xml.template(æ¨¡æ¿)ï¼Œæ‰€ä»¥å°†å…¶å¤åˆ¶é‡å‘½åä¸ºmapred-site.xml: cp mapred-site.xml.template mapred-site.xml ç„¶åå†é…ç½®mapred-site.xml: &lt;configuration&gt; &lt;property&gt; &lt;name&gt;mapreduce.framework.name&lt;/name&gt; &lt;value&gt;yarn&lt;/value&gt; &lt;/property&gt; &lt;/configuration&gt; 5)é…ç½®yarn-site.xml &lt;configuration&gt; &lt;property&gt; &lt;name&gt;yarn.nodemanager.aux-services&lt;/name&gt; &lt;value&gt;mapreduce_shuffle&lt;/value&gt; &lt;/property&gt; &lt;property&gt; &lt;name&gt;yarn.resourcemanager.webapp.address&lt;/name&gt; &lt;value&gt;${yarn.resourcemanager.hostname}:8099&lt;/value&gt; &lt;/property&gt; &lt;/configuration&gt; å¯åŠ¨hadoop1.æ ¼å¼åŒ–namenode hadoop namenode -format 2.å¯åŠ¨hadoop start-all.sh 3.å¯åŠ¨éªŒè¯ jps åº”è¯¥è¾“å‡ºå¦‚ä¸‹çš„ç»“æœ: åœ¨æµè§ˆå™¨è¾“å…¥è™šæ‹Ÿæœºçš„ipåœ°å€ï¼Œä¾‹å¦‚ï¼š192.168.31.0:50070ï¼Œèƒ½å¤Ÿæ‰“å¼€å¦‚ä¸‹ç½‘é¡µï¼š è‡³æ­¤ï¼Œhadoopç¯å¢ƒå®‰è£…å·²ç»å…¨éƒ¨å®Œæˆ hadoopä¸‹è¿è¡ŒMapReduceä»£ç åœ¨æ­¤ï¼Œä½¿ç”¨WordCountçš„æ—§ç‰ˆapiç‰ˆæœ¬æ¼”ç¤º 1.ç¼–å†™WordCount.java,åŒ…å«Mapperç±»å’ŒReducecç±» import java.io.IOException; import java.util.StringTokenizer; import org.apache.hadoop.conf.Configuration; import org.apache.hadoop.fs.Path; import org.apache.hadoop.io.IntWritable; import org.apache.hadoop.io.LongWritable; import org.apache.hadoop.io.Text; import org.apache.hadoop.mapreduce.Job; import org.apache.hadoop.mapreduce.Mapper; import org.apache.hadoop.mapreduce.Reducer; import org.apache.hadoop.mapreduce.lib.input.FileInputFormat; import org.apache.hadoop.mapreduce.lib.input.TextInputFormat; import org.apache.hadoop.mapreduce.lib.output.FileOutputFormat; import org.apache.hadoop.mapreduce.lib.output.TextOutputFormat; public class WordCount { public static class WordCountMap extends Mapper&lt;LongWritable, Text, Text, IntWritable&gt; { private final IntWritable one = new IntWritable(1); private Text word = new Text(); public void map(LongWritable key, Text value, Context context) throws IOException, InterruptedException { String line = value.toString(); StringTokenizer token = new StringTokenizer(line); while (token.hasMoreTokens()) { word.set(token.nextToken()); context.write(word, one); } } } public static class WordCountReduce extends Reducer&lt;Text, IntWritable, Text, IntWritable&gt; { public void reduce(Text key, Iterable&lt;IntWritable&gt; values, Context context) throws IOException, InterruptedException { int sum = 0; for (IntWritable val : values) { sum += val.get(); } context.write(key, new IntWritable(sum)); } } public static void main(String[] args) throws Exception { Configuration conf = new Configuration(); Job job = new Job(conf); job.setJarByClass(WordCount.class); job.setJobName(&quot;wordcount&quot;); job.setOutputKeyClass(Text.class); job.setOutputValueClass(IntWritable.class); job.setMapperClass(WordCountMap.class); job.setReducerClass(WordCountReduce.class); job.setInputFormatClass(TextInputFormat.class); job.setOutputFormatClass(TextOutputFormat.class); FileInputFormat.addInputPath(job, new Path(args[0])); FileOutputFormat.setOutputPath(job, new Path(args[1])); job.waitForCompletion(true); } } 2.ç¼–è¯‘WordCount.javaæ–‡ä»¶ javac WordCount.java -d æŒ‡å®šåˆ°ä½ å¸Œæœ›çš„ç›®å½•ä¸‹ æ­¤æ—¶ç›®å½•ä¸‹åº”è¯¥å¤šå‡ºä¸‰ä¸ªæ–‡ä»¶ï¼šWordCount.classã€WordCount$WordCountMap.classã€WordCount$WordCountReduce.class 3.å°†ä»¥ä¸Šçš„.classæ–‡ä»¶æ‰“åŒ…æˆ.Jaræ–‡ä»¶ jar -cvf ä½ å¸Œæœ›æŒ‡å®šçš„åå­—.jar *.class 4.åˆ›å»ºhadoopçš„inputå’Œoutputç›®å½• hadoop fs -mkdir input hadoop fs -mkdir output 5.å°†è¦è¾“å…¥çš„æ–‡ä»¶æ”¾è¿›inputç›®å½•ä¸‹ hadoop fs -put ä½ è¦æ”¾å…¥è®¡ç®—çš„æ–‡ä»¶ input 6.hadoopè¿è¡ŒJaræ–‡ä»¶å¹¶è®¡ç®—ç»“æœ hadoop jar WordCount.Jar WordCount input/file output (hadoop jar jaråŒ…è·¯å¾„ æ‰§è¡Œçš„ä¸»å‡½æ•°å(ä¸»ç±»åï¼Œmainæ–¹æ³•æ‰€åœ¨ç±»å) è¾“å…¥ç›®å½•å è¾“å‡ºç›®å½•å) 7.æŸ¥çœ‹ç»“æœ(å‰ææ˜¯ä¸æŠ¥é”™ï¼ŒæˆåŠŸè¿è¡Œå®Œ) æˆåŠŸçš„è¯ï¼Œoutputç›®å½•ä¸‹ä¼šå‡ºç°ä¸€ä¸ªpart-r-xxxx hadoop fs cat output/part-r-00000 #æŸ¥çœ‹æäº¤çš„ç»“æœ é™„(xshell5ã€VMware toolsä½¿ç”¨å®‰è£…)VMware Toolså¯ä»¥è®©è™šæ‹Ÿæœºå’Œä½ çš„ä¸»æœºä¹‹é—´å…±äº«ä¸€ä¸ªæ–‡ä»¶å¤¹,å…·ä½“æ“ä½œä¸åœ¨æ­¤èµ˜è¿°ï¼Œç‚¹å‡»é“¾æ¥è‡ªè¡ŒæŒ‰æ•™ç¨‹å®‰è£…VMware Toolså®‰è£… Xshellå¯ä»¥æ–¹ä¾¿å¼€å‘,å…·ä½“æ“ä½œä¸åœ¨æ­¤èµ˜è¿°ï¼Œç‚¹å‡»é“¾æ¥è‡ªè¡ŒæŒ‰æ•™ç¨‹å®‰è£…Xshellå®‰è£…","tags":[{"name":"hadoop","slug":"hadoop","permalink":"http://tanyibing.com/tags/hadoop/"},{"name":"java","slug":"java","permalink":"http://tanyibing.com/tags/java/"},{"name":"VMware","slug":"VMware","permalink":"http://tanyibing.com/tags/VMware/"},{"name":"Windows","slug":"Windows","permalink":"http://tanyibing.com/tags/Windows/"}]},{"title":"Hello World","date":"2017-12-25T02:28:13.000Z","path":"2017/12/25/hello-world/","text":"Welcome to Hexo! This is your very first post. Check documentation for more info. If you get any problems when using Hexo, you can find the answer in troubleshooting or you can ask me on GitHub. Quick StartCreate a new post1$ hexo new \"My New Post\" More info: Writing Run server1$ hexo server More info: Server Generate static files1$ hexo generate More info: Generating Deploy to remote sites1$ hexo deploy More info: Deployment","tags":[{"name":"hexo","slug":"hexo","permalink":"http://tanyibing.com/tags/hexo/"}]}]